var __BUNDLE_START_TIME__=globalThis.nativePerformanceNow?nativePerformanceNow():Date.now(),__DEV__=false,process=globalThis.process||{},__METRO_GLOBAL_PREFIX__='';
!(function(e){"use strict";e.__r=i,e[`${__METRO_GLOBAL_PREFIX__}__d`]=function(e,n,o){if(t.has(n))return;const i={dependencyMap:o,factory:e,hasError:!1,importedAll:r,importedDefault:r,isInitialized:!1,publicModule:{exports:{}}};t.set(n,i)},e.__c=o,e.__registerSegment=function(e,r,n){p[e]=r,n&&n.forEach(r=>{t.has(r)||h.has(r)||h.set(r,e)})};var t=o();const r={},{hasOwnProperty:n}={};function o(){return t=new Map}function i(e,r){if(null===e)throw new Error("Cannot find module");const n=e,o=t.get(n);return o&&o.isInitialized?o.publicModule.exports:d(n,o)}function l(e){const n=e,o=t.get(n);if(o&&o.importedDefault!==r)return o.importedDefault;const l=i(n),u=l&&l.__esModule?l.default:l;return t.get(n).importedDefault=u}function u(e){const o=e,l=t.get(o);if(l&&l.importedAll!==r)return l.importedAll;const u=i(o);let c;if(u&&u.__esModule)c=u;else{if(c={},u)for(const e in u)n.call(u,e)&&(c[e]=u[e]);c.default=u}return t.get(o).importedAll=c}i.importDefault=l,i.importAll=u,i.context=function(){throw new Error("The experimental Metro feature `require.context` is not enabled in your project.")},i.resolveWeak=function(){throw new Error("require.resolveWeak cannot be called dynamically.")};let c=!1;function d(t,r){if(!c&&e.ErrorUtils){let n;c=!0;try{n=g(t,r)}catch(t){e.ErrorUtils.reportFatalError(t)}return c=!1,n}return g(t,r)}const a=16,s=65535;function f(e){return{segmentId:e>>>a,localId:e&s}}i.unpackModuleId=f,i.packModuleId=function(e){return(e.segmentId<<a)+e.localId};const p=[],h=new Map;function g(r,n){if(!n&&p.length>0){const e=h.get(r)??0,o=p[e];null!=o&&(o(r),n=t.get(r),h.delete(r))}const o=e.nativeRequire;if(!n&&o){const{segmentId:e,localId:i}=f(r);o(i,e),n=t.get(r)}if(!n)throw m(r);if(n.hasError)throw n.error;n.isInitialized=!0;const{factory:c,dependencyMap:d}=n;try{const t=n.publicModule;return t.id=r,c(e,i,l,u,t,t.exports,d),n.factory=void 0,n.dependencyMap=void 0,t.exports}catch(e){throw n.hasError=!0,n.error=e,n.isInitialized=!1,n.publicModule.exports=void 0,e}}function m(e){return Error('Requiring unknown module "'+e+'".')}})('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window?window:this);
!(function(e){e.$$require_external="undefined"!=typeof require?require:()=>null})('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window?window:this);
'undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window&&window;
!(function(r){let l=0,n=!0===r.RN$useAlwaysAvailableJSErrorHandling?r.RN$handleException:(r,l)=>{throw r};const t={setGlobalHandler(r){n=r},getGlobalHandler:()=>n,reportError(r){n&&n(r,!1)},reportFatalError(r){n&&n(r,!0)},applyWithGuard(r,n,e,a,o){try{return l++,r.apply(n,e)}catch(r){t.reportError(r)}finally{l--}return null},applyWithGuardIfNeeded:(r,l,n)=>t.inGuard()?r.apply(l,n):(t.applyWithGuard(r,l,n),null),inGuard:()=>!!l,guard(r,l,n){if('function'!=typeof r)return console.warn('A function must be passed to ErrorUtils.guard, got ',r),null;const e=l??r.name??'<generated guard>';return function(...l){return t.applyWithGuard(r,n??this,l,null,e)}}};r.ErrorUtils=t})('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window?window:this);
__d(function(g,r,i,a,m,_e,d){m.exports=function(e){return e&&e.__esModule?e:{default:e}},m.exports.__esModule=!0,m.exports.default=m.exports},29,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PostgrestError=e.PostgrestBuilder=e.PostgrestTransformBuilder=e.PostgrestFilterBuilder=e.PostgrestQueryBuilder=e.PostgrestClient=void 0;const t=r(d[0]),s=t.__importDefault(r(d[1]));e.PostgrestClient=s.default;const o=t.__importDefault(r(d[2]));e.PostgrestQueryBuilder=o.default;const l=t.__importDefault(r(d[3]));e.PostgrestFilterBuilder=l.default;const u=t.__importDefault(r(d[4]));e.PostgrestTransformBuilder=u.default;const f=t.__importDefault(r(d[5]));e.PostgrestBuilder=f.default;const P=t.__importDefault(r(d[6]));e.PostgrestError=P.default,e.default={PostgrestClient:s.default,PostgrestQueryBuilder:o.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:f.default,PostgrestError:P.default}},748,[749,750,751,752,753,754,755]);
__d(function(_g,_r,_i,_a,_m,_e,_d){var e,t,r,n,o,i,a,c,u,f,s,l,p,y,d,h,b,v,w,_,m,j,O,g,P,S,E,x,T,I,k,D;!(function(e){var t="object"==typeof _g?_g:"object"==typeof self?self:"object"==typeof this?this:{};function r(e,r){return e!==t&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(t,n){return e[t]=r?r(t,n):n}}"function"==typeof define&&define.amd?define("tslib",["exports"],function(n){e(r(t,r(n)))}):"object"==typeof _m&&"object"==typeof _m.exports?e(r(t,r(_m.exports))):e(r(t))})(function(A){var R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])};e=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}R(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},n=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},o=function(e,t){return function(r,n){t(r,n,e)}},i=function(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var c,u=n.kind,f="getter"===u?"get":"setter"===u?"set":"value",s=!t&&e?n.static?e:e.prototype:null,l=t||(s?Object.getOwnPropertyDescriptor(s,n.name):{}),p=!1,y=r.length-1;y>=0;y--){var d={};for(var h in n)d[h]="access"===h?{}:n[h];for(var h in n.access)d.access[h]=n.access[h];d.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var b=(0,r[y])("accessor"===u?{get:l.get,set:l.set}:l[f],d);if("accessor"===u){if(void 0===b)continue;if(null===b||"object"!=typeof b)throw new TypeError("Object expected");(c=a(b.get))&&(l.get=c),(c=a(b.set))&&(l.set=c),(c=a(b.init))&&o.unshift(c)}else(c=a(b))&&("field"===u?o.unshift(c):l[f]=c)}s&&Object.defineProperty(s,n.name,l),p=!0},a=function(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0},c=function(e){return"symbol"==typeof e?e:"".concat(e)},u=function(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function c(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,c)}u((n=n.apply(e,t||[])).next())})},l=function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return u([e,t])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},p=function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||T(t,e,r)},T=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},y=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},d=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},h=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e},b=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n},v=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},w=function(e){return this instanceof w?(this.v=e,this):new w(e)},_=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,f)}}),n[Symbol.asyncIterator]=function(){return this},n;function a(e,t){o[e]&&(n[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||c(e,t)})},t&&(n[e]=t(n[e])))}function c(e,t){try{(r=o[e](t)).value instanceof w?Promise.resolve(r.value.v).then(u,f):s(i[0][2],r)}catch(e){s(i[0][3],e)}var r}function u(e){c("next",e)}function f(e){c("throw",e)}function s(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}},m=function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:w(e[n](t)),done:!1}:o?o(t):t}:o}},j=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){o(n,i,(t=e[r](t)).done,t.value)})}}function o(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}},O=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var C=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},F=function(e){return F=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},F(e)};g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=F(e),n=0;n<r.length;n++)"default"!==r[n]&&T(t,e,r[n]);return C(t,e),t},P=function(e){return e&&e.__esModule?e:{default:e}},S=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},E=function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},x=function(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)},I=function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(o=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t};var M="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};k=function(e){function t(t){e.error=e.hasError?new M(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,n=0;return(function o(){for(;r=e.stack.pop();)try{if(!r.async&&1===n)return n=0,e.stack.push(r),Promise.resolve().then(o);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(o,function(e){return t(e),o()})}else n|=1}catch(e){t(e)}if(1===n)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error})()},D=function(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,r,n,o,i){return r?t?".jsx":".js":!n||o&&i?n+o+"."+i.toLowerCase()+"js":e}):e},A("__extends",e),A("__assign",t),A("__rest",r),A("__decorate",n),A("__param",o),A("__esDecorate",i),A("__runInitializers",a),A("__propKey",c),A("__setFunctionName",u),A("__metadata",f),A("__awaiter",s),A("__generator",l),A("__exportStar",p),A("__createBinding",T),A("__values",y),A("__read",d),A("__spread",h),A("__spreadArrays",b),A("__spreadArray",v),A("__await",w),A("__asyncGenerator",_),A("__asyncDelegator",m),A("__asyncValues",j),A("__makeTemplateObject",O),A("__importStar",g),A("__importDefault",P),A("__classPrivateFieldGet",S),A("__classPrivateFieldSet",E),A("__classPrivateFieldIn",x),A("__addDisposableResource",I),A("__disposeResources",k),A("__rewriteRelativeImportExtension",D)})},749,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]),s=t.__importDefault(r(d[1])),h=t.__importDefault(r(d[2]));class c{constructor(t,{headers:s={},schema:h,fetch:c}={}){this.url=t,this.headers=new Headers(s),this.schemaName=h,this.fetch=c}from(t){const h=new URL(`${this.url}/${t}`);return new s.default(h,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new c(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,s={},{head:c=!1,get:n=!1,count:u}={}){var f;let o;const l=new URL(`${this.url}/rpc/${t}`);let p;c||n?(o=c?'HEAD':'GET',Object.entries(s).filter(([t,s])=>void 0!==s).map(([t,s])=>[t,Array.isArray(s)?`{${s.join(',')}}`:`${s}`]).forEach(([t,s])=>{l.searchParams.append(t,s)})):(o='POST',p=s);const w=new Headers(this.headers);return u&&w.set('Prefer',`count=${u}`),new h.default({method:o,url:l,headers:w,schema:this.schemaName,body:p,fetch:null!==(f=this.fetch)&&void 0!==f?f:fetch})}}e.default=c},750,[749,751,752]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]).__importDefault(r(d[1]));e.default=class{constructor(t,{headers:s={},schema:h,fetch:c}){this.url=t,this.headers=new Headers(s),this.schema=h,this.fetch=c}select(s,h){const{head:c=!1,count:n}=null!=h?h:{},u=c?'HEAD':'GET';let l=!1;const o=(null!=s?s:'*').split('').map(t=>/\s/.test(t)&&!l?'':('"'===t&&(l=!l),t)).join('');return this.url.searchParams.set('select',o),n&&this.headers.append('Prefer',`count=${n}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:h,defaultToNull:c=!0}={}){var n;if(h&&this.headers.append('Prefer',`count=${h}`),c||this.headers.append('Prefer',"missing=default"),Array.isArray(s)){const t=s.reduce((t,s)=>t.concat(Object.keys(s)),[]);if(t.length>0){const s=[...new Set(t)].map(t=>`"${t}"`);this.url.searchParams.set('columns',s.join(','))}}return new t.default({method:'POST',url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}upsert(s,{onConflict:h,ignoreDuplicates:c=!1,count:n,defaultToNull:u=!0}={}){var l;if(this.headers.append('Prefer',`resolution=${c?'ignore':'merge'}-duplicates`),void 0!==h&&this.url.searchParams.set('on_conflict',h),n&&this.headers.append('Prefer',`count=${n}`),u||this.headers.append('Prefer','missing=default'),Array.isArray(s)){const t=s.reduce((t,s)=>t.concat(Object.keys(s)),[]);if(t.length>0){const s=[...new Set(t)].map(t=>`"${t}"`);this.url.searchParams.set('columns',s.join(','))}}return new t.default({method:'POST',url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:null!==(l=this.fetch)&&void 0!==l?l:fetch})}update(s,{count:h}={}){var c;return h&&this.headers.append('Prefer',`count=${h}`),new t.default({method:'PATCH',url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:null!==(c=this.fetch)&&void 0!==c?c:fetch})}delete({count:s}={}){var h;return s&&this.headers.append('Prefer',`count=${s}`),new t.default({method:'DELETE',url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(h=this.fetch)&&void 0!==h?h:fetch})}}},751,[749,752]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=r(d[0]).__importDefault(r(d[1])),t=new RegExp('[,()]');class n extends s.default{eq(s,t){return this.url.searchParams.append(s,`eq.${t}`),this}neq(s,t){return this.url.searchParams.append(s,`neq.${t}`),this}gt(s,t){return this.url.searchParams.append(s,`gt.${t}`),this}gte(s,t){return this.url.searchParams.append(s,`gte.${t}`),this}lt(s,t){return this.url.searchParams.append(s,`lt.${t}`),this}lte(s,t){return this.url.searchParams.append(s,`lte.${t}`),this}like(s,t){return this.url.searchParams.append(s,`like.${t}`),this}likeAllOf(s,t){return this.url.searchParams.append(s,`like(all).{${t.join(',')}}`),this}likeAnyOf(s,t){return this.url.searchParams.append(s,`like(any).{${t.join(',')}}`),this}ilike(s,t){return this.url.searchParams.append(s,`ilike.${t}`),this}ilikeAllOf(s,t){return this.url.searchParams.append(s,`ilike(all).{${t.join(',')}}`),this}ilikeAnyOf(s,t){return this.url.searchParams.append(s,`ilike(any).{${t.join(',')}}`),this}is(s,t){return this.url.searchParams.append(s,`is.${t}`),this}in(s,n){const h=Array.from(new Set(n)).map(s=>'string'==typeof s&&t.test(s)?`"${s}"`:`${s}`).join(',');return this.url.searchParams.append(s,`in.(${h})`),this}contains(s,t){return'string'==typeof t?this.url.searchParams.append(s,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(s,`cs.{${t.join(',')}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(t)}`),this}containedBy(s,t){return'string'==typeof t?this.url.searchParams.append(s,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(s,`cd.{${t.join(',')}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(t)}`),this}rangeGt(s,t){return this.url.searchParams.append(s,`sr.${t}`),this}rangeGte(s,t){return this.url.searchParams.append(s,`nxl.${t}`),this}rangeLt(s,t){return this.url.searchParams.append(s,`sl.${t}`),this}rangeLte(s,t){return this.url.searchParams.append(s,`nxr.${t}`),this}rangeAdjacent(s,t){return this.url.searchParams.append(s,`adj.${t}`),this}overlaps(s,t){return'string'==typeof t?this.url.searchParams.append(s,`ov.${t}`):this.url.searchParams.append(s,`ov.{${t.join(',')}}`),this}textSearch(s,t,{config:n,type:h}={}){let p='';'plain'===h?p='pl':'phrase'===h?p='ph':'websearch'===h&&(p='w');const l=void 0===n?'':`(${n})`;return this.url.searchParams.append(s,`${p}fts${l}.${t}`),this}match(s){return Object.entries(s).forEach(([s,t])=>{this.url.searchParams.append(s,`eq.${t}`)}),this}not(s,t,n){return this.url.searchParams.append(s,`not.${t}.${n}`),this}or(s,{foreignTable:t,referencedTable:n=t}={}){const h=n?`${n}.or`:'or';return this.url.searchParams.append(h,`(${s})`),this}filter(s,t,n){return this.url.searchParams.append(s,`${t}.${n}`),this}}e.default=n},752,[749,753]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]).__importDefault(r(d[1]));class s extends t.default{select(t){let s=!1;const n=(null!=t?t:'*').split('').map(t=>/\s/.test(t)&&!s?'':('"'===t&&(s=!s),t)).join('');return this.url.searchParams.set('select',n),this.headers.append('Prefer','return=representation'),this}order(t,{ascending:s=!0,nullsFirst:n,foreignTable:l,referencedTable:o=l}={}){const c=o?`${o}.order`:'order',h=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${h?`${h},`:''}${t}.${s?'asc':'desc'}${void 0===n?'':n?'.nullsfirst':'.nullslast'}`),this}limit(t,{foreignTable:s,referencedTable:n=s}={}){const l=void 0===n?'limit':`${n}.limit`;return this.url.searchParams.set(l,`${t}`),this}range(t,s,{foreignTable:n,referencedTable:l=n}={}){const o=void 0===l?'offset':`${l}.offset`,c=void 0===l?'limit':`${l}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(c,""+(s-t+1)),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set('Accept','application/vnd.pgrst.object+json'),this}maybeSingle(){return'GET'===this.method?this.headers.set('Accept','application/json'):this.headers.set('Accept','application/vnd.pgrst.object+json'),this.isMaybeSingle=!0,this}csv(){return this.headers.set('Accept','text/csv'),this}geojson(){return this.headers.set('Accept','application/geo+json'),this}explain({analyze:t=!1,verbose:s=!1,settings:n=!1,buffers:l=!1,wal:o=!1,format:c="text"}={}){var h;const u=[t?'analyze':null,s?'verbose':null,n?'settings':null,l?'buffers':null,o?'wal':null].filter(Boolean).join('|'),p=null!==(h=this.headers.get('Accept'))&&void 0!==h?h:'application/json';return this.headers.set('Accept',`application/vnd.pgrst.plan+${c}; for="${p}"; options=${u};`),this}rollback(){return this.headers.append('Prefer','tx=rollback'),this}returns(){return this}maxAffected(t){return this.headers.append('Prefer','handling=strict'),this.headers.append('Prefer',`max-affected=${t}`),this}}e.default=s},753,[749,754]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]).__importDefault(r(d[1]));e.default=class{constructor(t){var s,h;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=null!==(s=t.shouldThrowOnError)&&void 0!==s&&s,this.signal=t.signal,this.isMaybeSingle=null!==(h=t.isMaybeSingle)&&void 0!==h&&h,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,s){return this.headers=new Headers(this.headers),this.headers.set(t,s),this}then(s,h){void 0===this.schema||(['GET','HEAD'].includes(this.method)?this.headers.set('Accept-Profile',this.schema):this.headers.set('Content-Profile',this.schema)),'GET'!==this.method&&'HEAD'!==this.method&&this.headers.set('Content-Type','application/json');let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var h,n,l,o;let u=null,c=null,v=null,p=s.status,f=s.statusText;if(s.ok){if('HEAD'!==this.method){const t=await s.text();''===t||(c='text/csv'===this.headers.get('Accept')||this.headers.get('Accept')&&(null===(h=this.headers.get('Accept'))||void 0===h?void 0:h.includes('application/vnd.pgrst.plan+text'))?t:JSON.parse(t))}const t=null===(n=this.headers.get('Prefer'))||void 0===n?void 0:n.match(/count=(exact|planned|estimated)/),o=null===(l=s.headers.get('content-range'))||void 0===l?void 0:l.split('/');t&&o&&o.length>1&&(v=parseInt(o[1])),this.isMaybeSingle&&'GET'===this.method&&Array.isArray(c)&&(c.length>1?(u={code:'PGRST116',details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:'JSON object requested, multiple (or no) rows returned'},c=null,v=null,p=406,f='Not Acceptable'):c=1===c.length?c[0]:null)}else{const h=await s.text();try{u=JSON.parse(h),Array.isArray(u)&&404===s.status&&(c=[],u=null,p=200,f='OK')}catch(t){404===s.status&&''===h?(p=204,f='No Content'):u={message:h}}if(u&&this.isMaybeSingle&&(null===(o=null==u?void 0:u.details)||void 0===o?void 0:o.includes('0 rows'))&&(u=null,p=200,f='OK'),u&&this.shouldThrowOnError)throw new t.default(u)}return{error:u,data:c,count:v,status:p,statusText:f}});return this.shouldThrowOnError||(n=n.catch(t=>{var s,h,n;return{error:{message:`${null!==(s=null==t?void 0:t.name)&&void 0!==s?s:'FetchError'}: ${null==t?void 0:t.message}`,details:`${null!==(h=null==t?void 0:t.stack)&&void 0!==h?h:''}`,hint:'',code:`${null!==(n=null==t?void 0:t.code)&&void 0!==n?n:''}`},data:null,count:null,status:0,statusText:''}})),n.then(s,h)}returns(){return this}overrideTypes(){return this}}},754,[749,755]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class t extends Error{constructor(t){super(t.message),this.name='PostgrestError',this.details=t.details,this.hint=t.hint,this.code=t.code}}e.default=t},755,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:util')},4790,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:crypto')},4791,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:stream')},4793,[]);
__d(function(g,r,i,a,_m,e,d){"use strict";var t=this&&this.__createBinding||(Object.create?function(t,n,o,u){void 0===u&&(u=o);var s=Object.getOwnPropertyDescriptor(n,o);s&&!("get"in s?!n.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return n[o]}}),Object.defineProperty(t,u,s)}:function(t,n,o,u){void 0===u&&(u=o),t[u]=n[o]}),n=this&&this.__exportStar||function(n,o){for(var u in n)"default"===u||Object.prototype.hasOwnProperty.call(o,u)||t(o,n,u)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.createClient=e.SupabaseClient=e.FunctionRegion=e.FunctionsError=e.FunctionsRelayError=e.FunctionsFetchError=e.FunctionsHttpError=e.PostgrestError=void 0;const u=o(r(d[0]));n(r(d[1]),e);var s=r(d[2]);Object.defineProperty(e,"PostgrestError",{enumerable:!0,get:function(){return s.PostgrestError}});var c=r(d[3]);Object.defineProperty(e,"FunctionsHttpError",{enumerable:!0,get:function(){return c.FunctionsHttpError}}),Object.defineProperty(e,"FunctionsFetchError",{enumerable:!0,get:function(){return c.FunctionsFetchError}}),Object.defineProperty(e,"FunctionsRelayError",{enumerable:!0,get:function(){return c.FunctionsRelayError}}),Object.defineProperty(e,"FunctionsError",{enumerable:!0,get:function(){return c.FunctionsError}}),Object.defineProperty(e,"FunctionRegion",{enumerable:!0,get:function(){return c.FunctionRegion}}),n(r(d[4]),e);var f=r(d[0]);Object.defineProperty(e,"SupabaseClient",{enumerable:!0,get:function(){return o(f).default}});e.createClient=(t,n,o)=>new u.default(t,n,o),(function(){if('undefined'==typeof process)return!1;const t=process.version;if(null==t)return!1;const n=t.match(/^v(\d+)\./);return!!n&&parseInt(n[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")},4820,[4821,4864,748,4822,4826]);
__d(function(g,r,i,a,m,_e,d){"use strict";Object.defineProperty(_e,"__esModule",{value:!0});const e=r(d[0]),t=r(d[1]),s=r(d[2]),n=r(d[3]),h=r(d[4]),o=r(d[5]),l=r(d[6]),c=r(d[7]);_e.default=class{constructor(e,s,c){var u,b,T;this.supabaseUrl=e,this.supabaseKey=s;const p=(0,l.validateSupabaseUrl)(e);if(!s)throw new Error('supabaseKey is required.');this.realtimeUrl=new URL('realtime/v1',p),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace('http','ws'),this.authUrl=new URL('auth/v1',p),this.storageUrl=new URL('storage/v1',p),this.functionsUrl=new URL('functions/v1',p);const f=`sb-${p.hostname.split('.')[0]}-auth-token`,k={db:h.DEFAULT_DB_OPTIONS,realtime:h.DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},h.DEFAULT_AUTH_OPTIONS),{storageKey:f}),global:h.DEFAULT_GLOBAL_OPTIONS},A=(0,l.applySettingDefaults)(null!=c?c:{},k);this.storageKey=null!==(u=A.auth.storageKey)&&void 0!==u?u:'',this.headers=null!==(b=A.global.headers)&&void 0!==b?b:{},A.accessToken?(this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(T=A.auth)&&void 0!==T?T:{},this.headers,A.global.fetch),this.fetch=(0,o.fetchWithAuth)(s,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.accessToken&&this.accessToken().then(e=>this.realtime.setAuth(e)).catch(e=>console.warn('Failed to set initial Realtime auth token:',e)),this.rest=new t.PostgrestClient(new URL('rest/v1',p).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),this.storage=new n.StorageClient(this.storageUrl.href,this.headers,this.fetch,null==c?void 0:c.storage),A.accessToken||this._listenForAuthEvents()}get functions(){return new e.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,userStorage:h,storageKey:o,flowType:l,lock:u,debug:b,throwOnError:T},p,f){const k={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new c.SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},k),p),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,userStorage:h,flowType:l,lock:u,debug:b,throwOnError:T,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>'authorization'===e.toLowerCase())})}_initRealtimeClient(e){return new s.RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,'CLIENT',null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,s){'TOKEN_REFRESHED'!==e&&'SIGNED_IN'!==e||this.changedAccessToken===s?'SIGNED_OUT'===e&&(this.realtime.setAuth(),'STORAGE'==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=s,this.realtime.setAuth(s))}}},4821,[4822,748,4826,4837,4859,4861,4862,4863]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FunctionRegion=e.FunctionsRelayError=e.FunctionsHttpError=e.FunctionsFetchError=e.FunctionsError=e.FunctionsClient=void 0;var n=r(d[0]);Object.defineProperty(e,"FunctionsClient",{enumerable:!0,get:function(){return n.FunctionsClient}});var t=r(d[1]);Object.defineProperty(e,"FunctionsError",{enumerable:!0,get:function(){return t.FunctionsError}}),Object.defineProperty(e,"FunctionsFetchError",{enumerable:!0,get:function(){return t.FunctionsFetchError}}),Object.defineProperty(e,"FunctionsHttpError",{enumerable:!0,get:function(){return t.FunctionsHttpError}}),Object.defineProperty(e,"FunctionsRelayError",{enumerable:!0,get:function(){return t.FunctionsRelayError}}),Object.defineProperty(e,"FunctionRegion",{enumerable:!0,get:function(){return t.FunctionRegion}})},4822,[4823,4825]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FunctionsClient=void 0;const t=r(d[0]),n=r(d[1]),o=r(d[2]);e.FunctionsClient=class{constructor(t,{headers:s={},customFetch:c,region:l=o.FunctionRegion.Any}={}){this.url=t,this.headers=s,this.region=l,this.fetch=(0,n.resolveFetch)(c)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(n){return t.__awaiter(this,arguments,void 0,function*(t,n={}){var s;let c,l;try{const{headers:h,method:u,body:p,signal:y,timeout:f}=n;let b={},{region:F}=n;F||(F=this.region);const v=new URL(`${this.url}/${t}`);let w;F&&'any'!==F&&(b['x-region']=F,v.searchParams.set('forceFunctionRegion',F)),p&&(h&&!Object.prototype.hasOwnProperty.call(h,'Content-Type')||!h)?'undefined'!=typeof Blob&&p instanceof Blob||p instanceof ArrayBuffer?(b['Content-Type']='application/octet-stream',w=p):'string'==typeof p?(b['Content-Type']='text/plain',w=p):'undefined'!=typeof FormData&&p instanceof FormData?w=p:(b['Content-Type']='application/json',w=JSON.stringify(p)):w=p;let j=y;f&&(l=new AbortController,c=setTimeout(()=>l.abort(),f),y?(j=l.signal,y.addEventListener('abort',()=>l.abort())):j=l.signal);const C=yield this.fetch(v.toString(),{method:u||'POST',headers:Object.assign(Object.assign(Object.assign({},b),this.headers),h),body:w,signal:j}).catch(t=>{throw new o.FunctionsFetchError(t)}),O=C.headers.get('x-relay-error');if(O&&'true'===O)throw new o.FunctionsRelayError(C);if(!C.ok)throw new o.FunctionsHttpError(C);let T,x=(null!==(s=C.headers.get('Content-Type'))&&void 0!==s?s:'text/plain').split(';')[0].trim();return T='application/json'===x?yield C.json():'application/octet-stream'===x||'application/pdf'===x?yield C.blob():'text/event-stream'===x?C:'multipart/form-data'===x?yield C.formData():yield C.text(),{data:T,error:null,response:C}}catch(t){return{data:null,error:t,response:t instanceof o.FunctionsHttpError||t instanceof o.FunctionsRelayError?t.context:void 0}}finally{c&&clearTimeout(c)}})}}},4823,[749,4824,4825]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resolveFetch=void 0;e.resolveFetch=t=>t?(...c)=>t(...c):(...t)=>fetch(...t)},4824,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FunctionRegion=e.FunctionsHttpError=e.FunctionsRelayError=e.FunctionsFetchError=e.FunctionsError=void 0;class t extends Error{constructor(t,s="FunctionsError",n){super(t),this.name=s,this.context=n}}e.FunctionsError=t;e.FunctionsFetchError=class extends t{constructor(t){super('Failed to send a request to the Edge Function','FunctionsFetchError',t)}};e.FunctionsRelayError=class extends t{constructor(t){super('Relay Error invoking the Edge Function','FunctionsRelayError',t)}};var s;e.FunctionsHttpError=class extends t{constructor(t){super('Edge Function returned a non-2xx status code','FunctionsHttpError',t)}},(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(s||(e.FunctionRegion=s={}))},4825,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebSocketFactory=e.REALTIME_CHANNEL_STATES=e.REALTIME_SUBSCRIBE_STATES=e.REALTIME_PRESENCE_LISTEN_EVENTS=e.REALTIME_POSTGRES_CHANGES_LISTEN_EVENT=e.REALTIME_LISTEN_TYPES=e.RealtimeClient=e.RealtimeChannel=e.RealtimePresence=void 0;const E=r(d[0]),t=E.__importDefault(r(d[1]));e.RealtimeClient=t.default;const _=E.__importStar(r(d[2]));e.RealtimeChannel=_.default,Object.defineProperty(e,"REALTIME_LISTEN_TYPES",{enumerable:!0,get:function(){return _.REALTIME_LISTEN_TYPES}}),Object.defineProperty(e,"REALTIME_POSTGRES_CHANGES_LISTEN_EVENT",{enumerable:!0,get:function(){return _.REALTIME_POSTGRES_CHANGES_LISTEN_EVENT}}),Object.defineProperty(e,"REALTIME_SUBSCRIBE_STATES",{enumerable:!0,get:function(){return _.REALTIME_SUBSCRIBE_STATES}}),Object.defineProperty(e,"REALTIME_CHANNEL_STATES",{enumerable:!0,get:function(){return _.REALTIME_CHANNEL_STATES}});const S=E.__importStar(r(d[3]));e.RealtimePresence=S.default,Object.defineProperty(e,"REALTIME_PRESENCE_LISTEN_EVENTS",{enumerable:!0,get:function(){return S.REALTIME_PRESENCE_LISTEN_EVENTS}});const T=E.__importDefault(r(d[4]));e.WebSocketFactory=T.default},4826,[749,4827,4834,4836,4828]);
__d(function(g,r,i,a,m,_e2,d){"use strict";Object.defineProperty(_e2,"__esModule",{value:!0});const e=r(d[0]),t=e.__importDefault(r(d[1])),n=r(d[2]),s=e.__importDefault(r(d[3])),o=e.__importDefault(r(d[4])),h=r(d[5]),c=e.__importDefault(r(d[6])),l=()=>{},u=25e3,_=10,p=100,f=[1e3,2e3,5e3,1e4];_e2.default=class{constructor(e,t){var o;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint='',this.httpEndpoint='',this.headers={},this.params={},this.timeout=n.DEFAULT_TIMEOUT,this.transport=null,this.heartbeatIntervalMs=u,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=l,this.ref=0,this.reconnectTimer=null,this.vsn=n.DEFAULT_VSN,this.logger=l,this.conn=null,this.sendBuffer=[],this.serializer=new s.default,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState='disconnected',this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),!(null===(o=null==t?void 0:t.params)||void 0===o?void 0:o.apikey))throw new Error('API key is required to connect to Realtime');this.apiKey=t.params.apikey,this.endPoint=`${e}/${n.TRANSPORTS.websocket}`,this.httpEndpoint=(0,h.httpEndpointURL)(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState('connecting'),this.accessToken&&!this._authPromise&&this._setAuthSafely('connect'),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=t.default.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState('disconnected');const t=e.message;if(t.includes('Node.js'))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState('disconnecting',!0),this.conn){const n=setTimeout(()=>{this._setConnectionState('disconnected')},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState('disconnected')},'function'==typeof this.conn.close&&(e?this.conn.close(e,null!=t?t:''):this.conn.close()),this._teardownConnection()}else this._setConnectionState('disconnected')}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case n.SOCKET_STATES.connecting:return n.CONNECTION_STATE.Connecting;case n.SOCKET_STATES.open:return n.CONNECTION_STATE.Open;case n.SOCKET_STATES.closing:return n.CONNECTION_STATE.Closing;default:return n.CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===n.CONNECTION_STATE.Open}isConnecting(){return'connecting'===this._connectionState}isDisconnecting(){return'disconnecting'===this._connectionState}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(e=>e.topic===n);if(s)return s;{const n=new c.default(`realtime:${e}`,t,this);return this.channels.push(n),n}}push(e){const{topic:t,event:n,payload:s,ref:o}=e,h=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log('push',`${t} ${n} (${o})`,s),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log('transport','heartbeat timeout. Attempting to re-establish connection');try{this.heartbeatCallback('timeout')}catch(e){this.log('error','error in heartbeat callback',e)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(n.WS_CLOSE_NORMAL,'heartbeat timeout'),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},p)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:'phoenix',event:'heartbeat',payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback('sent')}catch(e){this.log('error','error in heartbeat callback',e)}this._setAuthSafely('heartbeat')}else try{this.heartbeatCallback('disconnected')}catch(e){this.log('error','error in heartbeat callback',e)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log('transport',`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if('phoenix'===e.topic&&'phx_reply'===e.event)try{this.heartbeatCallback('ok'===e.payload.status?'ok':'error')}catch(e){this.log('error','error in heartbeat callback',e)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:n,payload:s,ref:o}=e,h=o?`(${o})`:'',c=s.status||'';this.log('receive',`${c} ${t} ${n} ${h}`.trim(),s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(n,s,o)),this._triggerStateCallbacks('message',e)})}_clearTimer(e){var t;'heartbeat'===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):'reconnect'===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer('heartbeat'),this._clearTimer('reconnect')}_setupConnectionHandlers(){this.conn&&('binaryType'in this.conn&&(this.conn.binaryType='arraybuffer'),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===n.SOCKET_STATES.open||this.conn.readyState===n.SOCKET_STATES.connecting)try{this.conn.close()}catch(e){this.log('error','Error closing connection',e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState('connected'),this.log('transport',`connected to ${this.endpointURL()}`);(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log('error','error waiting for auth on connect',e),this.flushSendBuffer()}),this._clearTimer('reconnect'),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks('open')}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log('worker',`starting worker for from ${this.workerUrl}`):this.log('worker',"starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log('worker','worker error',e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{'keepAlive'===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:'start',interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState('disconnected'),this.log('transport','close',e),this._triggerChanError(),this._clearTimer('heartbeat'),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks('close',e)}_onConnError(e){this._setConnectionState('disconnected'),this.log('transport',`${e}`),this._triggerChanError(),this._triggerStateCallbacks('error',e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(n.CHANNEL_EVENTS.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?'&':'?';return`${e}${n}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(["\n  addEventListener(\"message\", (e) => {\n    if (e.data.event === \"start\") {\n      setInterval(() => postMessage({ event: \"keepAlive\" }), e.data.interval);\n    }\n  });"],{type:'application/javascript'});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,'connecting'===e?this._wasManualDisconnect=!1:'disconnecting'===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const s={access_token:t,version:n.DEFAULT_VERSION};t&&e.updateJoinPayload(s),e.joinedOnce&&e._isJoined()&&e._push(n.CHANNEL_EVENTS.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log('error',`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(t){this.log('error',`error in ${e} callback`,t)}})}catch(t){this.log('error',`error triggering ${e} callbacks`,t)}}_setupReconnectionTimer(){this.reconnectTimer=new o.default(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,o,h,c,_,p,v,b,T,k,C;switch(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(s=null==e?void 0:e.timeout)&&void 0!==s?s:n.DEFAULT_TIMEOUT,this.heartbeatIntervalMs=null!==(o=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==o?o:u,this.worker=null!==(h=null==e?void 0:e.worker)&&void 0!==h&&h,this.accessToken=null!==(c=null==e?void 0:e.accessToken)&&void 0!==c?c:null,this.heartbeatCallback=null!==(_=null==e?void 0:e.heartbeatCallback)&&void 0!==_?_:l,this.vsn=null!==(p=null==e?void 0:e.vsn)&&void 0!==p?p:n.DEFAULT_VSN,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(v=null==e?void 0:e.reconnectAfterMs)&&void 0!==v?v:e=>f[e-1]||1e4,this.vsn){case n.VSN_1_0_0:this.encode=null!==(b=null==e?void 0:e.encode)&&void 0!==b?b:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(T=null==e?void 0:e.decode)&&void 0!==T?T:(e,t)=>t(JSON.parse(e));break;case n.VSN_2_0_0:this.encode=null!==(k=null==e?void 0:e.encode)&&void 0!==k?k:this.serializer.encode.bind(this.serializer),this.decode=null!==(C=null==e?void 0:e.decode)&&void 0!==C?C:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}this.worker&&(this.workerUrl=null==e?void 0:e.workerUrl)}}},4827,[749,4828,4829,4831,4832,4833,4834]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebSocketFactory=void 0;class t{static detectEnvironment(){var t;if('undefined'!=typeof WebSocket)return{type:'native',constructor:WebSocket};if('undefined'!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:'native',constructor:globalThis.WebSocket};if(void 0!==g&&void 0!==g.WebSocket)return{type:'native',constructor:g.WebSocket};if('undefined'!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:'cloudflare',error:'Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.',workaround:'Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime.'};if('undefined'!=typeof globalThis&&globalThis.EdgeRuntime||'undefined'!=typeof navigator&&(null===(t=navigator.userAgent)||void 0===t?void 0:t.includes('Vercel-Edge')))return{type:'unsupported',error:'Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.',workaround:'Use serverless functions or a different deployment target for WebSocket functionality.'};if('undefined'!=typeof process){const t=process.versions;if(t&&t.node){const o=t.node,n=parseInt(o.replace(/^v/,'').split('.')[0]);return n>=22?void 0!==globalThis.WebSocket?{type:'native',constructor:globalThis.WebSocket}:{type:'unsupported',error:`Node.js ${n} detected but native WebSocket not found.`,workaround:'Provide a WebSocket implementation via the transport option.'}:{type:'unsupported',error:`Node.js ${n} detected without native WebSocket support.`,workaround:"For Node.js < 22, install \"ws\" package and provide it via the transport option:\nimport ws from \"ws\"\nnew RealtimeClient(url, { transport: ws })"}}}return{type:'unsupported',error:'Unknown JavaScript runtime without WebSocket support.',workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let o=t.error||'WebSocket not supported in this environment.';throw t.workaround&&(o+=`\n\nSuggested solution: ${t.workaround}`),new Error(o)}static createWebSocket(t,o){return new(this.getWebSocketConstructor())(t,o)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return'native'===t.type||'ws'===t.type}catch(t){return!1}}}e.WebSocketFactory=t,e.default=t},4828,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONNECTION_STATE=e.TRANSPORTS=e.CHANNEL_EVENTS=e.CHANNEL_STATES=e.SOCKET_STATES=e.MAX_PUSH_BUFFER_SIZE=e.WS_CLOSE_NORMAL=e.DEFAULT_TIMEOUT=e.VERSION=e.DEFAULT_VSN=e.VSN_2_0_0=e.VSN_1_0_0=e.DEFAULT_VERSION=void 0;const _=r(d[0]);var n,o,S,E,c;e.DEFAULT_VERSION=`realtime-js/${_.version}`,e.VSN_1_0_0='1.0.0',e.VSN_2_0_0='2.0.0',e.DEFAULT_VSN=e.VSN_1_0_0,e.VERSION=_.version,e.DEFAULT_TIMEOUT=1e4,e.WS_CLOSE_NORMAL=1e3,e.MAX_PUSH_BUFFER_SIZE=100,(function(_){_[_.connecting=0]="connecting",_[_.open=1]="open",_[_.closing=2]="closing",_[_.closed=3]="closed"})(n||(e.SOCKET_STATES=n={})),(function(_){_.closed="closed",_.errored="errored",_.joined="joined",_.joining="joining",_.leaving="leaving"})(o||(e.CHANNEL_STATES=o={})),(function(_){_.close="phx_close",_.error="phx_error",_.join="phx_join",_.reply="phx_reply",_.leave="phx_leave",_.access_token="access_token"})(S||(e.CHANNEL_EVENTS=S={})),(function(_){_.websocket="websocket"})(E||(e.TRANSPORTS=E={})),(function(_){_.Connecting="connecting",_.Open="open",_.Closing="closing",_.Closed="closed"})(c||(e.CONNECTION_STATE=c={}))},4829,[4830]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version=void 0,e.version='2.81.1'},4830,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]);e.default=class{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST='broadcast'}encode(t,n){if(this._isArrayBuffer(t.payload))return n(this._binaryEncodePush(t));if(t.event===this.BROADCAST&&!(t.payload instanceof ArrayBuffer)&&'string'==typeof t.payload.event)return n(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return n(JSON.stringify(s))}_binaryEncodePush(t){const{join_ref:n,ref:s,event:o,topic:c,payload:h}=t,l=this.META_LENGTH+n.length+s.length+c.length+o.length,y=new ArrayBuffer(this.HEADER_LENGTH+l);let A=new DataView(y),u=0;A.setUint8(u++,this.KINDS.push),A.setUint8(u++,n.length),A.setUint8(u++,s.length),A.setUint8(u++,c.length),A.setUint8(u++,o.length),Array.from(n,t=>A.setUint8(u++,t.charCodeAt(0))),Array.from(s,t=>A.setUint8(u++,t.charCodeAt(0))),Array.from(c,t=>A.setUint8(u++,t.charCodeAt(0))),Array.from(o,t=>A.setUint8(u++,t.charCodeAt(0)));var f=new Uint8Array(y.byteLength+h.byteLength);return f.set(new Uint8Array(y),0),f.set(new Uint8Array(h),y.byteLength),f.buffer}_binaryEncodeUserBroadcastPush(t){var n;return this._isArrayBuffer(null===(n=t.payload)||void 0===n?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var n,s;const{join_ref:o,ref:c,topic:h}=t,l=t.payload.event,y=null!==(s=null===(n=t.payload)||void 0===n?void 0:n.payload)&&void 0!==s?s:new ArrayBuffer(0),A=this.USER_BROADCAST_PUSH_META_LENGTH+o.length+c.length+h.length+l.length,u=new ArrayBuffer(this.HEADER_LENGTH+A);let f=new DataView(u),U=0;f.setUint8(U++,this.KINDS.userBroadcastPush),f.setUint8(U++,o.length),f.setUint8(U++,c.length),f.setUint8(U++,h.length),f.setUint8(U++,l.length),f.setUint8(U++,this.BINARY_ENCODING),Array.from(o,t=>f.setUint8(U++,t.charCodeAt(0))),Array.from(c,t=>f.setUint8(U++,t.charCodeAt(0))),Array.from(h,t=>f.setUint8(U++,t.charCodeAt(0))),Array.from(l,t=>f.setUint8(U++,t.charCodeAt(0)));var _=new Uint8Array(u.byteLength+y.byteLength);return _.set(new Uint8Array(u),0),_.set(new Uint8Array(y),u.byteLength),_.buffer}_encodeJsonUserBroadcastPush(t){var n,s;const{join_ref:o,ref:c,topic:h}=t,l=t.payload.event,y=null!==(s=null===(n=t.payload)||void 0===n?void 0:n.payload)&&void 0!==s?s:{},A=(new TextEncoder).encode(JSON.stringify(y)).buffer,u=this.USER_BROADCAST_PUSH_META_LENGTH+o.length+c.length+h.length+l.length,f=new ArrayBuffer(this.HEADER_LENGTH+u);let U=new DataView(f),_=0;U.setUint8(_++,this.KINDS.userBroadcastPush),U.setUint8(_++,o.length),U.setUint8(_++,c.length),U.setUint8(_++,h.length),U.setUint8(_++,l.length),U.setUint8(_++,this.JSON_ENCODING),Array.from(o,t=>U.setUint8(_++,t.charCodeAt(0))),Array.from(c,t=>U.setUint8(_++,t.charCodeAt(0))),Array.from(h,t=>U.setUint8(_++,t.charCodeAt(0))),Array.from(l,t=>U.setUint8(_++,t.charCodeAt(0)));var E=new Uint8Array(f.byteLength+A.byteLength);return E.set(new Uint8Array(f),0),E.set(new Uint8Array(A),f.byteLength),E.buffer}decode(t,n){if(this._isArrayBuffer(t)){return n(this._binaryDecode(t))}if('string'==typeof t){const s=JSON.parse(t),[o,c,h,l,y]=s;return n({join_ref:o,ref:c,topic:h,event:l,payload:y})}return n({})}_binaryDecode(t){const n=new DataView(t),s=n.getUint8(0),o=new TextDecoder;switch(s){case this.KINDS.push:return this._decodePush(t,n,o);case this.KINDS.reply:return this._decodeReply(t,n,o);case this.KINDS.broadcast:return this._decodeBroadcast(t,n,o);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,n,o)}}_decodePush(t,n,s){const o=n.getUint8(1),c=n.getUint8(2),h=n.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const y=s.decode(t.slice(l,l+o));l+=o;const A=s.decode(t.slice(l,l+c));l+=c;const u=s.decode(t.slice(l,l+h));l+=h;return{join_ref:y,ref:null,topic:A,event:u,payload:JSON.parse(s.decode(t.slice(l,t.byteLength)))}}_decodeReply(n,s,o){const c=s.getUint8(1),h=s.getUint8(2),l=s.getUint8(3),y=s.getUint8(4);let A=this.HEADER_LENGTH+this.META_LENGTH;const u=o.decode(n.slice(A,A+c));A+=c;const f=o.decode(n.slice(A,A+h));A+=h;const U=o.decode(n.slice(A,A+l));A+=l;const _=o.decode(n.slice(A,A+y));A+=y;const E={status:_,response:JSON.parse(o.decode(n.slice(A,n.byteLength)))};return{join_ref:u,ref:f,topic:U,event:t.CHANNEL_EVENTS.reply,payload:E}}_decodeBroadcast(t,n,s){const o=n.getUint8(1),c=n.getUint8(2);let h=this.HEADER_LENGTH+2;const l=s.decode(t.slice(h,h+o));h+=o;const y=s.decode(t.slice(h,h+c));h+=c;return{join_ref:null,ref:null,topic:l,event:y,payload:JSON.parse(s.decode(t.slice(h,t.byteLength)))}}_decodeUserBroadcast(t,n,s){const o=n.getUint8(1),c=n.getUint8(2),h=n.getUint8(3),l=n.getUint8(4);let y=this.HEADER_LENGTH+4;const A=s.decode(t.slice(y,y+o));y+=o;const u=s.decode(t.slice(y,y+c));y+=c;const f=s.decode(t.slice(y,y+h));y+=h;const U=t.slice(y,t.byteLength),_=l===this.JSON_ENCODING?JSON.parse(s.decode(U)):U,E={type:this.BROADCAST,event:u,payload:_};return h>0&&(E.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:A,event:this.BROADCAST,payload:E}}_isArrayBuffer(t){var n;return t instanceof ArrayBuffer||'ArrayBuffer'===(null===(n=null==t?void 0:t.constructor)||void 0===n?void 0:n.name)}}},4831,[4829]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}},4832,[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.httpEndpointURL=e.toTimestampString=e.toArray=e.toJson=e.toNumber=e.toBoolean=e.convertCell=e.convertColumn=e.convertChangeData=e.PostgresTypes=void 0,(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(t||(e.PostgresTypes=t={}));e.convertChangeData=(t,n,o={})=>{var s;const c=null!==(s=o.skipTypes)&&void 0!==s?s:[];return n?Object.keys(n).reduce((o,s)=>(o[s]=(0,e.convertColumn)(s,t,n,c),o),{}):{}};e.convertColumn=(t,o,s,c)=>{const l=o.find(n=>n.name===t),p=null==l?void 0:l.type,u=s[t];return p&&!c.includes(p)?(0,e.convertCell)(p,u):n(u)};e.convertCell=(o,s)=>{if('_'===o.charAt(0)){const t=o.slice(1,o.length);return(0,e.toArray)(s,t)}switch(o){case t.bool:return(0,e.toBoolean)(s);case t.float4:case t.float8:case t.int2:case t.int4:case t.int8:case t.numeric:case t.oid:return(0,e.toNumber)(s);case t.json:case t.jsonb:return(0,e.toJson)(s);case t.timestamp:return(0,e.toTimestampString)(s);case t.abstime:case t.date:case t.daterange:case t.int4range:case t.int8range:case t.money:case t.reltime:case t.text:case t.time:case t.timestamptz:case t.timetz:case t.tsrange:case t.tstzrange:default:return n(s)}};const n=t=>t;e.toBoolean=t=>{switch(t){case't':return!0;case'f':return!1;default:return t}};e.toNumber=t=>{if('string'==typeof t){const n=parseFloat(t);if(!Number.isNaN(n))return n}return t};e.toJson=t=>{if('string'==typeof t)try{return JSON.parse(t)}catch(n){return console.log(`JSON parse error: ${n}`),t}return t};e.toArray=(t,n)=>{if('string'!=typeof t)return t;const o=t.length-1,s=t[o];if('{'===t[0]&&'}'===s){let s;const c=t.slice(1,o);try{s=JSON.parse('['+c+']')}catch(t){s=c?c.split(','):[]}return s.map(t=>(0,e.convertCell)(n,t))}return t};e.toTimestampString=t=>'string'==typeof t?t.replace(' ','T'):t;e.httpEndpointURL=t=>{const n=new URL(t);return n.protocol=n.protocol.replace(/^ws/i,'http'),n.pathname=n.pathname.replace(/\/+$/,'').replace(/\/socket\/websocket$/i,'').replace(/\/socket$/i,'').replace(/\/websocket$/i,''),''===n.pathname||'/'===n.pathname?n.pathname='/api/broadcast':n.pathname=n.pathname+'/api/broadcast',n.href}},4833,[]);
__d(function(g,_r,_i,a,m,_e2,d){"use strict";Object.defineProperty(_e2,"__esModule",{value:!0}),_e2.REALTIME_CHANNEL_STATES=_e2.REALTIME_SUBSCRIBE_STATES=_e2.REALTIME_LISTEN_TYPES=_e2.REALTIME_POSTGRES_CHANGES_LISTEN_EVENT=void 0;const e=_r(d[0]),t=_r(d[1]),i=e.__importDefault(_r(d[2])),s=e.__importDefault(_r(d[3])),o=e.__importDefault(_r(d[4])),n=e.__importStar(_r(d[5])),r=_r(d[5]);var c,h,l;!(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(c||(_e2.REALTIME_POSTGRES_CHANGES_LISTEN_EVENT=c={})),(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(h||(_e2.REALTIME_LISTEN_TYPES=h={})),(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(l||(_e2.REALTIME_SUBSCRIBE_STATES=l={})),_e2.REALTIME_CHANNEL_STATES=t.CHANNEL_STATES;class u{constructor(e,n={config:{}},c){var h,l;if(this.topic=e,this.params=n,this.socket=c,this.bindings={},this.state=t.CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,''),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:'',enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new i.default(this,t.CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new s.default(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive('ok',()=>{this.state=t.CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log('channel',`close ${this.topic} ${this._joinRef()}`),this.state=t.CHANNEL_STATES.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log('channel',`error ${this.topic}`,e),this.state=t.CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive('timeout',()=>{this._isJoining()&&(this.socket.log('channel',`timeout ${this.topic}`,this.joinPush.timeout),this.state=t.CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive('error',e=>{this._isLeaving()||this._isClosed()||(this.socket.log('channel',`error ${this.topic}`,e),this.state=t.CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this._on(t.CHANNEL_EVENTS.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new o.default(this),this.broadcastEndpointURL=(0,r.httpEndpointURL)(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(l=null===(h=this.params.config)||void 0===h?void 0:h.broadcast)||void 0===l?void 0:l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,i=this.timeout){var s,o,n;if(this.socket.isConnected()||this.socket.connect(),this.state==t.CHANNEL_STATES.closed){const{config:{broadcast:r,presence:c,private:u}}=this.params,E=null!==(o=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(e=>e.filter))&&void 0!==o?o:[],p=!!this.bindings[h.PRESENCE]&&this.bindings[h.PRESENCE].length>0||!0===(null===(n=this.params.config.presence)||void 0===n?void 0:n.enabled),_={},T={broadcast:r,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:E,private:u};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(l.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(l.CLOSED)),this.updateJoinPayload(Object.assign({config:T},_)),this.joinedOnce=!0,this._rejoin(i),this.joinPush.receive('ok',async({postgres_changes:i})=>{var s;if(this.socket.setAuth(),void 0!==i){const o=this.bindings.postgres_changes,n=null!==(s=null==o?void 0:o.length)&&void 0!==s?s:0,r=[];for(let s=0;s<n;s++){const n=o[s],{filter:{event:c,schema:h,table:u,filter:E}}=n,p=i&&i[s];if(!p||p.event!==c||p.schema!==h||p.table!==u||p.filter!==E)return this.unsubscribe(),this.state=t.CHANNEL_STATES.errored,void(null==e||e(l.CHANNEL_ERROR,new Error('mismatch between server and client bindings for postgres changes')));r.push(Object.assign(Object.assign({},n),{id:p.id}))}return this.bindings.postgres_changes=r,void(e&&e(l.SUBSCRIBED))}null==e||e(l.SUBSCRIBED)}).receive('error',i=>{this.state=t.CHANNEL_STATES.errored,null==e||e(l.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(i).join(', ')||'error')))}).receive('timeout',()=>{null==e||e(l.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:'presence',event:'track',payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:'presence',event:'untrack'},e)}on(e,i,s){return this.state===t.CHANNEL_STATES.joined&&e===h.PRESENCE&&(this.socket.log('channel',`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,i,s)}async httpSend(e,t,i={}){var s;const o=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:'';if(null==t)return Promise.reject('Payload is required for httpSend()');const n={method:'POST',headers:{Authorization:o,apikey:this.socket.apiKey?this.socket.apiKey:'','Content-Type':'application/json'},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},r=await this._fetchWithTimeout(this.broadcastEndpointURL,n,null!==(s=i.timeout)&&void 0!==s?s:this.timeout);if(202===r.status)return{success:!0};let c=r.statusText;try{const e=await r.json();c=e.error||e.message||c}catch(e){}return Promise.reject(new Error(c))}async send(e,t={}){var i,s;if(this._canPush()||'broadcast'!==e.type)return new Promise(i=>{var s,o,n;const r=this._push(e.type,e,t.timeout||this.timeout);'broadcast'!==e.type||(null===(n=null===(o=null===(s=this.params)||void 0===s?void 0:s.config)||void 0===o?void 0:o.broadcast)||void 0===n?void 0:n.ack)||i('ok'),r.receive('ok',()=>i('ok')),r.receive('error',()=>i('error')),r.receive('timeout',()=>i('timed out'))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:n}=e,r={method:'POST',headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:'',apikey:this.socket.apiKey?this.socket.apiKey:'','Content-Type':'application/json'},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:n,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,r,null!==(i=t.timeout)&&void 0!==i?i:this.timeout);return await(null===(s=e.body)||void 0===s?void 0:s.cancel()),e.ok?'ok':'error'}catch(e){return'AbortError'===e.name?'timed out':'error'}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=t.CHANNEL_STATES.leaving;const s=()=>{this.socket.log('channel',`leave ${this.topic}`),this._trigger(t.CHANNEL_EVENTS.close,'leave',this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(n=>{o=new i.default(this,t.CHANNEL_EVENTS.leave,{},e),o.receive('ok',()=>{s(),n('ok')}).receive('timeout',()=>{s(),n('timed out')}).receive('error',()=>{n('error')}),o.send(),this._canPush()||o.trigger('ok',{})}).finally(()=>{null==o||o.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=t.CHANNEL_STATES.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const s=new AbortController,o=setTimeout(()=>s.abort(),i),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(o),n}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new i.default(this,e,t,s);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>t.MAX_PUSH_BUFFER_SIZE){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log('channel',`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,i,s){var o,n;const r=e.toLocaleLowerCase(),{close:c,error:h,leave:l,join:u}=t.CHANNEL_EVENTS;if(s&&[c,h,l,u].indexOf(r)>=0&&s!==this._joinRef())return;let E=this._onMessage(r,i,s);if(i&&!E)throw'channel onMessage callbacks must return the payload, modified or unmodified';['insert','update','delete'].includes(r)?null===(o=this.bindings.postgres_changes)||void 0===o||o.filter(e=>{var t,i,s;return'*'===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(s=null===(i=e.filter)||void 0===i?void 0:i.event)||void 0===s?void 0:s.toLocaleLowerCase())===r}).map(e=>e.callback(E,s)):null===(n=this.bindings[r])||void 0===n||n.filter(e=>{var t,s,o,n,c,h;if(['broadcast','presence','postgres_changes'].includes(r)){if('id'in e){const n=e.id,r=null===(t=e.filter)||void 0===t?void 0:t.event;return n&&(null===(s=i.ids)||void 0===s?void 0:s.includes(n))&&('*'===r||(null==r?void 0:r.toLocaleLowerCase())===(null===(o=i.data)||void 0===o?void 0:o.type.toLocaleLowerCase()))}{const t=null===(c=null===(n=null==e?void 0:e.filter)||void 0===n?void 0:n.event)||void 0===c?void 0:c.toLocaleLowerCase();return'*'===t||t===(null===(h=null==i?void 0:i.event)||void 0===h?void 0:h.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===r}).map(e=>{if('object'==typeof E&&'ids'in E){const e=E.data,{schema:t,table:i,commit_timestamp:s,type:o,errors:n}=e,r={schema:t,table:i,commit_timestamp:s,eventType:o,new:{},old:{},errors:n};E=Object.assign(Object.assign({},r),this._getPayloadRecords(e))}e.callback(E,s)})}_isClosed(){return this.state===t.CHANNEL_STATES.closed}_isJoined(){return this.state===t.CHANNEL_STATES.joined}_isJoining(){return this.state===t.CHANNEL_STATES.joining}_isLeaving(){return this.state===t.CHANNEL_STATES.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const s=e.toLocaleLowerCase(),o={type:s,filter:t,callback:i};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(e=>{var s;return!((null===(s=e.type)||void 0===s?void 0:s.toLocaleLowerCase())===i&&u.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(t.CHANNEL_EVENTS.close,{},e)}_onError(e){this._on(t.CHANNEL_EVENTS.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=t.CHANNEL_STATES.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return'INSERT'!==e.type&&'UPDATE'!==e.type||(t.new=n.convertChangeData(e.columns,e.record)),'UPDATE'!==e.type&&'DELETE'!==e.type||(t.old=n.convertChangeData(e.columns,e.old_record)),t}}_e2.default=u},4834,[749,4829,4835,4832,4836,4833]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]);e.default=class{constructor(s,h,n={},c=t.DEFAULT_TIMEOUT){this.channel=s,this.event=h,this.payload=n,this.timeout=c,this.sent=!1,this.timeoutTimer=void 0,this.ref='',this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref='',this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived('timeout')||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var h;return this._hasReceived(t)&&s(null===(h=this.receivedResp)||void 0===h?void 0:h.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)}),this.timeoutTimer=setTimeout(()=>{this.trigger('timeout',{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(s=>s.status===t).forEach(t=>t.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}},4835,[4829]);
__d(function(g,r,i,a,_m,e,d){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.REALTIME_PRESENCE_LISTEN_EVENTS=void 0,(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(n||(e.REALTIME_PRESENCE_LISTEN_EVENTS=n={}));class t{constructor(n,s){this.channel=n,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const c=(null==s?void 0:s.events)||{state:'presence_state',diff:'presence_diff'};this.channel._on(c.state,{},n=>{const{onJoin:s,onLeave:c,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=t.syncState(this.state,n,s,c),this.pendingDiffs.forEach(n=>{this.state=t.syncDiff(this.state,n,s,c)}),this.pendingDiffs=[],o()}),this.channel._on(c.diff,{},n=>{const{onJoin:s,onLeave:c,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=t.syncDiff(this.state,n,s,c),o())}),this.onJoin((n,t,s)=>{this.channel._trigger('presence',{event:'join',key:n,currentPresences:t,newPresences:s})}),this.onLeave((n,t,s)=>{this.channel._trigger('presence',{event:'leave',key:n,currentPresences:t,leftPresences:s})}),this.onSync(()=>{this.channel._trigger('presence',{event:'sync'})})}static syncState(n,t,s,c){const o=this.cloneDeep(n),f=this.transformState(t),h={},l={};return this.map(o,(n,t)=>{f[n]||(l[n]=t)}),this.map(f,(n,t)=>{const s=o[n];if(s){const c=t.map(n=>n.presence_ref),o=s.map(n=>n.presence_ref),f=t.filter(n=>o.indexOf(n.presence_ref)<0),p=s.filter(n=>c.indexOf(n.presence_ref)<0);f.length>0&&(h[n]=f),p.length>0&&(l[n]=p)}else h[n]=t}),this.syncDiff(o,{joins:h,leaves:l},s,c)}static syncDiff(n,t,s,c){const{joins:o,leaves:f}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),c||(c=()=>{}),this.map(o,(t,c)=>{var o;const f=null!==(o=n[t])&&void 0!==o?o:[];if(n[t]=this.cloneDeep(c),f.length>0){const s=n[t].map(n=>n.presence_ref),c=f.filter(n=>s.indexOf(n.presence_ref)<0);n[t].unshift(...c)}s(t,f,c)}),this.map(f,(t,s)=>{let o=n[t];if(!o)return;const f=s.map(n=>n.presence_ref);o=o.filter(n=>f.indexOf(n.presence_ref)<0),n[t]=o,c(t,o,s),0===o.length&&delete n[t]}),n}static map(n,t){return Object.getOwnPropertyNames(n).map(s=>t(s,n[s]))}static transformState(n){return n=this.cloneDeep(n),Object.getOwnPropertyNames(n).reduce((t,s)=>{const c=n[s];return t[s]='metas'in c?c.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):c,t},{})}static cloneDeep(n){return JSON.parse(JSON.stringify(n))}onJoin(n){this.caller.onJoin=n}onLeave(n){this.caller.onLeave=n}onSync(n){this.caller.onSync=n}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}e.default=t},4836,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StorageAnalyticsApi=e.StorageClient=void 0;const t=r(d[0]);var n=r(d[1]);Object.defineProperty(e,"StorageClient",{enumerable:!0,get:function(){return n.StorageClient}});var o=r(d[2]);Object.defineProperty(e,"StorageAnalyticsApi",{enumerable:!0,get:function(){return t.__importDefault(o).default}}),t.__exportStar(r(d[3]),e),t.__exportStar(r(d[4]),e),t.__exportStar(r(d[5]),e)},4837,[749,4838,4848,4858,4840,4849]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StorageClient=void 0;const t=r(d[0]),s=t.__importDefault(r(d[1])),u=t.__importDefault(r(d[2])),h=t.__importDefault(r(d[3])),o=r(d[4]);class c extends u.default{constructor(t,s={},u,h){super(t,s,u,h)}from(t){return new s.default(this.url,this.headers,t,this.fetch)}get vectors(){return new o.StorageVectorsClient(this.url+'/vector',{headers:this.headers,fetch:this.fetch})}get analytics(){return new h.default(this.url+'/iceberg',this.headers,this.fetch)}}e.StorageClient=c},4838,[749,4839,4845,4848,4849]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]),o=r(d[1]),n=r(d[2]),s=r(d[3]),h=t.__importDefault(r(d[4])),l={limit:100,offset:0,sortBy:{column:'name',order:'asc'}},u={cacheControl:'3600',contentType:'text/plain;charset=UTF-8',upsert:!1};e.default=class{constructor(t,o={},n,h){this.shouldThrowOnError=!1,this.url=t,this.headers=o,this.bucketId=n,this.fetch=(0,s.resolveFetch)(h)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(s,h,l,c){return t.__awaiter(this,void 0,void 0,function*(){try{let t;const o=Object.assign(Object.assign({},u),c);let f=Object.assign(Object.assign({},this.headers),'POST'===s&&{'x-upsert':String(o.upsert)});const p=o.metadata;if('undefined'!=typeof Blob&&l instanceof Blob)t=new FormData,t.append('cacheControl',o.cacheControl),p&&t.append('metadata',this.encodeMetadata(p)),t.append('',l);else if('undefined'!=typeof FormData&&l instanceof FormData)t=l,t.has('cacheControl')||t.append('cacheControl',o.cacheControl),p&&!t.has('metadata')&&t.append('metadata',this.encodeMetadata(p));else{t=l,f['cache-control']=`max-age=${o.cacheControl}`,f['content-type']=o.contentType,p&&(f['x-metadata']=this.toBase64(this.encodeMetadata(p)));('undefined'!=typeof ReadableStream&&t instanceof ReadableStream||t&&'object'==typeof t&&'pipe'in t&&'function'==typeof t.pipe)&&!o.duplex&&(o.duplex='half')}(null==c?void 0:c.headers)&&(f=Object.assign(Object.assign({},f),c.headers));const w=this._removeEmptyFolders(h),y=this._getFinalPath(w),b=yield('PUT'==s?n.put:n.post)(this.fetch,`${this.url}/object/${y}`,t,Object.assign({headers:f},(null==o?void 0:o.duplex)?{duplex:o.duplex}:{}));return{data:{path:w,id:b.Id,fullPath:b.Key},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}upload(o,n,s){return t.__awaiter(this,void 0,void 0,function*(){return this.uploadOrUpdate('POST',o,n,s)})}uploadToSignedUrl(s,h,l,c){return t.__awaiter(this,void 0,void 0,function*(){const t=this._removeEmptyFolders(s),f=this._getFinalPath(t),p=new URL(this.url+`/object/upload/sign/${f}`);p.searchParams.set('token',h);try{let o;const s=Object.assign({upsert:u.upsert},c),h=Object.assign(Object.assign({},this.headers),{'x-upsert':String(s.upsert)});'undefined'!=typeof Blob&&l instanceof Blob?(o=new FormData,o.append('cacheControl',s.cacheControl),o.append('',l)):'undefined'!=typeof FormData&&l instanceof FormData?(o=l,o.append('cacheControl',s.cacheControl)):(o=l,h['cache-control']=`max-age=${s.cacheControl}`,h['content-type']=s.contentType);return{data:{path:t,fullPath:(yield(0,n.put)(this.fetch,p.toString(),o,{headers:h})).Key},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}createSignedUploadUrl(s,h){return t.__awaiter(this,void 0,void 0,function*(){try{let t=this._getFinalPath(s);const l=Object.assign({},this.headers);(null==h?void 0:h.upsert)&&(l['x-upsert']='true');const u=yield(0,n.post)(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:l}),c=new URL(this.url+u.url),f=c.searchParams.get('token');if(!f)throw new o.StorageError('No token returned by API');return{data:{signedUrl:c.toString(),path:s,token:f},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}update(o,n,s){return t.__awaiter(this,void 0,void 0,function*(){return this.uploadOrUpdate('PUT',o,n,s)})}move(s,h,l){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,n.post)(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:s,destinationKey:h,destinationBucket:null==l?void 0:l.destinationBucket},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}copy(s,h,l){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:{path:(yield(0,n.post)(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:s,destinationKey:h,destinationBucket:null==l?void 0:l.destinationBucket},{headers:this.headers})).Key},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}createSignedUrl(s,h,l){return t.__awaiter(this,void 0,void 0,function*(){try{let t=this._getFinalPath(s),o=yield(0,n.post)(this.fetch,`${this.url}/object/sign/${t}`,Object.assign({expiresIn:h},(null==l?void 0:l.transform)?{transform:l.transform}:{}),{headers:this.headers});const u=(null==l?void 0:l.download)?`&download=${!0===l.download?'':l.download}`:'';return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${u}`)},{data:o,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}createSignedUrls(s,h,l){return t.__awaiter(this,void 0,void 0,function*(){try{const t=yield(0,n.post)(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:h,paths:s},{headers:this.headers}),o=(null==l?void 0:l.download)?`&download=${!0===l.download?'':l.download}`:'';return{data:t.map(t=>Object.assign(Object.assign({},t),{signedUrl:t.signedURL?encodeURI(`${this.url}${t.signedURL}${o}`):null})),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}download(t,o){const s=void 0!==(null==o?void 0:o.transform)?'render/image/authenticated':'object',l=this.transformOptsToQueryString((null==o?void 0:o.transform)||{}),u=l?`?${l}`:'',c=this._getFinalPath(t);return new h.default(()=>(0,n.get)(this.fetch,`${this.url}/${s}/${c}${u}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}info(h){return t.__awaiter(this,void 0,void 0,function*(){const t=this._getFinalPath(h);try{const o=yield(0,n.get)(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:(0,s.recursiveToCamel)(o),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}exists(s){return t.__awaiter(this,void 0,void 0,function*(){const t=this._getFinalPath(s);try{return yield(0,n.head)(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t)&&t instanceof o.StorageUnknownError){const o=t.originalError;if([400,404].includes(null==o?void 0:o.status))return{data:!1,error:t}}throw t}})}getPublicUrl(t,o){const n=this._getFinalPath(t),s=[],h=(null==o?void 0:o.download)?`download=${!0===o.download?'':o.download}`:'';''!==h&&s.push(h);const l=void 0!==(null==o?void 0:o.transform)?'render/image':'object',u=this.transformOptsToQueryString((null==o?void 0:o.transform)||{});''!==u&&s.push(u);let c=s.join('&');return''!==c&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${c}`)}}}remove(s){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,n.remove)(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:s},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}list(s,h,u){return t.__awaiter(this,void 0,void 0,function*(){try{const t=Object.assign(Object.assign(Object.assign({},l),h),{prefix:s||''});return{data:yield(0,n.post)(this.fetch,`${this.url}/object/list/${this.bucketId}`,t,{headers:this.headers},u),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}listV2(s,h){return t.__awaiter(this,void 0,void 0,function*(){try{const t=Object.assign({},s);return{data:yield(0,n.post)(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,t,{headers:this.headers},h),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return'undefined'!=typeof Buffer?Buffer.from(t).toString('base64'):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,'')}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,'').replace(/\/+/g,'/')}transformOptsToQueryString(t){const o=[];return t.width&&o.push(`width=${t.width}`),t.height&&o.push(`height=${t.height}`),t.resize&&o.push(`resize=${t.resize}`),t.format&&o.push(`format=${t.format}`),t.quality&&o.push(`quality=${t.quality}`),o.join('&')}}},4839,[749,4840,4841,4842,4843]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StorageUnknownError=e.StorageApiError=e.StorageError=void 0,e.isStorageError=function(t){return'object'==typeof t&&null!==t&&'__isStorageError'in t};class t extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name='StorageError'}}e.StorageError=t;e.StorageApiError=class extends t{constructor(t,s,o){super(t),this.name='StorageApiError',this.status=s,this.statusCode=o}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}};e.StorageUnknownError=class extends t{constructor(t,s){super(t),this.name='StorageUnknownError',this.originalError=s}}},4840,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.get=function(o,t,s,u){return n.__awaiter(this,void 0,void 0,function*(){return v(o,'GET',t,s,u)})},e.post=function(o,t,s,u,c){return n.__awaiter(this,void 0,void 0,function*(){return v(o,'POST',t,u,c,s)})},e.put=function(o,t,s,u,c){return n.__awaiter(this,void 0,void 0,function*(){return v(o,'PUT',t,u,c,s)})},e.head=function(o,t,s,u){return n.__awaiter(this,void 0,void 0,function*(){return v(o,'HEAD',t,Object.assign(Object.assign({},s),{noResolveJson:!0}),u)})},e.remove=function(o,t,s,u,c){return n.__awaiter(this,void 0,void 0,function*(){return v(o,'DELETE',t,u,c,s)})};const n=r(d[0]),o=r(d[1]),t=r(d[2]),s=n=>{var o;return n.msg||n.message||n.error_description||('string'==typeof n.error?n.error:null===(o=n.error)||void 0===o?void 0:o.message)||JSON.stringify(n)},u=(u,c,v)=>n.__awaiter(void 0,void 0,void 0,function*(){const n=yield(0,t.resolveResponse)();u instanceof n&&!(null==v?void 0:v.noResolveJson)?u.json().then(n=>{const t=u.status||500,v=(null==n?void 0:n.statusCode)||t+'';c(new o.StorageApiError(s(n),t,v))}).catch(n=>{c(new o.StorageUnknownError(s(n),n))}):c(new o.StorageUnknownError(s(u),u))}),c=(n,o,s,u)=>{const c={method:n,headers:(null==o?void 0:o.headers)||{}};return'GET'!==n&&u?((0,t.isPlainObject)(u)?(c.headers=Object.assign({'Content-Type':'application/json'},null==o?void 0:o.headers),c.body=JSON.stringify(u)):c.body=u,(null==o?void 0:o.duplex)&&(c.duplex=o.duplex),Object.assign(Object.assign({},c),s)):c};function v(o,t,s,v,l,f){return n.__awaiter(this,void 0,void 0,function*(){return new Promise((n,_)=>{o(s,c(t,v,l,f)).then(n=>{if(!n.ok)throw n;return(null==v?void 0:v.noResolveJson)?n:n.json()}).then(o=>n(o)).catch(n=>u(n,_,v))})})}},4841,[749,4840,4842]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isPlainObject=e.recursiveToCamel=e.resolveResponse=e.resolveFetch=void 0;e.resolveFetch=t=>t?(...o)=>t(...o):(...t)=>fetch(...t);e.resolveResponse=()=>Response;e.recursiveToCamel=t=>{if(Array.isArray(t))return t.map(t=>(0,e.recursiveToCamel)(t));if('function'==typeof t||t!==Object(t))return t;const o={};return Object.entries(t).forEach(([t,c])=>{const n=t.replace(/([-_][a-z])/gi,t=>t.toUpperCase().replace(/[-_]/g,''));o[n]=(0,e.recursiveToCamel)(c)}),o};e.isPlainObject=t=>{if('object'!=typeof t||null===t)return!1;const o=Object.getPrototypeOf(t);return!(null!==o&&o!==Object.prototype&&null!==Object.getPrototypeOf(o)||Symbol.toStringTag in t||Symbol.iterator in t)}},4842,[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0});const o=r(d[0]),s=r(d[1]),n=o.__importDefault(r(d[2]));t=Symbol.toStringTag,e.default=class{constructor(o,s){this.downloadFn=o,this.shouldThrowOnError=s,this[t]='BlobDownloadBuilder',this.promise=null}asStream(){return new n.default(this.downloadFn,this.shouldThrowOnError)}then(t,o){return this.getPromise().then(t,o)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return o.__awaiter(this,void 0,void 0,function*(){try{const t=yield this.downloadFn();return{data:yield t.blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageError)(t))return{data:null,error:t};throw t}})}}},4843,[749,4840,4844]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]),o=r(d[1]);e.default=class{constructor(t,o){this.downloadFn=t,this.shouldThrowOnError=o}then(t,o){return this.execute().then(t,o)}execute(){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}}},4844,[749,4840]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]),s=r(d[1]),o=r(d[2]),h=r(d[3]),u=r(d[4]);e.default=class{constructor(t,o={},h,n){this.shouldThrowOnError=!1;const l=new URL(t);if(null==n?void 0:n.useNewHostname){/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes('storage.supabase.')&&(l.hostname=l.hostname.replace('supabase.','storage.supabase.'))}this.url=l.href.replace(/\/$/,''),this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),o),this.fetch=(0,u.resolveFetch)(h)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(s){return t.__awaiter(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(s);return{data:yield(0,h.get)(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}getBucket(s){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.get)(this.fetch,`${this.url}/bucket/${s}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}createBucket(s){return t.__awaiter(this,arguments,void 0,function*(t,s={public:!1}){try{return{data:yield(0,h.post)(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}updateBucket(s,u){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.put)(this.fetch,`${this.url}/bucket/${s}`,{id:s,name:s,public:u.public,file_size_limit:u.fileSizeLimit,allowed_mime_types:u.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}emptyBucket(s){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.post)(this.fetch,`${this.url}/bucket/${s}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}deleteBucket(s){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.remove)(this.fetch,`${this.url}/bucket/${s}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,o.isStorageError)(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(t){const s={};return t&&('limit'in t&&(s.limit=String(t.limit)),'offset'in t&&(s.offset=String(t.offset)),t.search&&(s.search=t.search),t.sortColumn&&(s.sortColumn=t.sortColumn),t.sortOrder&&(s.sortOrder=t.sortOrder)),Object.keys(s).length>0?'?'+new URLSearchParams(s).toString():''}}},4845,[749,4846,4840,4841,4842]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_HEADERS=void 0;const o=r(d[0]);e.DEFAULT_HEADERS={'X-Client-Info':`storage-js/${o.version}`}},4846,[4847]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version=void 0,e.version='2.81.1'},4847,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]),o=r(d[1]),s=r(d[2]),h=r(d[3]),n=r(d[4]);e.default=class{constructor(t,s={},h){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,''),this.headers=Object.assign(Object.assign({},o.DEFAULT_HEADERS),s),this.fetch=(0,n.resolveFetch)(h)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(o){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.post)(this.fetch,`${this.url}/bucket`,{name:o},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageError)(t))return{data:null,error:t};throw t}})}listBuckets(o){return t.__awaiter(this,void 0,void 0,function*(){try{const t=new URLSearchParams;void 0!==(null==o?void 0:o.limit)&&t.set('limit',o.limit.toString()),void 0!==(null==o?void 0:o.offset)&&t.set('offset',o.offset.toString()),(null==o?void 0:o.sortColumn)&&t.set('sortColumn',o.sortColumn),(null==o?void 0:o.sortOrder)&&t.set('sortOrder',o.sortOrder),(null==o?void 0:o.search)&&t.set('search',o.search);const s=t.toString(),n=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield(0,h.get)(this.fetch,n,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageError)(t))return{data:null,error:t};throw t}})}deleteBucket(o){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.remove)(this.fetch,`${this.url}/bucket/${o}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageError)(t))return{data:null,error:t};throw t}})}}},4848,[749,4846,4840,4841,4842]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateVectorDimension=e.normalizeToFloat32=e.isPlainObject=e.resolveResponse=e.resolveFetch=e.isStorageVectorsError=e.StorageVectorsErrorCode=e.StorageVectorsUnknownError=e.StorageVectorsApiError=e.StorageVectorsError=e.VectorDataApi=e.VectorIndexApi=e.VectorBucketApi=e.VectorIndexScope=e.VectorBucketScope=e.StorageVectorsClient=void 0;const t=r(d[0]);var o=r(d[1]);Object.defineProperty(e,"StorageVectorsClient",{enumerable:!0,get:function(){return o.StorageVectorsClient}}),Object.defineProperty(e,"VectorBucketScope",{enumerable:!0,get:function(){return o.VectorBucketScope}}),Object.defineProperty(e,"VectorIndexScope",{enumerable:!0,get:function(){return o.VectorIndexScope}});var n=r(d[2]);Object.defineProperty(e,"VectorBucketApi",{enumerable:!0,get:function(){return t.__importDefault(n).default}});var c=r(d[3]);Object.defineProperty(e,"VectorIndexApi",{enumerable:!0,get:function(){return t.__importDefault(c).default}});var u=r(d[4]);Object.defineProperty(e,"VectorDataApi",{enumerable:!0,get:function(){return t.__importDefault(u).default}});var l=r(d[5]);Object.defineProperty(e,"StorageVectorsError",{enumerable:!0,get:function(){return l.StorageVectorsError}}),Object.defineProperty(e,"StorageVectorsApiError",{enumerable:!0,get:function(){return l.StorageVectorsApiError}}),Object.defineProperty(e,"StorageVectorsUnknownError",{enumerable:!0,get:function(){return l.StorageVectorsUnknownError}}),Object.defineProperty(e,"StorageVectorsErrorCode",{enumerable:!0,get:function(){return l.StorageVectorsErrorCode}}),Object.defineProperty(e,"isStorageVectorsError",{enumerable:!0,get:function(){return l.isStorageVectorsError}});var s=r(d[6]);Object.defineProperty(e,"resolveFetch",{enumerable:!0,get:function(){return s.resolveFetch}}),Object.defineProperty(e,"resolveResponse",{enumerable:!0,get:function(){return s.resolveResponse}}),Object.defineProperty(e,"isPlainObject",{enumerable:!0,get:function(){return s.isPlainObject}}),Object.defineProperty(e,"normalizeToFloat32",{enumerable:!0,get:function(){return s.normalizeToFloat32}}),Object.defineProperty(e,"validateVectorDimension",{enumerable:!0,get:function(){return s.validateVectorDimension}})},4849,[749,4850,4857,4851,4856,4853,4855]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VectorIndexScope=e.VectorBucketScope=e.StorageVectorsClient=void 0;const t=r(d[0]),c=t.__importDefault(r(d[1])),s=t.__importDefault(r(d[2])),n=t.__importDefault(r(d[3]));class o extends n.default{constructor(t,c={}){super(t,c.headers||{},c.fetch)}from(t){return new u(this.url,this.headers,t,this.fetch)}}e.StorageVectorsClient=o;class u extends c.default{constructor(t,c,s,n){super(t,c,n),this.vectorBucketName=s}createIndex(c){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return t.__awaiter(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},c),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const c=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return t.__awaiter(this,arguments,void 0,function*(t={}){return c.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(c){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return t.__awaiter(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,c)})}deleteIndex(c){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return t.__awaiter(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,c)})}index(t){return new l(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}e.VectorBucketScope=u;class l extends s.default{constructor(t,c,s,n,o){super(t,c,o),this.vectorBucketName=s,this.indexName=n}putVectors(c){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return t.__awaiter(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},c),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(c){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return t.__awaiter(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},c),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const c=Object.create(null,{listVectors:{get:()=>super.listVectors}});return t.__awaiter(this,arguments,void 0,function*(t={}){return c.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(c){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return t.__awaiter(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},c),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(c){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return t.__awaiter(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},c),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}e.VectorIndexScope=l},4850,[749,4851,4856,4857]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]),o=r(d[1]),s=r(d[2]),h=r(d[3]),n=r(d[4]);e.default=class{constructor(t,s={},h){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,''),this.headers=Object.assign(Object.assign({},o.DEFAULT_HEADERS),s),this.fetch=(0,n.resolveFetch)(h)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(o){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:(yield(0,h.post)(this.fetch,`${this.url}/CreateIndex`,o,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}getIndex(o,n){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.post)(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:o,indexName:n},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}listIndexes(o){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.post)(this.fetch,`${this.url}/ListIndexes`,o,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}deleteIndex(o,n){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:(yield(0,h.post)(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:o,indexName:n},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}}},4851,[749,4852,4853,4854,4855]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_HEADERS=void 0;const n=r(d[0]);e.DEFAULT_HEADERS={'X-Client-Info':`storage-js/${n.version}`,'Content-Type':'application/json'}},4852,[4847]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StorageVectorsErrorCode=e.StorageVectorsUnknownError=e.StorageVectorsApiError=e.StorageVectorsError=void 0,e.isStorageVectorsError=function(t){return'object'==typeof t&&null!==t&&'__isStorageVectorsError'in t};class t extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name='StorageVectorsError'}}e.StorageVectorsError=t;e.StorageVectorsApiError=class extends t{constructor(t,o,s){super(t),this.name='StorageVectorsApiError',this.status=o,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}};var o;e.StorageVectorsUnknownError=class extends t{constructor(t,o){super(t),this.name='StorageVectorsUnknownError',this.originalError=o}},(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(o||(e.StorageVectorsErrorCode=o={}))},4853,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.get=function(n,o,s,u){return t.__awaiter(this,void 0,void 0,function*(){return f(n,'GET',o,s,u)})},e.post=function(n,o,s,u,c){return t.__awaiter(this,void 0,void 0,function*(){return f(n,'POST',o,u,c,s)})},e.put=function(n,o,s,u,c){return t.__awaiter(this,void 0,void 0,function*(){return f(n,'PUT',o,u,c,s)})},e.remove=function(n,o,s,u,c){return t.__awaiter(this,void 0,void 0,function*(){return f(n,'DELETE',o,u,c,s)})};const t=r(d[0]),n=r(d[1]),o=r(d[2]),s=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),u=(o,u,c)=>t.__awaiter(void 0,void 0,void 0,function*(){if(o&&'object'==typeof o&&'status'in o&&'ok'in o&&'number'==typeof o.status&&!(null==c?void 0:c.noResolveJson)){const t=o.status||500,c=o;if('function'==typeof c.json)c.json().then(o=>{const c=(null==o?void 0:o.statusCode)||(null==o?void 0:o.code)||t+'';u(new n.StorageVectorsApiError(s(o),t,c))}).catch(()=>{const o=t+'',s=c.statusText||`HTTP ${t} error`;u(new n.StorageVectorsApiError(s,t,o))});else{const o=t+'',s=c.statusText||`HTTP ${t} error`;u(new n.StorageVectorsApiError(s,t,o))}}else u(new n.StorageVectorsUnknownError(s(o),o))}),c=(t,n,s,u)=>{const c={method:t,headers:(null==n?void 0:n.headers)||{}};return'GET'!==t&&u?((0,o.isPlainObject)(u)?(c.headers=Object.assign({'Content-Type':'application/json'},null==n?void 0:n.headers),c.body=JSON.stringify(u)):c.body=u,Object.assign(Object.assign({},c),s)):c};function f(n,o,s,f,v,l){return t.__awaiter(this,void 0,void 0,function*(){return new Promise((t,h)=>{n(s,c(o,f,v,l)).then(t=>{if(!t.ok)throw t;if(null==f?void 0:f.noResolveJson)return t;const n=t.headers.get('content-type');return n&&n.includes('application/json')?t.json():{}}).then(n=>t(n)).catch(t=>u(t,h,f))})})}},4854,[749,4853,4855]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateVectorDimension=e.normalizeToFloat32=e.isPlainObject=e.resolveResponse=e.resolveFetch=void 0;e.resolveFetch=t=>t?(...o)=>t(...o):(...t)=>fetch(...t);e.resolveResponse=()=>Response;e.isPlainObject=t=>{if('object'!=typeof t||null===t)return!1;const o=Object.getPrototypeOf(t);return!(null!==o&&o!==Object.prototype&&null!==Object.getPrototypeOf(o)||Symbol.toStringTag in t||Symbol.iterator in t)};e.normalizeToFloat32=t=>Array.from(new Float32Array(t));e.validateVectorDimension=(t,o)=>{if(void 0!==o&&t.float32.length!==o)throw new Error(`Vector dimension mismatch: expected ${o}, got ${t.float32.length}`)}},4855,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]),o=r(d[1]),s=r(d[2]),h=r(d[3]),n=r(d[4]);e.default=class{constructor(t,s={},h){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,''),this.headers=Object.assign(Object.assign({},o.DEFAULT_HEADERS),s),this.fetch=(0,n.resolveFetch)(h)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(o){return t.__awaiter(this,void 0,void 0,function*(){try{if(o.vectors.length<1||o.vectors.length>500)throw new Error('Vector batch size must be between 1 and 500 items');return{data:(yield(0,h.post)(this.fetch,`${this.url}/PutVectors`,o,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}getVectors(o){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.post)(this.fetch,`${this.url}/GetVectors`,o,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}listVectors(o){return t.__awaiter(this,void 0,void 0,function*(){try{if(void 0!==o.segmentCount){if(o.segmentCount<1||o.segmentCount>16)throw new Error('segmentCount must be between 1 and 16');if(void 0!==o.segmentIndex&&(o.segmentIndex<0||o.segmentIndex>=o.segmentCount))throw new Error("segmentIndex must be between 0 and "+(o.segmentCount-1))}return{data:yield(0,h.post)(this.fetch,`${this.url}/ListVectors`,o,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}queryVectors(o){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.post)(this.fetch,`${this.url}/QueryVectors`,o,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}deleteVectors(o){return t.__awaiter(this,void 0,void 0,function*(){try{if(o.keys.length<1||o.keys.length>500)throw new Error('Keys batch size must be between 1 and 500 items');return{data:(yield(0,h.post)(this.fetch,`${this.url}/DeleteVectors`,o,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}}},4856,[749,4852,4853,4854,4855]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]),o=r(d[1]),s=r(d[2]),h=r(d[3]),u=r(d[4]);e.default=class{constructor(t,s={},h){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,''),this.headers=Object.assign(Object.assign({},o.DEFAULT_HEADERS),s),this.fetch=(0,u.resolveFetch)(h)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(o){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:(yield(0,h.post)(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:o},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}getBucket(o){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:yield(0,h.post)(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:o},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}listBuckets(){return t.__awaiter(this,arguments,void 0,function*(t={}){try{return{data:yield(0,h.post)(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}deleteBucket(o){return t.__awaiter(this,void 0,void 0,function*(){try{return{data:(yield(0,h.post)(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:o},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if((0,s.isStorageVectorsError)(t))return{data:null,error:t};throw t}})}}},4857,[749,4852,4853,4854,4855]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},4858,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_REALTIME_OPTIONS=e.DEFAULT_AUTH_OPTIONS=e.DEFAULT_DB_OPTIONS=e.DEFAULT_GLOBAL_OPTIONS=e.DEFAULT_HEADERS=void 0;const T=r(d[0]);let n='';n='undefined'!=typeof Deno?'deno':'undefined'!=typeof document?'web':'undefined'!=typeof navigator&&'ReactNative'===navigator.product?'react-native':'node',e.DEFAULT_HEADERS={'X-Client-Info':`supabase-js-${n}/${T.version}`},e.DEFAULT_GLOBAL_OPTIONS={headers:e.DEFAULT_HEADERS},e.DEFAULT_DB_OPTIONS={schema:'public'},e.DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:'implicit'},e.DEFAULT_REALTIME_OPTIONS={}},4859,[4860]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version=void 0,e.version='2.81.1'},4860,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fetchWithAuth=e.resolveHeadersConstructor=e.resolveFetch=void 0;e.resolveFetch=t=>t?(...s)=>t(...s):(...t)=>fetch(...t);e.resolveHeadersConstructor=()=>Headers;e.fetchWithAuth=(t,s,o)=>{const n=(0,e.resolveFetch)(o),c=(0,e.resolveHeadersConstructor)();return async(o,h)=>{var u;const l=null!==(u=await s())&&void 0!==u?u:t;let v=new c(null==h?void 0:h.headers);return v.has('apikey')||v.set('apikey',t),v.has('Authorization')||v.set('Authorization',`Bearer ${l}`),n(o,Object.assign(Object.assign({},h),{headers:v}))}}},4861,[]);
__d(function(g,_r,i,a,m,e,d){"use strict";function s(s){return s.endsWith('/')?s:s+'/'}Object.defineProperty(e,"__esModule",{value:!0}),e.isBrowser=void 0,e.uuid=function(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(s){var r=16*Math.random()|0;return('x'==s?r:3&r|8).toString(16)})},e.ensureTrailingSlash=s,e.applySettingDefaults=function(s,r){var t,n;const{db:o,auth:c,realtime:l,global:u}=s,{db:x,auth:b,realtime:h,global:v}=r,j={db:Object.assign(Object.assign({},x),o),auth:Object.assign(Object.assign({},b),c),realtime:Object.assign(Object.assign({},h),l),storage:{},global:Object.assign(Object.assign(Object.assign({},v),u),{headers:Object.assign(Object.assign({},null!==(t=null==v?void 0:v.headers)&&void 0!==t?t:{}),null!==(n=null==u?void 0:u.headers)&&void 0!==n?n:{})}),accessToken:async()=>''};s.accessToken?j.accessToken=s.accessToken:delete j.accessToken;return j},e.validateSupabaseUrl=function(r){const t=null==r?void 0:r.trim();if(!t)throw new Error('supabaseUrl is required.');if(!t.match(/^https?:\/\//i))throw new Error('Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.');try{return new URL(s(t))}catch(s){throw Error('Invalid supabaseUrl: Provided URL is malformed.')}};e.isBrowser=()=>!1},4862,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SupabaseAuthClient=void 0;const t=r(d[0]);class s extends t.AuthClient{constructor(t){super(t)}}e.SupabaseAuthClient=s},4863,[4864]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processLock=e.lockInternals=e.NavigatorLockAcquireTimeoutError=e.navigatorLock=e.AuthClient=e.AuthAdminApi=e.GoTrueClient=e.GoTrueAdminApi=void 0;const t=r(d[0]),o=t.__importDefault(r(d[1]));e.GoTrueAdminApi=o.default;const n=t.__importDefault(r(d[2]));e.GoTrueClient=n.default;const u=t.__importDefault(r(d[3]));e.AuthAdminApi=u.default;const c=t.__importDefault(r(d[4]));e.AuthClient=c.default,t.__exportStar(r(d[5]),e),t.__exportStar(r(d[6]),e);var l=r(d[7]);Object.defineProperty(e,"navigatorLock",{enumerable:!0,get:function(){return l.navigatorLock}}),Object.defineProperty(e,"NavigatorLockAcquireTimeoutError",{enumerable:!0,get:function(){return l.NavigatorLockAcquireTimeoutError}}),Object.defineProperty(e,"lockInternals",{enumerable:!0,get:function(){return l.internals}}),Object.defineProperty(e,"processLock",{enumerable:!0,get:function(){return l.processLock}})},4864,[749,4865,4873,4880,4881,4872,4870,4875]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]),s=r(d[1]),n=r(d[2]),l=r(d[3]),o=r(d[4]);e.default=class{constructor({url:t="",headers:s={},fetch:l}){this.url=t,this.headers=s,this.fetch=(0,n.resolveFetch)(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=l.SIGN_OUT_SCOPES[0]){if(l.SIGN_OUT_SCOPES.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${l.SIGN_OUT_SCOPES.join(', ')}`);try{return await(0,s._request)(this.fetch,'POST',`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(t){if((0,o.isAuthError)(t))return{data:null,error:t};throw t}}async inviteUserByEmail(t,n={}){try{return await(0,s._request)(this.fetch,'POST',`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:s._userResponse})}catch(t){if((0,o.isAuthError)(t))return{data:{user:null},error:t};throw t}}async generateLink(n){try{const{options:l}=n,o=t.__rest(n,["options"]),h=Object.assign(Object.assign({},o),l);return'newEmail'in o&&(h.new_email=null==o?void 0:o.newEmail,delete h.newEmail),await(0,s._request)(this.fetch,'POST',`${this.url}/admin/generate_link`,{body:h,headers:this.headers,xform:s._generateLinkResponse,redirectTo:null==l?void 0:l.redirectTo})}catch(t){if((0,o.isAuthError)(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(t){try{return await(0,s._request)(this.fetch,'POST',`${this.url}/admin/users`,{body:t,headers:this.headers,xform:s._userResponse})}catch(t){if((0,o.isAuthError)(t))return{data:{user:null},error:t};throw t}}async listUsers(t){var n,l,h,u,c,f,_;try{const o={nextPage:null,lastPage:0,total:0},p=await(0,s._request)(this.fetch,'GET',`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(l=null===(n=null==t?void 0:t.page)||void 0===n?void 0:n.toString())&&void 0!==l?l:'',per_page:null!==(u=null===(h=null==t?void 0:t.perPage)||void 0===h?void 0:h.toString())&&void 0!==u?u:''},xform:s._noResolveJsonResponse});if(p.error)throw p.error;const y=await p.json(),v=null!==(c=p.headers.get('x-total-count'))&&void 0!==c?c:0,w=null!==(_=null===(f=p.headers.get('link'))||void 0===f?void 0:f.split(','))&&void 0!==_?_:[];return w.length>0&&(w.forEach(t=>{const s=parseInt(t.split(';')[0].split('=')[1].substring(0,1)),n=JSON.parse(t.split(';')[1].split('=')[1]);o[`${n}Page`]=s}),o.total=parseInt(v)),{data:Object.assign(Object.assign({},y),o),error:null}}catch(t){if((0,o.isAuthError)(t))return{data:{users:[]},error:t};throw t}}async getUserById(t){(0,n.validateUUID)(t);try{return await(0,s._request)(this.fetch,'GET',`${this.url}/admin/users/${t}`,{headers:this.headers,xform:s._userResponse})}catch(t){if((0,o.isAuthError)(t))return{data:{user:null},error:t};throw t}}async updateUserById(t,l){(0,n.validateUUID)(t);try{return await(0,s._request)(this.fetch,'PUT',`${this.url}/admin/users/${t}`,{body:l,headers:this.headers,xform:s._userResponse})}catch(t){if((0,o.isAuthError)(t))return{data:{user:null},error:t};throw t}}async deleteUser(t,l=!1){(0,n.validateUUID)(t);try{return await(0,s._request)(this.fetch,'DELETE',`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:l},xform:s._userResponse})}catch(t){if((0,o.isAuthError)(t))return{data:{user:null},error:t};throw t}}async _listFactors(t){(0,n.validateUUID)(t.userId);try{const{data:n,error:l}=await(0,s._request)(this.fetch,'GET',`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:t=>({data:{factors:t},error:null})});return{data:n,error:l}}catch(t){if((0,o.isAuthError)(t))return{data:null,error:t};throw t}}async _deleteFactor(t){(0,n.validateUUID)(t.userId),(0,n.validateUUID)(t.id);try{return{data:await(0,s._request)(this.fetch,'DELETE',`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(t){if((0,o.isAuthError)(t))return{data:null,error:t};throw t}}async _listOAuthClients(t){var n,l,h,u,c,f,_;try{const o={nextPage:null,lastPage:0,total:0},p=await(0,s._request)(this.fetch,'GET',`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(l=null===(n=null==t?void 0:t.page)||void 0===n?void 0:n.toString())&&void 0!==l?l:'',per_page:null!==(u=null===(h=null==t?void 0:t.perPage)||void 0===h?void 0:h.toString())&&void 0!==u?u:''},xform:s._noResolveJsonResponse});if(p.error)throw p.error;const y=await p.json(),v=null!==(c=p.headers.get('x-total-count'))&&void 0!==c?c:0,w=null!==(_=null===(f=p.headers.get('link'))||void 0===f?void 0:f.split(','))&&void 0!==_?_:[];return w.length>0&&(w.forEach(t=>{const s=parseInt(t.split(';')[0].split('=')[1].substring(0,1)),n=JSON.parse(t.split(';')[1].split('=')[1]);o[`${n}Page`]=s}),o.total=parseInt(v)),{data:Object.assign(Object.assign({},y),o),error:null}}catch(t){if((0,o.isAuthError)(t))return{data:{clients:[]},error:t};throw t}}async _createOAuthClient(t){try{return await(0,s._request)(this.fetch,'POST',`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if((0,o.isAuthError)(t))return{data:null,error:t};throw t}}async _getOAuthClient(t){try{return await(0,s._request)(this.fetch,'GET',`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if((0,o.isAuthError)(t))return{data:null,error:t};throw t}}async _updateOAuthClient(t,n){try{return await(0,s._request)(this.fetch,'PUT',`${this.url}/admin/oauth/clients/${t}`,{body:n,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if((0,o.isAuthError)(t))return{data:null,error:t};throw t}}async _deleteOAuthClient(t){try{return await(0,s._request)(this.fetch,'DELETE',`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if((0,o.isAuthError)(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(t){try{return await(0,s._request)(this.fetch,'POST',`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if((0,o.isAuthError)(t))return{data:null,error:t};throw t}}}},4865,[749,4866,4869,4872,4870]);
__d(function(g,r,_i,_a2,m,_e,d){"use strict";Object.defineProperty(_e,"__esModule",{value:!0}),_e.handleError=i,_e._request=async function(e,o,t,n){var a;const i=Object.assign({},null==n?void 0:n.headers);i[s.API_VERSION_HEADER_NAME]||(i[s.API_VERSION_HEADER_NAME]=s.API_VERSIONS['2024-01-01'].name);(null==n?void 0:n.jwt)&&(i.Authorization=`Bearer ${n.jwt}`);const c=null!==(a=null==n?void 0:n.query)&&void 0!==a?a:{};(null==n?void 0:n.redirectTo)&&(c.redirect_to=n.redirectTo);const l=Object.keys(c).length?'?'+new URLSearchParams(c).toString():'',_=await u(e,o,t+l,{headers:i,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(_):{data:Object.assign({},_),error:null}},_e._sessionResponse=l,_e._sessionResponsePassword=function(e){const s=l(e);!s.error&&e.weak_password&&'object'==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&'string'==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,s)=>e&&'string'==typeof s,!0)&&(s.data.weak_password=e.weak_password);return s},_e._userResponse=function(e){var s;return{data:{user:null!==(s=e.user)&&void 0!==s?s:e},error:null}},_e._ssoResponse=function(e){return{data:e,error:null}},_e._generateLinkResponse=function(s){const{action_link:o,email_otp:t,hashed_token:n,redirect_to:a,verification_type:i}=s,c=e.__rest(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:o,email_otp:t,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},c);return{data:{properties:u,user:l},error:null}},_e._noResolveJsonResponse=function(e){return e};const e=r(d[0]),s=r(d[1]),o=r(d[2]),t=r(d[3]),n=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),a=[502,503,504];async function i(e){var i;if(!(0,o.looksLikeFetchResponse)(e))throw new t.AuthRetryableFetchError(n(e),0);if(a.includes(e.status))throw new t.AuthRetryableFetchError(n(e),e.status);let c,u;try{c=await e.json()}catch(e){throw new t.AuthUnknownError(n(e),e)}const l=(0,o.parseResponseAPIVersion)(e);if(l&&l.getTime()>=s.API_VERSIONS['2024-01-01'].timestamp&&'object'==typeof c&&c&&'string'==typeof c.code?u=c.code:'object'==typeof c&&c&&'string'==typeof c.error_code&&(u=c.error_code),u){if('weak_password'===u)throw new t.AuthWeakPasswordError(n(c),e.status,(null===(i=c.weak_password)||void 0===i?void 0:i.reasons)||[]);if('session_not_found'===u)throw new t.AuthSessionMissingError}else if('object'==typeof c&&c&&'object'==typeof c.weak_password&&c.weak_password&&Array.isArray(c.weak_password.reasons)&&c.weak_password.reasons.length&&c.weak_password.reasons.reduce((e,s)=>e&&'string'==typeof s,!0))throw new t.AuthWeakPasswordError(n(c),e.status,c.weak_password.reasons);throw new t.AuthApiError(n(c),e.status||500,u)}const c=(e,s,o,t)=>{const n={method:e,headers:(null==s?void 0:s.headers)||{}};return'GET'===e?n:(n.headers=Object.assign({'Content-Type':'application/json;charset=UTF-8'},null==s?void 0:s.headers),n.body=JSON.stringify(t),Object.assign(Object.assign({},n),o))};async function u(e,s,o,a,u,l){const _=c(s,a,u,l);let w;try{w=await e(o,Object.assign({},_))}catch(e){throw console.error(e),new t.AuthRetryableFetchError(n(e),0)}if(w.ok||await i(w),null==a?void 0:a.noResolveJson)return w;try{return await w.json()}catch(e){await i(e)}}function l(e){var s;let t=null;_(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=(0,o.expiresAt)(e.expires_in)));return{data:{session:t,user:null!==(s=e.user)&&void 0!==s?s:e},error:null}}function _(e){return e.access_token&&e.refresh_token&&e.expires_in}},4866,[749,4867,4869,4870]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JWKS_TTL=e.BASE64URL_REGEX=e.API_VERSIONS=e.API_VERSION_HEADER_NAME=e.NETWORK_FAILURE=e.DEFAULT_HEADERS=e.AUDIENCE=e.STORAGE_KEY=e.GOTRUE_URL=e.EXPIRY_MARGIN_MS=e.AUTO_REFRESH_TICK_THRESHOLD=e.AUTO_REFRESH_TICK_DURATION_MS=void 0;const E=r(d[0]);e.AUTO_REFRESH_TICK_DURATION_MS=3e4,e.AUTO_REFRESH_TICK_THRESHOLD=3,e.EXPIRY_MARGIN_MS=e.AUTO_REFRESH_TICK_THRESHOLD*e.AUTO_REFRESH_TICK_DURATION_MS,e.GOTRUE_URL='http://localhost:9999',e.STORAGE_KEY='supabase.auth.token',e.AUDIENCE='',e.DEFAULT_HEADERS={'X-Client-Info':`gotrue-js/${E.version}`},e.NETWORK_FAILURE={MAX_RETRIES:10,RETRY_INTERVAL:2},e.API_VERSION_HEADER_NAME='X-Supabase-Api-Version',e.API_VERSIONS={'2024-01-01':{timestamp:Date.parse('2024-01-01T00:00:00.0Z'),name:'2024-01-01'}},e.BASE64URL_REGEX=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,e.JWKS_TTL=6e5},4867,[4868]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version=void 0,e.version='2.81.1'},4868,[]);
__d(function(g,r,_i,a,m,_e,d){"use strict";Object.defineProperty(_e,"__esModule",{value:!0}),_e.Deferred=_e.removeItemAsync=_e.getItemAsync=_e.setItemAsync=_e.looksLikeFetchResponse=_e.resolveFetch=_e.supportsLocalStorage=_e.isBrowser=void 0,_e.expiresAt=function(e){return Math.round(Date.now()/1e3)+e},_e.generateCallbackId=function(){return Symbol('auth-callback')},_e.parseParametersFromURL=function(e){const t={},o=new URL(e);if(o.hash&&'#'===o.hash[0])try{new URLSearchParams(o.hash.substring(1)).forEach((e,o)=>{t[o]=e})}catch(e){}return o.searchParams.forEach((e,o)=>{t[o]=e}),t},_e.decodeJWT=function(n){const s=n.split('.');if(3!==s.length)throw new t.AuthInvalidJwtError('Invalid JWT structure');for(let o=0;o<s.length;o++)if(!e.BASE64URL_REGEX.test(s[o]))throw new t.AuthInvalidJwtError('JWT not in base64url format');return{header:JSON.parse((0,o.stringFromBase64URL)(s[0])),payload:JSON.parse((0,o.stringFromBase64URL)(s[1])),signature:(0,o.base64UrlToUint8Array)(s[2]),raw:{header:s[0],payload:s[1]}}},_e.sleep=async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})},_e.retryable=function(e,t){return new Promise((o,n)=>{(async()=>{for(let s=0;s<1/0;s++)try{const n=await e(s);if(!t(s,null,n))return void o(n)}catch(e){if(!t(s,e))return void n(e)}})()})},_e.generatePKCEVerifier=c,_e.generatePKCEChallenge=l,_e.getCodeChallengeAndMethod=async function(e,t,o=!1){const n=c();let s=n;o&&(s+='/PASSWORD_RECOVERY');await(0,_e.setItemAsync)(e,`${t}-code-verifier`,s);const i=await l(n);return[i,n===i?'plain':'s256']},_e.parseResponseAPIVersion=function(t){const o=t.headers.get(e.API_VERSION_HEADER_NAME);if(!o)return null;if(!o.match(h))return null;try{return new Date(`${o}T00:00:00.0Z`)}catch(e){return null}},_e.validateExp=function(e){if(!e)throw new Error('Missing exp claim');const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error('JWT has expired')},_e.getAlgorithm=function(e){switch(e){case'RS256':return{name:'RSASSA-PKCS1-v1_5',hash:{name:'SHA-256'}};case'ES256':return{name:'ECDSA',namedCurve:'P-256',hash:{name:'SHA-256'}};default:throw new Error('Invalid alg claim')}},_e.validateUUID=function(e){if(!f.test(e))throw new Error('@supabase/auth-js: Expected parameter to be UUID but is not')},_e.userNotAvailableProxy=function(){return new Proxy({},{get:(e,t)=>{if('__isUserNotAvailableProxy'===t)return!0;if('symbol'==typeof t){const e=t.toString();if('Symbol(Symbol.toPrimitive)'===e||'Symbol(Symbol.toStringTag)'===e||'Symbol(util.inspect.custom)'===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})},_e.insecureUserWarningProxy=function(e,t){return new Proxy(e,{get:(e,o,n)=>{if('__isInsecureUserWarningProxy'===o)return!0;if('symbol'==typeof o){const t=o.toString();if('Symbol(Symbol.toPrimitive)'===t||'Symbol(Symbol.toStringTag)'===t||'Symbol(util.inspect.custom)'===t||'Symbol(nodejs.util.inspect.custom)'===t)return Reflect.get(e,o,n)}return t.value||'string'!=typeof o||(console.warn('Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.'),t.value=!0),Reflect.get(e,o,n)}})},_e.deepClone=function(e){return JSON.parse(JSON.stringify(e))};const e=r(d[0]),t=r(d[1]),o=r(d[2]);_e.isBrowser=()=>!1;const n={tested:!1,writable:!1};_e.supportsLocalStorage=()=>{if(!(0,_e.isBrowser)())return!1;try{if('object'!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(n.tested)return n.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),n.tested=!0,n.writable=!0}catch(e){n.tested=!0,n.writable=!1}return n.writable};_e.resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e);_e.looksLikeFetchResponse=e=>'object'==typeof e&&null!==e&&'status'in e&&'ok'in e&&'json'in e&&'function'==typeof e.json;_e.setItemAsync=async(e,t,o)=>{await e.setItem(t,JSON.stringify(o))};_e.getItemAsync=async(e,t)=>{const o=await e.getItem(t);if(!o)return null;try{return JSON.parse(o)}catch(e){return o}};_e.removeItemAsync=async(e,t)=>{await e.removeItem(t)};class s{constructor(){this.promise=new s.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function i(e){return('0'+e.toString(16)).substr(-2)}function c(){const e=new Uint32Array(56);if('undefined'==typeof crypto){const e='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~',t=e.length;let o='';for(let n=0;n<56;n++)o+=e.charAt(Math.floor(Math.random()*t));return o}return crypto.getRandomValues(e),Array.from(e,i).join('')}async function u(e){const t=(new TextEncoder).encode(e),o=await crypto.subtle.digest('SHA-256',t),n=new Uint8Array(o);return Array.from(n).map(e=>String.fromCharCode(e)).join('')}async function l(e){if(!('undefined'!=typeof crypto&&void 0!==crypto.subtle&&'undefined'!=typeof TextEncoder))return console.warn('WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256.'),e;const t=await u(e);return btoa(t).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'')}_e.Deferred=s,s.promiseConstructor=Promise;const h=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const f=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/},4869,[4867,4870,4871]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AuthInvalidJwtError=e.AuthWeakPasswordError=e.AuthRetryableFetchError=e.AuthPKCEGrantCodeExchangeError=e.AuthImplicitGrantRedirectError=e.AuthInvalidCredentialsError=e.AuthInvalidTokenResponseError=e.AuthSessionMissingError=e.CustomAuthError=e.AuthUnknownError=e.AuthApiError=e.AuthError=void 0,e.isAuthError=s,e.isAuthApiError=function(t){return s(t)&&'AuthApiError'===t.name},e.isAuthSessionMissingError=function(t){return s(t)&&'AuthSessionMissingError'===t.name},e.isAuthImplicitGrantRedirectError=function(t){return s(t)&&'AuthImplicitGrantRedirectError'===t.name},e.isAuthRetryableFetchError=function(t){return s(t)&&'AuthRetryableFetchError'===t.name},e.isAuthWeakPasswordError=function(t){return s(t)&&'AuthWeakPasswordError'===t.name};class t extends Error{constructor(t,s,o){super(t),this.__isAuthError=!0,this.name='AuthError',this.status=s,this.code=o}}function s(t){return'object'==typeof t&&null!==t&&'__isAuthError'in t}e.AuthError=t;e.AuthApiError=class extends t{constructor(t,s,o){super(t,s,o),this.name='AuthApiError',this.status=s,this.code=o}};e.AuthUnknownError=class extends t{constructor(t,s){super(t),this.name='AuthUnknownError',this.originalError=s}};class o extends t{constructor(t,s,o,n){super(t,o,n),this.name=s,this.status=o}}e.CustomAuthError=o;e.AuthSessionMissingError=class extends o{constructor(){super('Auth session missing!','AuthSessionMissingError',400,void 0)}};e.AuthInvalidTokenResponseError=class extends o{constructor(){super('Auth session or user missing','AuthInvalidTokenResponseError',500,void 0)}};e.AuthInvalidCredentialsError=class extends o{constructor(t){super(t,'AuthInvalidCredentialsError',400,void 0)}};e.AuthImplicitGrantRedirectError=class extends o{constructor(t,s=null){super(t,'AuthImplicitGrantRedirectError',500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};e.AuthPKCEGrantCodeExchangeError=class extends o{constructor(t,s=null){super(t,'AuthPKCEGrantCodeExchangeError',500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};e.AuthRetryableFetchError=class extends o{constructor(t,s){super(t,'AuthRetryableFetchError',s,void 0)}};e.AuthWeakPasswordError=class extends o{constructor(t,s,o){super(t,'AuthWeakPasswordError',s,'weak_password'),this.reasons=o}};e.AuthInvalidJwtError=class extends o{constructor(t){super(t,'AuthInvalidJwtError',400,'invalid_jwt')}}},4870,[]);
__d(function(g,r,_i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.byteToBase64URL=o,e.byteFromBase64URL=i,e.stringToBase64URL=function(t){const u=[],n=t=>{u.push(t)},i={queue:0,queuedBits:0};return f(t,t=>{o(t,i,n)}),o(null,i,n),u.join('')},e.stringFromBase64URL=function(t){const u=[],n=t=>{u.push(String.fromCodePoint(t))},o={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},f=t=>{c(t,o,n)};for(let u=0;u<t.length;u+=1)i(t.charCodeAt(u),s,f);return u.join('')},e.codepointToUTF8=s,e.stringToUTF8=f,e.stringFromUTF8=c,e.base64UrlToUint8Array=function(t){const u=[],n={queue:0,queuedBits:0},o=t=>{u.push(t)};for(let u=0;u<t.length;u+=1)i(t.charCodeAt(u),n,o);return new Uint8Array(u)},e.stringToUint8Array=function(t){const u=[];return f(t,t=>u.push(t)),new Uint8Array(u)},e.bytesToBase64URL=function(t){const u=[],n={queue:0,queuedBits:0},i=t=>{u.push(t)};return t.forEach(t=>o(t,n,i)),o(null,n,i),u.join('')};const t='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'.split(''),u=' \t\n\r='.split(''),n=(()=>{const n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<u.length;t+=1)n[u[t].charCodeAt(0)]=-2;for(let u=0;u<t.length;u+=1)n[t[u].charCodeAt(0)]=u;return n})();function o(u,n,o){if(null!==u)for(n.queue=n.queue<<8|u,n.queuedBits+=8;n.queuedBits>=6;){const u=n.queue>>n.queuedBits-6&63;o(t[u]),n.queuedBits-=6}else if(n.queuedBits>0)for(n.queue=n.queue<<6-n.queuedBits,n.queuedBits=6;n.queuedBits>=6;){const u=n.queue>>n.queuedBits-6&63;o(t[u]),n.queuedBits-=6}}function i(t,u,o){const i=n[t];if(!(i>-1)){if(-2===i)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}for(u.queue=u.queue<<6|i,u.queuedBits+=6;u.queuedBits>=8;)o(u.queue>>u.queuedBits-8&255),u.queuedBits-=8}function s(t,u){if(!(t<=127)){if(t<=2047)return u(192|t>>6),void u(128|63&t);if(t<=65535)return u(224|t>>12),u(128|t>>6&63),void u(128|63&t);if(t<=1114111)return u(240|t>>18),u(128|t>>12&63),u(128|t>>6&63),void u(128|63&t);throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}u(t)}function f(t,u){for(let n=0;n<t.length;n+=1){let o=t.charCodeAt(n);if(o>55295&&o<=56319){const u=1024*(o-55296)&65535;o=65536+(t.charCodeAt(n+1)-56320&65535|u),n+=1}s(o,u)}}function c(t,u,n){if(0===u.utf8seq){if(t<=127)return void n(t);for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){u.utf8seq=n;break}if(2===u.utf8seq)u.codepoint=31&t;else if(3===u.utf8seq)u.codepoint=15&t;else{if(4!==u.utf8seq)throw new Error('Invalid UTF-8 sequence');u.codepoint=7&t}u.utf8seq-=1}else if(u.utf8seq>0){if(t<=127)throw new Error('Invalid UTF-8 sequence');u.codepoint=u.codepoint<<6|63&t,u.utf8seq-=1,0===u.utf8seq&&n(u.codepoint)}}},4871,[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SIGN_OUT_SCOPES=void 0;e.SIGN_OUT_SCOPES=['global','local','others']},4872,[]);
__d(function(g,r,_i,a,m,_e2,d){"use strict";Object.defineProperty(_e2,"__esModule",{value:!0});const e=r(d[0]).__importDefault(r(d[1])),t=r(d[2]),s=r(d[3]),i=r(d[4]),n=r(d[5]),o=r(d[6]),l=r(d[7]),u=r(d[8]),h=r(d[9]),c=r(d[10]),_=r(d[11]),w=r(d[12]);(0,u.polyfillGlobalThis)();const y={url:t.GOTRUE_URL,storageKey:t.STORAGE_KEY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:t.DEFAULT_HEADERS,flowType:'implicit',debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function f(e,t,s){return await s()}const p={};class v{get jwks(){var e,t;return null!==(t=null===(e=p[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){p[this.storageKey]=Object.assign(Object.assign({},p[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=p[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){p[this.storageKey]=Object.assign(Object.assign({},p[this.storageKey]),{cachedAt:e})}constructor(t){var s,i,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const h=Object.assign(Object.assign({},y),t);if(this.storageKey=h.storageKey,this.instanceID=null!==(s=v.nextInstanceID[this.storageKey])&&void 0!==s?s:0,v.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!h.debug,'function'==typeof h.debug&&(this.logger=h.debug),this.instanceID>0&&(0,n.isBrowser)()){const e=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=h.persistSession,this.autoRefreshToken=h.autoRefreshToken,this.admin=new e.default({url:h.url,headers:h.headers,fetch:h.fetch}),this.url=h.url,this.headers=h.headers,this.fetch=(0,n.resolveFetch)(h.fetch),this.lock=h.lock||f,this.detectSessionInUrl=h.detectSessionInUrl,this.flowType=h.flowType,this.hasCustomAuthorizationHeader=h.hasCustomAuthorizationHeader,this.throwOnError=h.throwOnError,h.lock?this.lock=h.lock:(0,n.isBrowser)()&&(null===(i=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===i?void 0:i.locks)?this.lock=l.navigatorLock:this.lock=f,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new w.WebAuthnApi(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(h.storage?this.storage=h.storage:(0,n.supportsLocalStorage)()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=(0,o.memoryLocalStorageAdapter)(this.memoryStorage)),h.userStorage&&(this.userStorage=h.userStorage)):(this.memoryStorage={},this.storage=(0,o.memoryLocalStorageAdapter)(this.memoryStorage)),(0,n.isBrowser)()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error('Failed to create a new BroadcastChannel, multi-tab state changes will not be available',e)}null===(u=this.broadcastChannel)||void 0===u||u.addEventListener('message',async e=>{this._debug('received broadcast notification from other tab or client',e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${h.version}) ${(new Date).toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},i='none';if((0,n.isBrowser)()&&(t=(0,n.parseParametersFromURL)(window.location.href),this._isImplicitGrantCallback(t)?i='implicit':await this._isPKCECallback(t)&&(i='pkce')),(0,n.isBrowser)()&&this.detectSessionInUrl&&'none'!==i){const{data:n,error:o}=await this._getSessionFromURL(t,i);if(o){if(this._debug('#_initialize()','error detecting session from URL',o),(0,s.isAuthImplicitGrantRedirectError)(o)){const t=null===(e=o.details)||void 0===e?void 0:e.code;if('identity_already_exists'===t||'identity_not_found'===t||'single_identity_not_deletable'===t)return{error:o}}return await this._removeSession(),{error:o}}const{session:l,redirectType:u}=n;return this._debug('#_initialize()','detected session in URL',l,'redirect type',u),await this._saveSession(l),setTimeout(async()=>{'recovery'===u?await this._notifyAllSubscribers('PASSWORD_RECOVERY',l):await this._notifyAllSubscribers('SIGNED_IN',l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return(0,s.isAuthError)(e)?this._returnResult({error:e}):this._returnResult({error:new s.AuthUnknownError('Unexpected error during initialization',e)})}finally{await this._handleVisibilityChange(),this._debug('#_initialize()','end')}}async signInAnonymously(e){var t,n,o;try{const s=await(0,i._request)(this.fetch,'POST',`${this.url}/signup`,{headers:this.headers,body:{data:null!==(n=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(o=null==e?void 0:e.options)||void 0===o?void 0:o.captchaToken}},xform:i._sessionResponse}),{data:l,error:u}=s;if(u||!l)return this._returnResult({data:{user:null,session:null},error:u});const h=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers('SIGNED_IN',h)),this._returnResult({data:{user:c,session:h},error:null})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signUp(e){var t,o,l;try{let u;if('email'in e){const{email:s,password:o,options:l}=e;let h=null,c=null;'pkce'===this.flowType&&([h,c]=await(0,n.getCodeChallengeAndMethod)(this.storage,this.storageKey)),u=await(0,i._request)(this.fetch,'POST',`${this.url}/signup`,{headers:this.headers,redirectTo:null==l?void 0:l.emailRedirectTo,body:{email:s,password:o,data:null!==(t=null==l?void 0:l.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==l?void 0:l.captchaToken},code_challenge:h,code_challenge_method:c},xform:i._sessionResponse})}else{if(!('phone'in e))throw new s.AuthInvalidCredentialsError('You must provide either an email or phone number and a password');{const{phone:t,password:s,options:n}=e;u=await(0,i._request)(this.fetch,'POST',`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:s,data:null!==(o=null==n?void 0:n.data)&&void 0!==o?o:{},channel:null!==(l=null==n?void 0:n.channel)&&void 0!==l?l:'sms',gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:i._sessionResponse})}}const{data:h,error:c}=u;if(c||!h)return this._returnResult({data:{user:null,session:null},error:c});const _=h.session,w=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers('SIGNED_IN',_)),this._returnResult({data:{user:w,session:_},error:null})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithPassword(e){try{let t;if('email'in e){const{email:s,password:n,options:o}=e;t=await(0,i._request)(this.fetch,'POST',`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:n,gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:i._sessionResponsePassword})}else{if(!('phone'in e))throw new s.AuthInvalidCredentialsError('You must provide either an email or phone number and a password');{const{phone:s,password:n,options:o}=e;t=await(0,i._request)(this.fetch,'POST',`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:n,gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:i._sessionResponsePassword})}}const{data:n,error:o}=t;if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!n||!n.session||!n.user){const e=new s.AuthInvalidTokenResponseError;return this._returnResult({data:{user:null,session:null},error:e})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers('SIGNED_IN',n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:o})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(e){var t,s,i,n;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case'ethereum':return await this.signInWithEthereum(e);case'solana':return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,o,l,u,h,c,w,y,f,p,v;let b,k;if('message'in e)b=e.message,k=e.signature;else{const{chain:s,wallet:i,statement:p,options:v}=e;let S;if((0,n.isBrowser)())if('object'==typeof i)S=i;else{const e=window;if(!('ethereum'in e)||'object'!=typeof e.ethereum||!('request'in e.ethereum)||'function'!=typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");S=e.ethereum}else{if('object'!=typeof i||!(null==v?void 0:v.url))throw new Error('@supabase/auth-js: Both wallet and url must be specified in non-browser environments.');S=i}const R=new URL(null!==(t=null==v?void 0:v.url)&&void 0!==t?t:window.location.href),A=await S.request({method:'eth_requestAccounts'}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!A||0===A.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=(0,_.getAddress)(A[0]);let T=null===(o=null==v?void 0:v.signInWithEthereum)||void 0===o?void 0:o.chainId;if(!T){const e=await S.request({method:'eth_chainId'});T=(0,_.fromHex)(e)}const E={domain:R.host,address:I,statement:p,uri:R.href,version:'1',chainId:T,nonce:null===(l=null==v?void 0:v.signInWithEthereum)||void 0===l?void 0:l.nonce,issuedAt:null!==(h=null===(u=null==v?void 0:v.signInWithEthereum)||void 0===u?void 0:u.issuedAt)&&void 0!==h?h:new Date,expirationTime:null===(c=null==v?void 0:v.signInWithEthereum)||void 0===c?void 0:c.expirationTime,notBefore:null===(w=null==v?void 0:v.signInWithEthereum)||void 0===w?void 0:w.notBefore,requestId:null===(y=null==v?void 0:v.signInWithEthereum)||void 0===y?void 0:y.requestId,resources:null===(f=null==v?void 0:v.signInWithEthereum)||void 0===f?void 0:f.resources};b=(0,_.createSiweMessage)(E),k=await S.request({method:'personal_sign',params:[(0,_.toHex)(b),I]})}try{const{data:t,error:n}=await(0,i._request)(this.fetch,'POST',`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:'ethereum',message:b,signature:k},(null===(p=e.options)||void 0===p?void 0:p.captchaToken)?{gotrue_meta_security:{captcha_token:null===(v=e.options)||void 0===v?void 0:v.captchaToken}}:null),xform:i._sessionResponse});if(n)throw n;if(!t||!t.session||!t.user){const e=new s.AuthInvalidTokenResponseError;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers('SIGNED_IN',t.session)),this._returnResult({data:Object.assign({},t),error:n})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSolana(e){var t,o,l,u,h,_,w,y,f,p,v,b;let k,S;if('message'in e)k=e.message,S=e.signature;else{const{chain:s,wallet:i,statement:c,options:v}=e;let b;if((0,n.isBrowser)())if('object'==typeof i)b=i;else{const e=window;if(!('solana'in e)||'object'!=typeof e.solana||!('signIn'in e.solana&&'function'==typeof e.solana.signIn||'signMessage'in e.solana&&'function'==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");b=e.solana}else{if('object'!=typeof i||!(null==v?void 0:v.url))throw new Error('@supabase/auth-js: Both wallet and url must be specified in non-browser environments.');b=i}const R=new URL(null!==(t=null==v?void 0:v.url)&&void 0!==t?t:window.location.href);if('signIn'in b&&b.signIn){const e=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==v?void 0:v.signInWithSolana),{version:'1',domain:R.host,uri:R.href}),c?{statement:c}:null));let t;if(Array.isArray(e)&&e[0]&&'object'==typeof e[0])t=e[0];else{if(!(e&&'object'==typeof e&&'signedMessage'in e&&'signature'in e))throw new Error('@supabase/auth-js: Wallet method signIn() returned unrecognized value');t=e}if(!('signedMessage'in t&&'signature'in t&&('string'==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error('@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields');k='string'==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),S=t.signature}else{if(!('signMessage'in b&&'function'==typeof b.signMessage&&'publicKey'in b&&'object'==typeof b&&b.publicKey&&'toBase58'in b.publicKey&&'function'==typeof b.publicKey.toBase58))throw new Error('@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API');k=[`${R.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...c?['',c,'']:[''],'Version: 1',`URI: ${R.href}`,`Issued At: ${null!==(l=null===(o=null==v?void 0:v.signInWithSolana)||void 0===o?void 0:o.issuedAt)&&void 0!==l?l:(new Date).toISOString()}`,...(null===(u=null==v?void 0:v.signInWithSolana)||void 0===u?void 0:u.notBefore)?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...(null===(h=null==v?void 0:v.signInWithSolana)||void 0===h?void 0:h.expirationTime)?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...(null===(_=null==v?void 0:v.signInWithSolana)||void 0===_?void 0:_.chainId)?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...(null===(w=null==v?void 0:v.signInWithSolana)||void 0===w?void 0:w.nonce)?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...(null===(y=null==v?void 0:v.signInWithSolana)||void 0===y?void 0:y.requestId)?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...(null===(p=null===(f=null==v?void 0:v.signInWithSolana)||void 0===f?void 0:f.resources)||void 0===p?void 0:p.length)?['Resources',...v.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join('\n');const e=await b.signMessage((new TextEncoder).encode(k),'utf8');if(!(e&&e instanceof Uint8Array))throw new Error('@supabase/auth-js: Wallet signMessage() API returned an recognized value');S=e}}try{const{data:t,error:n}=await(0,i._request)(this.fetch,'POST',`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:'solana',message:k,signature:(0,c.bytesToBase64URL)(S)},(null===(v=e.options)||void 0===v?void 0:v.captchaToken)?{gotrue_meta_security:{captcha_token:null===(b=e.options)||void 0===b?void 0:b.captchaToken}}:null),xform:i._sessionResponse});if(n)throw n;if(!t||!t.session||!t.user){const e=new s.AuthInvalidTokenResponseError;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers('SIGNED_IN',t.session)),this._returnResult({data:Object.assign({},t),error:n})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _exchangeCodeForSession(e){const t=await(0,n.getItemAsync)(this.storage,`${this.storageKey}-code-verifier`),[o,l]=(null!=t?t:'').split('/');try{const{data:t,error:u}=await(0,i._request)(this.fetch,'POST',`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:o},xform:i._sessionResponse});if(await(0,n.removeItemAsync)(this.storage,`${this.storageKey}-code-verifier`),u)throw u;if(!t||!t.session||!t.user){const e=new s.AuthInvalidTokenResponseError;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers('SIGNED_IN',t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!=l?l:null}),error:u})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null,redirectType:null},error:e});throw e}}async signInWithIdToken(e){try{const{options:t,provider:n,token:o,access_token:l,nonce:u}=e,h=await(0,i._request)(this.fetch,'POST',`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:o,access_token:l,nonce:u,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:i._sessionResponse}),{data:c,error:_}=h;if(_)return this._returnResult({data:{user:null,session:null},error:_});if(!c||!c.session||!c.user){const e=new s.AuthInvalidTokenResponseError;return this._returnResult({data:{user:null,session:null},error:e})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers('SIGNED_IN',c.session)),this._returnResult({data:c,error:_})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(e){var t,o,l,u,h;try{if('email'in e){const{email:s,options:l}=e;let u=null,h=null;'pkce'===this.flowType&&([u,h]=await(0,n.getCodeChallengeAndMethod)(this.storage,this.storageKey));const{error:c}=await(0,i._request)(this.fetch,'POST',`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!==(t=null==l?void 0:l.data)&&void 0!==t?t:{},create_user:null===(o=null==l?void 0:l.shouldCreateUser)||void 0===o||o,gotrue_meta_security:{captcha_token:null==l?void 0:l.captchaToken},code_challenge:u,code_challenge_method:h},redirectTo:null==l?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}if('phone'in e){const{phone:t,options:s}=e,{data:n,error:o}=await(0,i._request)(this.fetch,'POST',`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(l=null==s?void 0:s.data)&&void 0!==l?l:{},create_user:null===(u=null==s?void 0:s.shouldCreateUser)||void 0===u||u,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(h=null==s?void 0:s.channel)&&void 0!==h?h:'sms'}});return this._returnResult({data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:o})}throw new s.AuthInvalidCredentialsError('You must provide either an email or phone number.')}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async verifyOtp(e){var t,n;try{let s,o;'options'in e&&(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo,o=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:l,error:u}=await(0,i._request)(this.fetch,'POST',`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:i._sessionResponse});if(u)throw u;if(!l){throw new Error('An error occurred on token verification.')}const h=l.session,c=l.user;return(null==h?void 0:h.access_token)&&(await this._saveSession(h),await this._notifyAllSubscribers('recovery'==e.type?'PASSWORD_RECOVERY':'SIGNED_IN',h)),this._returnResult({data:{user:c,session:h},error:null})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSSO(e){var t,o,l,u,h;try{let s=null,c=null;'pkce'===this.flowType&&([s,c]=await(0,n.getCodeChallengeAndMethod)(this.storage,this.storageKey));const _=await(0,i._request)(this.fetch,'POST',`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},'providerId'in e?{provider_id:e.providerId}:null),'domain'in e?{domain:e.domain}:null),{redirect_to:null!==(o=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==o?o:void 0}),(null===(l=null==e?void 0:e.options)||void 0===l?void 0:l.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:c}),headers:this.headers,xform:i._ssoResponse});return(null===(u=_.data)||void 0===u?void 0:u.url)&&(0,n.isBrowser)()&&!(null===(h=e.options)||void 0===h?void 0:h.skipBrowserRedirect)&&window.location.assign(_.data.url),this._returnResult(_)}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new s.AuthSessionMissingError;const{error:o}=await(0,i._request)(this.fetch,'GET',`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:o})})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if('email'in e){const{email:s,type:n,options:o}=e,{error:l}=await(0,i._request)(this.fetch,'POST',t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},redirectTo:null==o?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}if('phone'in e){const{phone:s,type:n,options:o}=e,{data:l,error:u}=await(0,i._request)(this.fetch,'POST',t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==l?void 0:l.message_id},error:u})}throw new s.AuthInvalidCredentialsError('You must provide either an email or phone number and a type')}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug('#_acquireLock','begin',e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug('#_acquireLock','lock acquired for storage key',this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug('#_acquireLock','lock released for storage key',this.storageKey),this.lockAcquired=!1}})}finally{this._debug('#_acquireLock','end')}}async _useSession(e){this._debug('#_useSession','begin');try{const t=await this.__loadSession();return await e(t)}finally{this._debug('#_useSession','end')}}async __loadSession(){this._debug('#__loadSession()','begin'),this.lockAcquired||this._debug('#__loadSession()','used outside of an acquired lock!',(new Error).stack);try{let e=null;const s=await(0,n.getItemAsync)(this.storage,this.storageKey);if(this._debug('#getSession()','session from storage',s),null!==s&&(this._isValidSession(s)?e=s:(this._debug('#getSession()','session from storage is not valid'),await this._removeSession())),!e)return{data:{session:null},error:null};const i=!!e.expires_at&&1e3*e.expires_at-Date.now()<t.EXPIRY_MARGIN_MS;if(this._debug('#__loadSession()',`session has${i?'':' not'} expired`,'expires_at',e.expires_at),!i){if(this.userStorage){const t=await(0,n.getItemAsync)(this.userStorage,this.storageKey+'-user');(null==t?void 0:t.user)?e.user=t.user:e.user=(0,n.userNotAvailableProxy)()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const t={value:this.suppressGetSessionWarning};e.user=(0,n.insecureUserWarningProxy)(e.user,t),t.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:o},error:null})}finally{this._debug('#__loadSession()','end')}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await(0,i._request)(this.fetch,'GET',`${this.url}/user`,{headers:this.headers,jwt:e,xform:i._userResponse}):await this._useSession(async e=>{var t,n,o;const{data:l,error:u}=e;if(u)throw u;return(null===(t=l.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await(0,i._request)(this.fetch,'GET',`${this.url}/user`,{headers:this.headers,jwt:null!==(o=null===(n=l.session)||void 0===n?void 0:n.access_token)&&void 0!==o?o:void 0,xform:i._userResponse}):{data:{user:null},error:new s.AuthSessionMissingError}})}catch(e){if((0,s.isAuthError)(e))return(0,s.isAuthSessionMissingError)(e)&&(await this._removeSession(),await(0,n.removeItemAsync)(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async o=>{const{data:l,error:u}=o;if(u)throw u;if(!l.session)throw new s.AuthSessionMissingError;const h=l.session;let c=null,_=null;'pkce'===this.flowType&&null!=e.email&&([c,_]=await(0,n.getCodeChallengeAndMethod)(this.storage,this.storageKey));const{data:w,error:y}=await(0,i._request)(this.fetch,'PUT',`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:_}),jwt:h.access_token,xform:i._userResponse});if(y)throw y;return h.user=w.user,await this._saveSession(h),await this._notifyAllSubscribers('USER_UPDATED',h),this._returnResult({data:{user:h.user},error:null})})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null},error:e});throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new s.AuthSessionMissingError;const t=Date.now()/1e3;let i=t,o=!0,l=null;const{payload:u}=(0,n.decodeJWT)(e.access_token);if(u.exp&&(i=u.exp,o=i<=t),o){const{data:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!t)return{data:{user:null,session:null},error:null};l=t}else{const{data:s,error:n}=await this._getUser(e.access_token);if(n)throw n;l={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:'bearer',expires_in:i-t,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers('SIGNED_IN',l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:s,error:n}=t;if(n)throw n;e=null!==(i=s.session)&&void 0!==i?i:void 0}if(!(null==e?void 0:e.refresh_token))throw new s.AuthSessionMissingError;const{data:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(e,i){try{if(!(0,n.isBrowser)())throw new s.AuthImplicitGrantRedirectError('No browser detected.');if(e.error||e.error_description||e.error_code)throw new s.AuthImplicitGrantRedirectError(e.error_description||'Error in URL with unspecified error_description',{error:e.error||'unspecified_error',code:e.error_code||'unspecified_code'});switch(i){case'implicit':if('pkce'===this.flowType)throw new s.AuthPKCEGrantCodeExchangeError('Not a valid PKCE flow url.');break;case'pkce':if('implicit'===this.flowType)throw new s.AuthImplicitGrantRedirectError('Not a valid implicit grant flow url.')}if('pkce'===i){if(this._debug('#_initialize()','begin','is PKCE flow',!0),!e.code)throw new s.AuthPKCEGrantCodeExchangeError('No code detected.');const{data:t,error:i}=await this._exchangeCodeForSession(e.code);if(i)throw i;const n=new URL(window.location.href);return n.searchParams.delete('code'),window.history.replaceState(window.history.state,'',n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:l,access_token:u,refresh_token:h,expires_in:c,expires_at:_,token_type:w}=e;if(!(u&&c&&h&&w))throw new s.AuthImplicitGrantRedirectError('No session defined in URL');const y=Math.round(Date.now()/1e3),f=parseInt(c);let p=y+f;_&&(p=parseInt(_));const v=p-y;1e3*v<=t.AUTO_REFRESH_TICK_DURATION_MS&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${f}s`);const b=p-f;y-b>=120?console.warn('@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale',b,p,y):y-b<0&&console.warn('@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew',b,p,y);const{data:k,error:S}=await this._getUser(u);if(S)throw S;const R={provider_token:o,provider_refresh_token:l,access_token:u,expires_in:f,expires_at:p,refresh_token:h,token_type:w,user:k.user};return window.location.hash='',this._debug('#_getSessionFromURL()','clearing window.location.hash'),this._returnResult({data:{session:R,redirectType:e.type},error:null})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{session:null,redirectType:null},error:e});throw e}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await(0,n.getItemAsync)(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:'global'}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:'global'}){return await this._useSession(async t=>{var i;const{data:o,error:l}=t;if(l)return this._returnResult({error:l});const u=null===(i=o.session)||void 0===i?void 0:i.access_token;if(u){const{error:t}=await this.admin.signOut(u,e);if(t&&(!(0,s.isAuthApiError)(t)||404!==t.status&&401!==t.status&&403!==t.status))return this._returnResult({error:t})}return'others'!==e&&(await this._removeSession(),await(0,n.removeItemAsync)(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=(0,n.generateCallbackId)(),s={id:t,callback:e,unsubscribe:()=>{this._debug('#unsubscribe()','state change callback with id removed',t),this.stateChangeEmitters.delete(t)}};return this._debug('#onAuthStateChange()','registered callback with id',t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,i;try{const{data:{session:i},error:n}=t;if(n)throw n;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback('INITIAL_SESSION',i)),this._debug('INITIAL_SESSION','callback id',e,'session',i)}catch(t){await(null===(i=this.stateChangeEmitters.get(e))||void 0===i?void 0:i.callback('INITIAL_SESSION',null)),this._debug('INITIAL_SESSION','callback id',e,'error',t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let o=null,l=null;'pkce'===this.flowType&&([o,l]=await(0,n.getCodeChallengeAndMethod)(this.storage,this.storageKey,!0));try{return await(0,i._request)(this.fetch,'POST',`${this.url}/recover`,{body:{email:e,code_challenge:o,code_challenge_method:l,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(e){return'token'in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:s,error:o}=await this._useSession(async t=>{var s,n,o,l,u;const{data:h,error:c}=t;if(c)throw c;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(o=e.options)||void 0===o?void 0:o.queryParams,skipBrowserRedirect:!0});return await(0,i._request)(this.fetch,'GET',_,{headers:this.headers,jwt:null!==(u=null===(l=h.session)||void 0===l?void 0:l.access_token)&&void 0!==u?u:void 0})});if(o)throw o;return(0,n.isBrowser)()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),this._returnResult({data:{provider:e.provider,url:null==s?void 0:s.url},error:null})}catch(t){if((0,s.isAuthError)(t))return this._returnResult({data:{provider:e.provider,url:null},error:t});throw t}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:o,data:{session:l}}=t;if(o)throw o;const{options:u,provider:h,token:c,access_token:_,nonce:w}=e,y=await(0,i._request)(this.fetch,'POST',`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!==(n=null==l?void 0:l.access_token)&&void 0!==n?n:void 0,body:{provider:h,id_token:c,access_token:_,nonce:w,link_identity:!0,gotrue_meta_security:{captcha_token:null==u?void 0:u.captchaToken}},xform:i._sessionResponse}),{data:f,error:p}=y;return p?this._returnResult({data:{user:null,session:null},error:p}):f&&f.session&&f.user?(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers('USER_UPDATED',f.session)),this._returnResult({data:f,error:p})):this._returnResult({data:{user:null,session:null},error:new s.AuthInvalidTokenResponseError})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:o,error:l}=t;if(l)throw l;return await(0,i._request)(this.fetch,'DELETE',`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(s=o.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0})})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(e){const o=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(o,'begin');try{const l=Date.now();return await(0,n.retryable)(async t=>(t>0&&await(0,n.sleep)(200*Math.pow(2,t-1)),this._debug(o,'refreshing attempt',t),await(0,i._request)(this.fetch,'POST',`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:i._sessionResponse})),(e,i)=>{const n=200*Math.pow(2,e);return i&&(0,s.isAuthRetryableFetchError)(i)&&Date.now()+n-l<t.AUTO_REFRESH_TICK_DURATION_MS})}catch(e){if(this._debug(o,'error',e),(0,s.isAuthError)(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}finally{this._debug(o,'end')}}_isValidSession(e){return'object'==typeof e&&null!==e&&'access_token'in e&&'refresh_token'in e&&'expires_at'in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug('#_handleProviderSignIn()','provider',e,'options',t,'url',s),(0,n.isBrowser)()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,i;const o='#_recoverAndRefresh()';this._debug(o,'begin');try{const l=await(0,n.getItemAsync)(this.storage,this.storageKey);if(l&&this.userStorage){let t=await(0,n.getItemAsync)(this.userStorage,this.storageKey+'-user');this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:l.user},await(0,n.setItemAsync)(this.userStorage,this.storageKey+'-user',t)),l.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:(0,n.userNotAvailableProxy)()}else if(l&&!l.user&&!l.user){const e=await(0,n.getItemAsync)(this.storage,this.storageKey+'-user');e&&(null==e?void 0:e.user)?(l.user=e.user,await(0,n.removeItemAsync)(this.storage,this.storageKey+'-user'),await(0,n.setItemAsync)(this.storage,this.storageKey,l)):l.user=(0,n.userNotAvailableProxy)()}if(this._debug(o,'session from storage',l),!this._isValidSession(l))return this._debug(o,'session is not valid'),void(null!==l&&await this._removeSession());const u=1e3*(null!==(i=l.expires_at)&&void 0!==i?i:1/0)-Date.now()<t.EXPIRY_MARGIN_MS;if(this._debug(o,`session has${u?'':' not'} expired with margin of ${t.EXPIRY_MARGIN_MS}s`),u){if(this.autoRefreshToken&&l.refresh_token){const{error:e}=await this._callRefreshToken(l.refresh_token);e&&(console.error(e),(0,s.isAuthRetryableFetchError)(e)||(this._debug(o,'refresh failed with a non-retryable error, removing the session',e),await this._removeSession()))}}else if(l.user&&!0===l.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(l.access_token);!t&&(null==e?void 0:e.user)?(l.user=e.user,await this._saveSession(l),await this._notifyAllSubscribers('SIGNED_IN',l)):this._debug(o,'could not get user data, skipping SIGNED_IN notification')}catch(e){console.error('Error getting user data:',e),this._debug(o,'error getting user data, skipping SIGNED_IN notification',e)}else await this._notifyAllSubscribers('SIGNED_IN',l)}catch(e){return this._debug(o,'error',e),void console.error(e)}finally{this._debug(o,'end')}}async _callRefreshToken(e){var t,i;if(!e)throw new s.AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,'begin');try{this.refreshingDeferred=new n.Deferred;const{data:t,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!t.session)throw new s.AuthSessionMissingError;await this._saveSession(t.session),await this._notifyAllSubscribers('TOKEN_REFRESHED',t.session);const o={data:t.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(e){if(this._debug(o,'error',e),(0,s.isAuthError)(e)){const i={data:null,error:e};return(0,s.isAuthRetryableFetchError)(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(i),i}throw null===(i=this.refreshingDeferred)||void 0===i||i.reject(e),e}finally{this.refreshingDeferred=null,this._debug(o,'end')}}async _notifyAllSubscribers(e,t,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,'begin',t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],n=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,t)}catch(e){i.push(e)}});if(await Promise.all(n),i.length>0){for(let e=0;e<i.length;e+=1)console.error(i[e]);throw i[0]}}finally{this._debug(i,'end')}}async _saveSession(e){this._debug('#_saveSession()',e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!s&&t.user&&await(0,n.setItemAsync)(this.userStorage,this.storageKey+'-user',{user:t.user});const e=Object.assign({},t);delete e.user;const i=(0,n.deepClone)(e);await(0,n.setItemAsync)(this.storage,this.storageKey,i)}else{const e=(0,n.deepClone)(t);await(0,n.setItemAsync)(this.storage,this.storageKey,e)}}async _removeSession(){this._debug('#_removeSession()'),await(0,n.removeItemAsync)(this.storage,this.storageKey),await(0,n.removeItemAsync)(this.storage,this.storageKey+'-code-verifier'),await(0,n.removeItemAsync)(this.storage,this.storageKey+'-user'),this.userStorage&&await(0,n.removeItemAsync)(this.userStorage,this.storageKey+'-user'),await this._notifyAllSubscribers('SIGNED_OUT',null)}_removeVisibilityChangedCallback(){this._debug('#_removeVisibilityChangedCallback()');const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&(0,n.isBrowser)()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener('visibilitychange',e)}catch(e){console.error('removing visibilitychange callback failed',e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug('#_startAutoRefresh()');const e=setInterval(()=>this._autoRefreshTokenTick(),t.AUTO_REFRESH_TICK_DURATION_MS);this.autoRefreshTicker=e,e&&'object'==typeof e&&'function'==typeof e.unref?e.unref():'undefined'!=typeof Deno&&'function'==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug('#_stopAutoRefresh()');const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug('#_autoRefreshTokenTick()','begin');try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async s=>{const{data:{session:i}}=s;if(!i||!i.refresh_token||!i.expires_at)return void this._debug('#_autoRefreshTokenTick()','no session');const n=Math.floor((1e3*i.expires_at-e)/t.AUTO_REFRESH_TICK_DURATION_MS);this._debug('#_autoRefreshTokenTick()',`access token expires in ${n} ticks, a tick lasts ${t.AUTO_REFRESH_TICK_DURATION_MS}ms, refresh threshold is ${t.AUTO_REFRESH_TICK_THRESHOLD} ticks`),n<=t.AUTO_REFRESH_TICK_THRESHOLD&&await this._callRefreshToken(i.refresh_token)})}catch(e){console.error('Auto refresh tick failed with error. This is likely a transient error.',e)}}finally{this._debug('#_autoRefreshTokenTick()','end')}})}catch(e){if(!(e.isAcquireTimeout||e instanceof l.LockAcquireTimeoutError))throw e;this._debug('auto refresh token tick lock not available')}}async _handleVisibilityChange(){if(this._debug('#_handleVisibilityChange()'),!(0,n.isBrowser)()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener('visibilitychange',this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error('_handleVisibilityChange',e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,'visibilityState',document.visibilityState),'visible'===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{'visible'===document.visibilityState?await this._recoverAndRefresh():this._debug(t,'acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting')}))):'hidden'===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const i=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),'pkce'===this.flowType){const[e,t]=await(0,n.getCodeChallengeAndMethod)(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});i.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);i.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join('&')}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:o}=t;return o?this._returnResult({data:null,error:o}):await(0,i._request)(this.fetch,'DELETE',`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token})})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:o,error:l}=t;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},'phone'===e.factorType?{phone:e.phone}:'totp'===e.factorType?{issuer:e.issuer}:{}),{data:h,error:c}=await(0,i._request)(this.fetch,'POST',`${this.url}/factors`,{body:u,headers:this.headers,jwt:null===(s=null==o?void 0:o.session)||void 0===s?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):('totp'===e.factorType&&'totp'===h.type&&(null===(n=null==h?void 0:h.totp)||void 0===n?void 0:n.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({challenge_id:e.challengeId},'webauthn'in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:'create'===e.webauthn.type?(0,w.serializeCredentialCreationResponse)(e.webauthn.credential_response):(0,w.serializeCredentialRequestResponse)(e.webauthn.credential_response)})}:{code:e.code}),{data:u,error:h}=await(0,i._request)(this.fetch,'POST',`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers('MFA_CHALLENGE_VERIFIED',u),this._returnResult({data:u,error:h}))})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=await(0,i._request)(this.fetch,'POST',`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token});if(l.error)return l;const{data:u}=l;if('webauthn'!==u.type)return{data:u,error:null};switch(u.webauthn.type){case'create':return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:(0,w.deserializeCredentialCreationOptions)(u.webauthn.credential_options.publicKey)})})}),error:null};case'request':return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:(0,w.deserializeCredentialRequestOptions)(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of null!==(e=null==t?void 0:t.factors)&&void 0!==e?e:[])i.all.push(s),'verified'===s.status&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:s},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=(0,n.decodeJWT)(s.access_token);let l=null;o.aal&&(l=o.aal);let u=l;(null!==(t=null===(e=s.user.factors)||void 0===e?void 0:e.filter(e=>'verified'===e.status))&&void 0!==t?t:[]).length>0&&(u='aal2');return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:o.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:o}=t;return o?this._returnResult({data:null,error:o}):n?await(0,i._request)(this.fetch,'GET',`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new s.AuthSessionMissingError})})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(e,t){try{return await this._useSession(async o=>{const{data:{session:l},error:u}=o;if(u)return this._returnResult({data:null,error:u});if(!l)return this._returnResult({data:null,error:new s.AuthSessionMissingError});const h=await(0,i._request)(this.fetch,'POST',`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:l.access_token,body:{action:'approve'},xform:e=>({data:e,error:null})});return h.data&&h.data.redirect_url&&(0,n.isBrowser)()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(h.data.redirect_url),h})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}async _denyAuthorization(e,t){try{return await this._useSession(async o=>{const{data:{session:l},error:u}=o;if(u)return this._returnResult({data:null,error:u});if(!l)return this._returnResult({data:null,error:new s.AuthSessionMissingError});const h=await(0,i._request)(this.fetch,'POST',`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:l.access_token,body:{action:'deny'},xform:e=>({data:e,error:null})});return h.data&&h.data.redirect_url&&(0,n.isBrowser)()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(h.data.redirect_url),h})}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(e,s={keys:[]}){let n=s.keys.find(t=>t.kid===e);if(n)return n;const o=Date.now();if(n=this.jwks.keys.find(t=>t.kid===e),n&&this.jwks_cached_at+t.JWKS_TTL>o)return n;const{data:l,error:u}=await(0,i._request)(this.fetch,'GET',`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return l.keys&&0!==l.keys.length?(this.jwks=l,this.jwks_cached_at=o,n=l.keys.find(t=>t.kid===e),n||null):null}async getClaims(e,t={}){try{let i=e;if(!i){const{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});i=e.session.access_token}const{header:o,payload:l,signature:u,raw:{header:h,payload:_}}=(0,n.decodeJWT)(i);(null==t?void 0:t.allowExpired)||(0,n.validateExp)(l.exp);const w=o.alg&&!o.alg.startsWith('HS')&&o.kid&&'crypto'in globalThis&&'subtle'in globalThis.crypto?await this.fetchJwk(o.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!w){const{error:e}=await this.getUser(i);if(e)throw e;return{data:{claims:l,header:o,signature:u},error:null}}const y=(0,n.getAlgorithm)(o.alg),f=await crypto.subtle.importKey('jwk',w,y,!0,['verify']);if(!await crypto.subtle.verify(y,f,u,(0,c.stringToUint8Array)(`${h}.${_}`)))throw new s.AuthInvalidJwtError('Invalid JWT signature');return{data:{claims:l,header:o,signature:u},error:null}}catch(e){if((0,s.isAuthError)(e))return this._returnResult({data:null,error:e});throw e}}}v.nextInstanceID={},_e2.default=v},4873,[749,4865,4867,4870,4866,4869,4874,4875,4876,4868,4871,4877,4878]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.memoryLocalStorageAdapter=function(t={}){return{getItem:o=>t[o]||null,setItem:(o,n)=>{t[o]=n},removeItem:o=>{delete t[o]}}}},4874,[]);
__d(function(g,r,i,a,m,_e,d){"use strict";Object.defineProperty(_e,"__esModule",{value:!0}),_e.ProcessLockAcquireTimeoutError=_e.NavigatorLockAcquireTimeoutError=_e.LockAcquireTimeoutError=_e.internals=void 0,_e.navigatorLock=async function(e,o,s){_e.internals.debug&&console.log('@supabase/gotrue-js: navigatorLock: acquire lock',e,o);const n=new globalThis.AbortController;o>0&&setTimeout(()=>{n.abort(),_e.internals.debug&&console.log('@supabase/gotrue-js: navigatorLock acquire timed out',e)},o);return await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===o?{mode:'exclusive',ifAvailable:!0}:{mode:'exclusive',signal:n.signal},async n=>{if(!n){if(0===o)throw _e.internals.debug&&console.log('@supabase/gotrue-js: navigatorLock: not immediately available',e),new t(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(_e.internals.debug)try{const e=await globalThis.navigator.locks.query();console.log('@supabase/gotrue-js: Navigator LockManager state',JSON.stringify(e,null,'  '))}catch(e){console.warn('@supabase/gotrue-js: Error when querying Navigator LockManager state',e)}return console.warn('@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request'),await s()}_e.internals.debug&&console.log('@supabase/gotrue-js: navigatorLock: acquired',e,n.name);try{return await s()}finally{_e.internals.debug&&console.log('@supabase/gotrue-js: navigatorLock: released',e,n.name)}}))},_e.processLock=async function(e,o,t){var l;const c=null!==(l=n[e])&&void 0!==l?l:Promise.resolve(),u=Promise.race([c.catch(()=>null),o>=0?new Promise((t,n)=>{setTimeout(()=>{n(new s(`Acquring process lock with name "${e}" timed out`))},o)}):null].filter(e=>e)).catch(e=>{if(e&&e.isAcquireTimeout)throw e;return null}).then(async()=>await t());return n[e]=u.catch(async e=>{if(e&&e.isAcquireTimeout)return await c,null;throw e}),await u};const e=r(d[0]);_e.internals={debug:!!(globalThis&&(0,e.supportsLocalStorage)()&&globalThis.localStorage&&'true'===globalThis.localStorage.getItem('supabase.gotrue-js.locks.debug'))};class o extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}_e.LockAcquireTimeoutError=o;class t extends o{}_e.NavigatorLockAcquireTimeoutError=t;class s extends o{}_e.ProcessLockAcquireTimeoutError=s;const n={}},4875,[4869]);
__d(function(g,r,i,a,m,_e,d){"use strict";Object.defineProperty(_e,"__esModule",{value:!0}),_e.polyfillGlobalThis=function(){if('object'==typeof globalThis)return;try{Object.defineProperty(Object.prototype,'__magic__',{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){'undefined'!=typeof self&&(self.globalThis=self)}}},4876,[]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}Object.defineProperty(e,"__esModule",{value:!0}),e.getAddress=t,e.fromHex=function(t){return parseInt(t,16)},e.toHex=function(t){const n=(new TextEncoder).encode(t);return'0x'+Array.from(n,t=>t.toString(16).padStart(2,'0')).join('')},e.createSiweMessage=function(n){var s;const{chainId:o,domain:u,expirationTime:c,issuedAt:l=new Date,nonce:f,notBefore:I,requestId:v,resources:h,scheme:$,uri:w,version:E}=n;if(!Number.isInteger(o))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${o}`);if(!u)throw new Error("@supabase/auth-js: Invalid SIWE message field \"domain\". Domain must be provided.");if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!w)throw new Error("@supabase/auth-js: Invalid SIWE message field \"uri\". URI must be provided.");if('1'!==E)throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(null===(s=n.statement)||void 0===s?void 0:s.includes('\n'))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`);const S=t(n.address),b=$?`${$}://${u}`:u,p=n.statement?`${n.statement}\n`:'',j=`${b} wants you to sign in with your Ethereum account:\n${S}\n\n${p}`;let x=`URI: ${w}\nVersion: ${E}\nChain ID: ${o}${f?`\nNonce: ${f}`:''}\nIssued At: ${l.toISOString()}`;c&&(x+=`\nExpiration Time: ${c.toISOString()}`);I&&(x+=`\nNot Before: ${I.toISOString()}`);v&&(x+=`\nRequest ID: ${v}`);if(h){let t='\nResources:';for(const n of h){if(!n||'string'!=typeof n)throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${n}`);t+=`\n- ${n}`}x+=t}return`${j}\n${x}`}},4877,[]);
__d(function(g,r,_i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebAuthnApi=e.DEFAULT_REQUEST_OPTIONS=e.DEFAULT_CREATION_OPTIONS=e.webAuthnAbortService=e.WebAuthnAbortService=e.identifyAuthenticationError=e.identifyRegistrationError=e.isWebAuthnError=e.WebAuthnError=void 0,e.deserializeCredentialCreationOptions=function(i){if(!i)throw new Error('Credential creation options are required');if('undefined'!=typeof PublicKeyCredential&&'parseCreationOptionsFromJSON'in PublicKeyCredential&&'function'==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(i);const{challenge:o,user:l,excludeCredentials:s}=i,u=t.__rest(i,["challenge","user","excludeCredentials"]),c=(0,n.base64UrlToUint8Array)(o).buffer,h=Object.assign(Object.assign({},l),{id:(0,n.base64UrlToUint8Array)(l.id).buffer}),f=Object.assign(Object.assign({},u),{challenge:c,user:h});if(s&&s.length>0){f.excludeCredentials=new Array(s.length);for(let t=0;t<s.length;t++){const i=s[t];f.excludeCredentials[t]=Object.assign(Object.assign({},i),{id:(0,n.base64UrlToUint8Array)(i.id).buffer,type:i.type||'public-key',transports:i.transports})}}return f},e.deserializeCredentialRequestOptions=function(i){if(!i)throw new Error('Credential request options are required');if('undefined'!=typeof PublicKeyCredential&&'parseRequestOptionsFromJSON'in PublicKeyCredential&&'function'==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(i);const{challenge:o,allowCredentials:l}=i,s=t.__rest(i,["challenge","allowCredentials"]),u=(0,n.base64UrlToUint8Array)(o).buffer,c=Object.assign(Object.assign({},s),{challenge:u});if(l&&l.length>0){c.allowCredentials=new Array(l.length);for(let t=0;t<l.length;t++){const i=l[t];c.allowCredentials[t]=Object.assign(Object.assign({},i),{id:(0,n.base64UrlToUint8Array)(i.id).buffer,type:i.type||'public-key',transports:i.transports})}}return c},e.serializeCredentialCreationResponse=function(t){var i;if('toJSON'in t&&'function'==typeof t.toJSON)return t.toJSON();const o=t;return{id:t.id,rawId:t.id,response:{attestationObject:(0,n.bytesToBase64URL)(new Uint8Array(t.response.attestationObject)),clientDataJSON:(0,n.bytesToBase64URL)(new Uint8Array(t.response.clientDataJSON))},type:'public-key',clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:null!==(i=o.authenticatorAttachment)&&void 0!==i?i:void 0}},e.serializeCredentialRequestResponse=function(t){var i;if('toJSON'in t&&'function'==typeof t.toJSON)return t.toJSON();const o=t,l=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:(0,n.bytesToBase64URL)(new Uint8Array(s.authenticatorData)),clientDataJSON:(0,n.bytesToBase64URL)(new Uint8Array(s.clientDataJSON)),signature:(0,n.bytesToBase64URL)(new Uint8Array(s.signature)),userHandle:s.userHandle?(0,n.bytesToBase64URL)(new Uint8Array(s.userHandle)):void 0},type:'public-key',clientExtensionResults:l,authenticatorAttachment:null!==(i=o.authenticatorAttachment)&&void 0!==i?i:void 0}},e.isValidDomain=function(t){return'localhost'===t||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)},e.createCredential=c,e.getCredential=h,e.mergeCredentialCreationOptions=b,e.mergeCredentialRequestOptions=y;const t=r(d[0]),n=r(d[1]),i=r(d[2]),o=r(d[3]),l=r(d[4]);Object.defineProperty(e,"identifyAuthenticationError",{enumerable:!0,get:function(){return l.identifyAuthenticationError}}),Object.defineProperty(e,"identifyRegistrationError",{enumerable:!0,get:function(){return l.identifyRegistrationError}}),Object.defineProperty(e,"isWebAuthnError",{enumerable:!0,get:function(){return l.isWebAuthnError}}),Object.defineProperty(e,"WebAuthnError",{enumerable:!0,get:function(){return l.WebAuthnError}});class s{createNewAbortSignal(){if(this.controller){const t=new Error('Cancelling existing WebAuthn API call for new one');t.name='AbortError',this.controller.abort(t)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error('Manually cancelling existing WebAuthn API call');t.name='AbortError',this.controller.abort(t),this.controller=void 0}}}function u(){var t,n;return!!((0,o.isBrowser)()&&'PublicKeyCredential'in window&&window.PublicKeyCredential&&'credentials'in navigator&&'function'==typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.create)&&'function'==typeof(null===(n=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===n?void 0:n.get))}async function c(t){try{const n=await navigator.credentials.create(t);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new l.WebAuthnUnknownError('Browser returned unexpected credential type',n)}:{data:null,error:new l.WebAuthnUnknownError('Empty credential response',n)}}catch(n){return{data:null,error:(0,l.identifyRegistrationError)({error:n,options:t})}}}async function h(t){try{const n=await navigator.credentials.get(t);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new l.WebAuthnUnknownError('Browser returned unexpected credential type',n)}:{data:null,error:new l.WebAuthnUnknownError('Empty credential response',n)}}catch(n){return{data:null,error:(0,l.identifyAuthenticationError)({error:n,options:t})}}}function f(...t){const n=t=>null!==t&&'object'==typeof t&&!Array.isArray(t),i=t=>t instanceof ArrayBuffer||ArrayBuffer.isView(t),o={};for(const l of t)if(l)for(const t in l){const s=l[t];if(void 0!==s)if(Array.isArray(s))o[t]=s;else if(i(s))o[t]=s;else if(n(s)){const i=o[t];n(i)?o[t]=f(i,s):o[t]=f(s)}else o[t]=s}return o}function b(t,n){return f(e.DEFAULT_CREATION_OPTIONS,t,n||{})}function y(t,n){return f(e.DEFAULT_REQUEST_OPTIONS,t,n||{})}e.WebAuthnAbortService=s,e.webAuthnAbortService=new s,e.DEFAULT_CREATION_OPTIONS={hints:['security-key'],authenticatorSelection:{authenticatorAttachment:'cross-platform',requireResidentKey:!1,userVerification:'preferred',residentKey:'discouraged'},attestation:'direct'},e.DEFAULT_REQUEST_OPTIONS={userVerification:'preferred',hints:['security-key'],attestation:'direct'};e.WebAuthnApi=class{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:'webauthn'}))}async _challenge({factorId:t,webauthn:n,friendlyName:o,signal:l},s){try{const{data:i,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!i)return{data:null,error:u};const f=null!=l?l:e.webAuthnAbortService.createNewAbortSignal();if('create'===i.webauthn.type){const{user:t}=i.webauthn.credential_options.publicKey;t.name||(t.name=`${t.id}:${o}`),t.displayName||(t.displayName=t.name)}switch(i.webauthn.type){case'create':{const n=b(i.webauthn.credential_options.publicKey,null==s?void 0:s.create),{data:o,error:l}=await c({publicKey:n,signal:f});return o?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:o}},error:null}:{data:null,error:l}}case'request':{const n=y(i.webauthn.credential_options.publicKey,null==s?void 0:s.request),{data:o,error:l}=await h(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:n,signal:f}));return o?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:o}},error:null}:{data:null,error:l}}}}catch(t){return(0,i.isAuthError)(t)?{data:null,error:t}:{data:null,error:new i.AuthUnknownError('Unexpected error in challenge',t)}}}async _verify({challengeId:t,factorId:n,webauthn:i}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:i})}async _authenticate({factorId:t,webauthn:{rpId:n,rpOrigins:o,signal:l}={}},s){if(!n)return{data:null,error:new i.AuthError('rpId is required for WebAuthn authentication')};try{if(!u())return{data:null,error:new i.AuthUnknownError('Browser does not support WebAuthn',null)};const{data:c,error:h}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:o},signal:l},{request:s});if(!c)return{data:null,error:h};const{webauthn:f}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:f.type,rpId:n,rpOrigins:o,credential_response:f.credential_response}})}catch(t){return(0,i.isAuthError)(t)?{data:null,error:t}:{data:null,error:new i.AuthUnknownError('Unexpected error in authenticate',t)}}}async _register({friendlyName:t,webauthn:{rpId:n,rpOrigins:o,signal:l}={}},s){if(!n)return{data:null,error:new i.AuthError('rpId is required for WebAuthn registration')};try{if(!u())return{data:null,error:new i.AuthUnknownError('Browser does not support WebAuthn',null)};const{data:c,error:h}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(n=>{var i;return null===(i=n.data)||void 0===i?void 0:i.all.find(n=>'webauthn'===n.factor_type&&n.friendly_name===t&&'unverified'!==n.status)}).then(t=>t?this.client.mfa.unenroll({factorId:null==t?void 0:t.id}):void 0),{data:null,error:h};const{data:f,error:b}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:n,rpOrigins:o},signal:l},{create:s});return f?this._verify({factorId:c.id,challengeId:f.challengeId,webauthn:{rpId:n,rpOrigins:o,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:b}}catch(t){return(0,i.isAuthError)(t)?{data:null,error:t}:{data:null,error:new i.AuthUnknownError('Unexpected error in register',t)}}}}},4878,[749,4871,4870,4869,4879]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebAuthnUnknownError=e.WebAuthnError=void 0,e.isWebAuthnError=function(n){return'object'==typeof n&&null!==n&&'__isWebAuthnError'in n},e.identifyRegistrationError=function({error:t,options:s}){var R,u,c;const{publicKey:E}=s;if(!E)throw Error('options was missing required publicKey property');if('AbortError'===t.name){if(s.signal instanceof AbortSignal)return new o({message:'Registration ceremony was sent an abort signal',code:'ERROR_CEREMONY_ABORTED',cause:t})}else if('ConstraintError'===t.name){if(!0===(null===(R=E.authenticatorSelection)||void 0===R?void 0:R.requireResidentKey))return new o({message:'Discoverable credentials were required but no available authenticator supported it',code:'ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT',cause:t});if('conditional'===s.mediation&&'required'===(null===(u=E.authenticatorSelection)||void 0===u?void 0:u.userVerification))return new o({message:'User verification was required during automatic registration but it could not be performed',code:'ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE',cause:t});if('required'===(null===(c=E.authenticatorSelection)||void 0===c?void 0:c.userVerification))return new o({message:'User verification was required but no available authenticator supported it',code:'ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT',cause:t})}else{if('InvalidStateError'===t.name)return new o({message:'The authenticator was previously registered',code:'ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED',cause:t});if('NotAllowedError'===t.name)return new o({message:t.message,code:'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',cause:t});if('NotSupportedError'===t.name){return 0===E.pubKeyCredParams.filter(n=>'public-key'===n.type).length?new o({message:'No entry in pubKeyCredParams was of type "public-key"',code:'ERROR_MALFORMED_PUBKEYCREDPARAMS',cause:t}):new o({message:'No available authenticator supported any of the specified pubKeyCredParams algorithms',code:'ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG',cause:t})}if('SecurityError'===t.name){const s=window.location.hostname;if(!(0,n.isValidDomain)(s))return new o({message:`${window.location.hostname} is an invalid domain`,code:'ERROR_INVALID_DOMAIN',cause:t});if(E.rp.id!==s)return new o({message:`The RP ID "${E.rp.id}" is invalid for this domain`,code:'ERROR_INVALID_RP_ID',cause:t})}else if('TypeError'===t.name){if(E.user.id.byteLength<1||E.user.id.byteLength>64)return new o({message:'User ID was not between 1 and 64 characters',code:'ERROR_INVALID_USER_ID_LENGTH',cause:t})}else if('UnknownError'===t.name)return new o({message:'The authenticator was unable to process the specified options, or could not create a new credential',code:'ERROR_AUTHENTICATOR_GENERAL_ERROR',cause:t})}return new o({message:'a Non-Webauthn related error has occurred',code:'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',cause:t})},e.identifyAuthenticationError=function({error:t,options:s}){const{publicKey:R}=s;if(!R)throw Error('options was missing required publicKey property');if('AbortError'===t.name){if(s.signal instanceof AbortSignal)return new o({message:'Authentication ceremony was sent an abort signal',code:'ERROR_CEREMONY_ABORTED',cause:t})}else{if('NotAllowedError'===t.name)return new o({message:t.message,code:'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',cause:t});if('SecurityError'===t.name){const s=window.location.hostname;if(!(0,n.isValidDomain)(s))return new o({message:`${window.location.hostname} is an invalid domain`,code:'ERROR_INVALID_DOMAIN',cause:t});if(R.rpId!==s)return new o({message:`The RP ID "${R.rpId}" is invalid for this domain`,code:'ERROR_INVALID_RP_ID',cause:t})}else if('UnknownError'===t.name)return new o({message:'The authenticator was unable to process the specified options, or could not create a new assertion signature',code:'ERROR_AUTHENTICATOR_GENERAL_ERROR',cause:t})}return new o({message:'a Non-Webauthn related error has occurred',code:'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',cause:t})};const n=r(d[0]);class o extends Error{constructor({message:n,code:o,cause:t,name:s}){var R;super(n,{cause:t}),this.__isWebAuthnError=!0,this.name=null!==(R=null!=s?s:t instanceof Error?t.name:void 0)&&void 0!==R?R:'Unknown Error',this.code=o}}e.WebAuthnError=o;e.WebAuthnUnknownError=class extends o{constructor(n,o){super({code:'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',cause:o,message:n}),this.name='WebAuthnUnknownError',this.originalError=o}}},4879,[4878]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]).__importDefault(r(d[1])).default;e.default=t},4880,[749,4865]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const t=r(d[0]).__importDefault(r(d[1])).default;e.default=t},4881,[749,4873]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:http')},4889,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:https')},4890,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:zlib')},4891,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:events')},4897,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:net')},4898,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:tls')},4899,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:url')},4900,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:fs')},4907,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:path')},4908,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:os')},4909,[]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.supabaseServer=void 0;var n=r(d[0]);const o='undefined'!=typeof process?process.env.EXPO_PUBLIC_SUPABASE_URL:void 0,s='undefined'!=typeof process?process.env.SUPABASE_SERVICE_ROLE_KEY:void 0;let t=null;function u(){if(!o||!s)throw new Error('Missing Supabase environment variables. Please set EXPO_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY in your environment.');return t||(t=(0,n.createClient)(o,s,{auth:{autoRefreshToken:!1,persistSession:!1}})),t}e.supabaseServer=new Proxy({},{get(n,o){const s=u(),t=s[o];return'function'==typeof t?t.bind(s):t}})},7118,[4820]);
__d(function(g,r,i,a,_m,e,d){'use strict';const t=r(d[0]),s=r(d[1]),n=r(d[2]),o=r(d[3]),l=r(d[4]),c=r(d[5]),p=r(d[6]),u=r(d[7]),f=r(d[8]),E=r(d[9]),m=(process.env.ETHEREAL_API||'https://api.nodemailer.com').replace(/\/+$/,''),S=(process.env.ETHEREAL_WEB||'https://ethereal.email').replace(/\/+$/,''),w=(process.env.ETHEREAL_API_KEY||'').replace(/\s*/g,'')||null,y=['true','yes','y','1'].includes((process.env.ETHEREAL_CACHE||'yes').toString().trim().toLowerCase());let h=!1;_m.exports.createTransport=function(f,E){let m,S,w;if('object'==typeof f&&'function'!=typeof f.send||'string'==typeof f&&/^(smtps?|direct):/i.test(f))if(S=(m='string'==typeof f?f:f.url)?s.parseConnectionUrl(m):f,S.pool)f=new n(S);else if(S.sendmail)f=new l(S);else if(S.streamTransport)f=new c(S);else if(S.jsonTransport)f=new p(S);else if(S.SES){if(S.SES.ses&&S.SES.aws){let t=new Error('Using legacy SES configuration, expecting @aws-sdk/client-sesv2, see https://nodemailer.com/transports/ses/');throw t.code='LegacyConfig',t}f=new u(S)}else f=new o(S);return w=new t(f,S,E),w},_m.exports.createTestAccount=function(t,n){let o;if(n||'function'!=typeof t||(n=t,t=!1),n||(o=new Promise((t,o)=>{n=s.callbackPromise(t,o)})),y&&h)return setImmediate(()=>n(null,h)),o;t=t||m;let l=[],c=0,p={},u={requestor:E.name,version:E.version};w&&(p.Authorization='Bearer '+w);let S=f(t+'/user',{contentType:'application/json',method:'POST',headers:p,body:Buffer.from(JSON.stringify(u))});return S.on('readable',()=>{let t;for(;null!==(t=S.read());)l.push(t),c+=t.length}),S.once('error',t=>n(t)),S.once('end',()=>{let t,s,o=Buffer.concat(l,c);try{t=JSON.parse(o.toString())}catch(t){s=t}return s?n(s):'success'!==t.status||t.error?n(new Error(t.error||'Request failed')):(delete t.status,h=t,void n(null,h))}),o},_m.exports.getTestMessageUrl=function(t){if(!t||!t.response)return!1;let s=new Map;return t.response.replace(/\[([^\]]+)\]$/,(t,n)=>{n.replace(/\b([A-Z0-9]+)=([^\s]+)/g,(t,n,o)=>{s.set(n,o)})}),!(!s.has('STATUS')||!s.has('MSGID'))&&(h.web||S)+'/message/'+s.get('MSGID')}},7119,[7120,7121,7143,7150,7151,7153,7154,7155,7122,7124]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]),s=r(d[1]),o=r(d[2]),n=r(d[3]),h=r(d[4]),l=r(d[5]),p=r(d[6]),c=r(d[7]),u=r(d[8]),f=r(d[9]),k=r(d[10]),y=r(d[11]),x=r(d[12]);m.exports=class extends t{constructor(t,o,n){super(),this.options=o||{},this._defaults=n||{},this._defaultPlugins={compile:[(...t)=>this._convertDataImages(...t)],stream:[]},this._userPlugins={compile:[],stream:[]},this.meta=new Map,this.dkim=!!this.options.dkim&&new h(this.options.dkim),this.transporter=t,this.transporter.mailer=this,this.logger=s.getLogger(this.options,{component:this.options.component||'mail'}),this.logger.debug({tnx:'create'},'Creating transport: %s',this.getVersionString()),'function'==typeof this.transporter.on&&(this.transporter.on('log',t=>{this.logger.debug({tnx:'transport'},'%s: %s',t.type,t.message)}),this.transporter.on('error',t=>{this.logger.error({err:t,tnx:'transport'},'Transport Error: %s',t.message),this.emit('error',t)}),this.transporter.on('idle',(...t)=>{this.emit('idle',...t)}),this.transporter.on('clear',(...t)=>{this.emit('clear',...t)})),['close','isIdle','verify'].forEach(t=>{this[t]=(...s)=>'function'==typeof this.transporter[t]?('verify'===t&&'function'==typeof this.getSocket&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1),this.transporter[t](...s)):(this.logger.warn({tnx:'transport',methodName:t},'Non existing method %s called for transport',t),!1)}),this.options.proxy&&'string'==typeof this.options.proxy&&this.setupProxy(this.options.proxy)}use(t,s){return t=(t||'').toString(),this._userPlugins.hasOwnProperty(t)?this._userPlugins[t].push(s):this._userPlugins[t]=[s],this}sendMail(t,o=null){let l;o||(l=new Promise((t,n)=>{o=s.callbackPromise(t,n)})),'function'==typeof this.getSocket&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1);let p=new f(this,t);return this.logger.debug({tnx:'transport',name:this.transporter.name,version:this.transporter.version,action:'send'},'Sending mail using %s/%s',this.transporter.name,this.transporter.version),this._processPlugins('compile',p,t=>{if(t)return this.logger.error({err:t,tnx:'plugin',action:'compile'},'PluginCompile Error: %s',t.message),o(t);p.message=new n(p.data).compile(),p.setMailerHeader(),p.setPriorityHeaders(),p.setListHeaders(),this._processPlugins('stream',p,t=>{if(t)return this.logger.error({err:t,tnx:'plugin',action:'stream'},'PluginStream Error: %s',t.message),o(t);(p.data.dkim||this.dkim)&&p.message.processFunc(t=>{let s=p.data.dkim?new h(p.data.dkim):this.dkim;return this.logger.debug({tnx:'DKIM',messageId:p.message.messageId(),dkimDomains:s.keys.map(t=>t.keySelector+'.'+t.domainName).join(', ')},'Signing outgoing message with %s keys',s.keys.length),s.sign(t,p.data._dkim)}),this.transporter.send(p,(...t)=>{t[0]&&this.logger.error({err:t[0],tnx:'transport',action:'send'},'Send Error: %s',t[0].message),o(...t)})})}),l}getVersionString(){return p.format('%s (%s; +%s; %s/%s)',u.name,u.version,u.homepage,this.transporter.name,this.transporter.version)}_processPlugins(t,s,o){if(t=(t||'').toString(),!this._userPlugins.hasOwnProperty(t))return o();let n=this._userPlugins[t]||[],h=this._defaultPlugins[t]||[];if(n.length&&this.logger.debug({tnx:'transaction',pluginCount:n.length,step:t},'Using %s plugins for %s',n.length,t),n.length+h.length===0)return o();let l=0,p='default',c=()=>{let t='default'===p?h:n;if(l>=t.length){if('default'!==p||!n.length)return o();p='user',l=0,t=n}(0,t[l++])(s,t=>{if(t)return o(t);c()})};c()}setupProxy(t){let s=c.parse(t);this.getSocket=(t,o)=>{let n=s.protocol.replace(/:$/,'').toLowerCase();if(this.meta.has('proxy_handler_'+n))return this.meta.get('proxy_handler_'+n)(s,t,o);switch(n){case'http':case'https':return void l(s.href,t.port,t.host,(t,s)=>t?o(t):o(null,{connection:s}));case'socks':case'socks5':case'socks4':case'socks4a':{if(!this.meta.has('proxy_socks_module'))return o(new Error('Socks module not loaded'));let n=n=>{let h=!!this.meta.get('proxy_socks_module').SocksClient,l=h?this.meta.get('proxy_socks_module').SocksClient:this.meta.get('proxy_socks_module'),p=Number(s.protocol.replace(/\D/g,''))||5,c={proxy:{ipaddress:n,port:Number(s.port),type:p},[h?'destination':'target']:{host:t.host,port:t.port},command:'connect'};if(s.auth){let t=decodeURIComponent(s.auth.split(':').shift()),o=decodeURIComponent(s.auth.split(':').pop());h?(c.proxy.userId=t,c.proxy.password=o):4===p?c.userid=t:c.authentication={username:t,password:o}}l.createConnection(c,(t,s)=>t?o(t):o(null,{connection:s.socket||s}))};return k.isIP(s.hostname)?n(s.hostname):y.resolve(s.hostname,(t,s)=>{if(t)return o(t);n(Array.isArray(s)?s[0]:s)})}}o(new Error('Unknown proxy configuration'))}}_convertDataImages(t,s){if(!this.options.attachDataUrls&&!t.data.attachDataUrls||!t.data.html)return s();t.resolveContent(t.data,'html',(n,h)=>{if(n)return s(n);let l=0;h=(h||'').toString().replace(/(<img\b[^<>]{0,1024} src\s{0,20}=[\s"']{0,20})(data:([^;]+);[^"'>\s]+)/gi,(s,n,h,p)=>{let c=x.randomBytes(10).toString('hex')+'@localhost';return t.data.attachments||(t.data.attachments=[]),Array.isArray(t.data.attachments)||(t.data.attachments=[].concat(t.data.attachments||[])),t.data.attachments.push({path:h,cid:c,filename:'image-'+ ++l+'.'+o.detectExtension(p)}),n+'cid:'+c}),t.data.html=h,s()})}set(t,s){return this.meta.set(t,s)}get(t){return this.meta.get(t)}}},7120,[4897,7121,7126,7127,7137,7141,4790,4900,7124,7142,4898,7125,4791]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]),s=r(d[1]),n=r(d[2]),l=r(d[3]),o=r(d[4]),c=r(d[5]),u=r(d[6]),i=3e5;let f,h=0;m.exports._lastCacheCleanup=()=>h,m.exports._resetCacheCleanup=()=>{h=0};try{f=u.networkInterfaces()}catch(t){}m.exports.networkInterfaces=f;const p=(t,s)=>{let n=m.exports.networkInterfaces;if(!n)return!0;return Object.keys(n).map(t=>n[t]).reduce((t,s)=>t.concat(s),[]).filter(t=>!t.internal||s).filter(s=>s.family==='IPv'+t||s.family===t).length>0},x=(t,s,n,l)=>{if(!p(t,(n=n||{}).allowInternalNetworkInterfaces))return l(null,[]);(o.Resolver?new o.Resolver(n):o)['resolve'+t](s,(t,s)=>{if(t){switch(t.code){case o.NODATA:case o.NOTFOUND:case o.NOTIMP:case o.SERVFAIL:case o.CONNREFUSED:case o.REFUSED:case'EAI_AGAIN':return l(null,[])}return l(t)}return l(null,Array.isArray(s)?s:[].concat(s||[]))})},v=m.exports.dnsCache=new Map,b=(t,s)=>t?Object.assign({servername:t.servername,host:t.addresses&&t.addresses.length?1===t.addresses.length?t.addresses[0]:t.addresses[Math.floor(Math.random()*t.addresses.length)]:null},s||{}):Object.assign({},s||{});function y(t,s){let n=!1,l=[],o=0;t.on('error',t=>{n||(n=!0,s(t))}),t.on('readable',()=>{let s;for(;null!==(s=t.read());)l.push(s),o+=s.length}),t.on('end',()=>{if(n)return;let t;n=!0;try{t=Buffer.concat(l,o)}catch(t){return s(t)}s(null,t)})}function w(t){let n=0,l=new Map;t.forEach(t=>{t.length>n&&(n=t.length)}),t.forEach(t=>{let s=t.toUpperCase();s.length<n&&(s+=' '.repeat(n-s.length)),l.set(t,s)});let o=(t,n,o,...c)=>{let u='';n&&('server'===n.tnx?u='S: ':'client'===n.tnx&&(u='C: '),n.sid&&(u='['+n.sid+'] '+u),n.cid&&(u='[#'+n.cid+'] '+u)),(o=s.format(o,...c)).split(/\r?\n/).forEach(s=>{console.log('[%s] %s %s',(new Date).toISOString().substr(0,19).replace(/T/,' '),l.get(t),u+s)})},c={};return t.forEach(t=>{c[t]=o.bind(null,t)}),c}m.exports.resolveHostname=(t,s)=>{if(!(t=t||{}).host&&t.servername&&(t.host=t.servername),!t.host||c.isIP(t.host)){let n={addresses:[t.host],servername:t.servername||!1};return s(null,b(n,{cached:!1}))}let n;if(v.has(t.host)){n=v.get(t.host);const l=Date.now();if(l-h>3e4){h=l;for(const[t,s]of v.entries())s.expires&&s.expires<l&&v.delete(t);if(v.size>1e3){const t=Math.floor(100);Array.from(v.keys()).slice(0,t).forEach(t=>v.delete(t))}}if(!n.expires||n.expires>=l)return s(null,b(n.value,{cached:!0}))}x(4,t.host,t,(l,c)=>{if(l)return n?(v.set(t.host,{value:n.value,expires:Date.now()+(t.dnsTtl||i)}),s(null,b(n.value,{cached:!0,error:l}))):s(l);if(c&&c.length){let n={addresses:c,servername:t.servername||t.host};return v.set(t.host,{value:n,expires:Date.now()+(t.dnsTtl||i)}),s(null,b(n,{cached:!1}))}x(6,t.host,t,(l,c)=>{if(l)return n?(v.set(t.host,{value:n.value,expires:Date.now()+(t.dnsTtl||i)}),s(null,b(n.value,{cached:!0,error:l}))):s(l);if(c&&c.length){let n={addresses:c,servername:t.servername||t.host};return v.set(t.host,{value:n,expires:Date.now()+(t.dnsTtl||i)}),s(null,b(n,{cached:!1}))}try{o.lookup(t.host,{all:!0},(l,o)=>{if(l)return n?(v.set(t.host,{value:n.value,expires:Date.now()+(t.dnsTtl||i)}),s(null,b(n.value,{cached:!0,error:l}))):s(l);let c=!!o&&o.filter(t=>p(t.family)).map(t=>t.address).shift();if(o&&o.length&&!c&&console.warn(`Failed to resolve IPv${o[0].family} addresses with current network`),!c&&n)return s(null,b(n.value,{cached:!0}));let u={addresses:c?[c]:[t.host],servername:t.servername||t.host};return v.set(t.host,{value:u,expires:Date.now()+(t.dnsTtl||i)}),s(null,b(u,{cached:!1}))})}catch(o){return n?(v.set(t.host,{value:n.value,expires:Date.now()+(t.dnsTtl||i)}),s(null,b(n.value,{cached:!0,error:l}))):s(l)}})})},m.exports.parseConnectionUrl=s=>{s=s||'';let n={};return[t.parse(s,!0)].forEach(t=>{let s;switch(t.protocol){case'smtp:':n.secure=!1;break;case'smtps:':n.secure=!0;break;case'direct:':n.direct=!0}!isNaN(t.port)&&Number(t.port)&&(n.port=Number(t.port)),t.hostname&&(n.host=t.hostname),t.auth&&(s=t.auth.split(':'),n.auth||(n.auth={}),n.auth.user=s.shift(),n.auth.pass=s.join(':')),Object.keys(t.query||{}).forEach(s=>{let l=n,o=s,c=t.query[s];switch(isNaN(c)||(c=Number(c)),c){case'true':c=!0;break;case'false':c=!1}if(0===s.indexOf('tls.'))o=s.substr(4),n.tls||(n.tls={}),l=n.tls;else if(s.indexOf('.')>=0)return;o in l||(l[o]=c)})}),n},m.exports._logFunc=(t,s,n,l,o,...c)=>{let u={};Object.keys(n||{}).forEach(t=>{'level'!==t&&(u[t]=n[t])}),Object.keys(l||{}).forEach(t=>{'level'!==t&&(u[t]=l[t])}),t[s](u,o,...c)},m.exports.getLogger=(t,s)=>{let n={},l=['trace','debug','info','warn','error','fatal'];if(!(t=t||{}).logger)return l.forEach(t=>{n[t]=()=>!1}),n;let o=t.logger;return!0===t.logger&&(o=w(l)),l.forEach(t=>{n[t]=(n,l,...c)=>{m.exports._logFunc(o,t,s,n,l,...c)}}),n},m.exports.callbackPromise=(t,s)=>function(){let n=Array.from(arguments),l=n.shift();l?s(l):t(...n)},m.exports.parseDataURI=t=>{if('string'!=typeof t)return null;if(!t.startsWith('data:'))return null;const s=t.indexOf(',');if(-1===s)return null;const n=t.substring(s+1);let l;const o=t.substring(5,s).split(';');if(o.length>0){const t=o[o.length-1].toLowerCase().trim();['base64','utf8','utf-8'].includes(t)&&-1===t.indexOf('=')&&(l=t,o.pop())}const c=o.length>0?o.shift():'application/octet-stream',u={};for(let t=0;t<o.length;t++){const s=o[t],n=s.indexOf('=');if(n>0){const t=s.substring(0,n).trim(),l=s.substring(n+1).trim();t&&(u[t]=l)}}let i;try{if('base64'===l)i=Buffer.from(n,'base64');else try{i=Buffer.from(decodeURIComponent(n))}catch(t){i=Buffer.from(n)}}catch(t){i=Buffer.alloc(0)}return{data:i,encoding:l||null,contentType:c||'application/octet-stream',params:u}},m.exports.resolveContent=(t,s,o)=>{let c;o||(c=new Promise((t,s)=>{o=m.exports.callbackPromise(t,s)}));let u,i=t&&t[s]&&t[s].content||t[s],f=('object'==typeof t[s]&&t[s].encoding||'utf8').toString().toLowerCase().replace(/[-_\s]/g,'');if(!i)return o(null,i);if('object'==typeof i){if('function'==typeof i.pipe)return y(i,(n,l)=>{if(n)return o(n);t[s].content?t[s].content=l:t[s]=l,o(null,l)});if(/^https?:\/\//i.test(i.path||i.href))return u=l(i.path||i.href),y(u,o);if(/^data:/i.test(i.path||i.href)){let t=m.exports.parseDataURI(i.path||i.href);return t&&t.data?o(null,t.data):o(null,Buffer.from(0))}if(i.path)return y(n.createReadStream(i.path),o)}return'string'!=typeof t[s].content||['utf8','usascii','ascii'].includes(f)||(i=Buffer.from(t[s].content,f)),setImmediate(()=>o(null,i)),c},m.exports.assign=function(){let t=Array.from(arguments),s=t.shift()||{};return t.forEach(t=>{Object.keys(t||{}).forEach(n=>{['tls','auth'].includes(n)&&t[n]&&'object'==typeof t[n]?(s[n]||(s[n]={}),Object.keys(t[n]).forEach(l=>{s[n][l]=t[n][l]})):s[n]=t[n]})}),s},m.exports.encodeXText=t=>{if(!/[^\x21-\x2A\x2C-\x3C\x3E-\x7E]/.test(t))return t;let s=Buffer.from(t),n='';for(let t=0,l=s.length;t<l;t++){let l=s[t];n+=l<33||l>126||43===l||61===l?'+'+(l<16?'0':'')+l.toString(16).toUpperCase():String.fromCharCode(l)}return n}},7121,[4900,4790,4907,7122,7125,4898,4909]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]),o=r(d[1]),s=r(d[2]),n=r(d[3]),c=r(d[4]).PassThrough,p=r(d[5]),u=r(d[6]),h=r(d[7]);function f(l,y){(y=y||{}).fetchRes=y.fetchRes||new c,y.cookies=y.cookies||new p,y.redirects=y.redirects||0,y.maxRedirects=isNaN(y.maxRedirects)?5:y.maxRedirects,y.cookie&&([].concat(y.cookie||[]).forEach(t=>{y.cookies.set(t,l)}),y.cookie=!1);let C,T,E,b=y.fetchRes,k=s.parse(l),U=(y.method||'').toString().trim().toUpperCase()||'GET',w=!1,R='https:'===k.protocol?o:t,x={'accept-encoding':'gzip,deflate','user-agent':'nodemailer/'+u.version};if(Object.keys(y.headers||{}).forEach(t=>{x[t.toLowerCase().trim()]=y.headers[t]}),y.userAgent&&(x['user-agent']=y.userAgent),k.auth&&(x.Authorization='Basic '+Buffer.from(k.auth).toString('base64')),(C=y.cookies.get(l))&&(x.cookie=C),y.body){if(!1!==y.contentType&&(x['Content-Type']=y.contentType||'application/x-www-form-urlencoded'),'function'==typeof y.body.pipe)x['Transfer-Encoding']='chunked',T=y.body,T.on('error',t=>{w||(w=!0,t.type='FETCH',t.sourceUrl=l,b.emit('error',t))});else{if(y.body instanceof Buffer)T=y.body;else if('object'==typeof y.body)try{T=Buffer.from(Object.keys(y.body).map(t=>{let o=y.body[t].toString().trim();return encodeURIComponent(t)+'='+encodeURIComponent(o)}).join('&'))}catch(t){if(w)return;return w=!0,t.type='FETCH',t.sourceUrl=l,void b.emit('error',t)}else T=Buffer.from(y.body.toString().trim());x['Content-Type']=y.contentType||'application/x-www-form-urlencoded',x['Content-Length']=T.length}U=(y.method||'').toString().trim().toUpperCase()||'POST'}let F={method:U,host:k.hostname,path:k.path,port:k.port?k.port:'https:'===k.protocol?443:80,headers:x,rejectUnauthorized:!1,agent:!1};y.tls&&Object.keys(y.tls).forEach(t=>{F[t]=y.tls[t]}),'https:'!==k.protocol||!k.hostname||k.hostname===F.host||h.isIP(k.hostname)||F.servername||(F.servername=k.hostname);try{E=R.request(F)}catch(t){return w=!0,setImmediate(()=>{t.type='FETCH',t.sourceUrl=l,b.emit('error',t)}),b}return y.timeout&&E.setTimeout(y.timeout,()=>{if(w)return;w=!0,E.abort();let t=new Error('Request Timeout');t.type='FETCH',t.sourceUrl=l,b.emit('error',t)}),E.on('error',t=>{w||(w=!0,t.type='FETCH',t.sourceUrl=l,b.emit('error',t))}),E.on('response',t=>{let o;if(!w){switch(t.headers['content-encoding']){case'gzip':case'deflate':o=n.createUnzip()}if(t.headers['set-cookie']&&[].concat(t.headers['set-cookie']||[]).forEach(t=>{y.cookies.set(t,l)}),[301,302,303,307,308].includes(t.statusCode)&&t.headers.location){if(y.redirects++,y.redirects>y.maxRedirects){w=!0;let t=new Error('Maximum redirect count exceeded');return t.type='FETCH',t.sourceUrl=l,b.emit('error',t),void E.abort()}return y.method='GET',y.body=!1,f(s.resolve(l,t.headers.location),y)}if(b.statusCode=t.statusCode,b.headers=t.headers,t.statusCode>=300&&!y.allowErrorResponse){w=!0;let o=new Error('Invalid status code '+t.statusCode);return o.type='FETCH',o.sourceUrl=l,b.emit('error',o),void E.abort()}t.on('error',t=>{w||(w=!0,t.type='FETCH',t.sourceUrl=l,b.emit('error',t),E.abort())}),o?(t.pipe(o).pipe(b),o.on('error',t=>{w||(w=!0,t.type='FETCH',t.sourceUrl=l,b.emit('error',t),E.abort())})):t.pipe(b)}}),setImmediate(()=>{if(T)try{if('function'==typeof T.pipe)return T.pipe(E);E.write(T)}catch(t){return w=!0,t.type='FETCH',t.sourceUrl=l,void b.emit('error',t)}E.end()}),b}m.exports=function(t,o){return f(t,o)},m.exports.Cookies=p},7122,[4889,4890,4900,4891,4793,7123,7124,4898]);
__d(function(g,r,_i,_a,m,e,d){'use strict';const t=r(d[0]);m.exports=class{constructor(t){this.options=t||{},this.cookies=[]}set(s,i){let a,o=t.parse(i||''),n=this.parse(s);return n.domain?(a=n.domain.replace(/^\./,''),(o.hostname.length<a.length||('.'+o.hostname).substr(1-a.length)!=='.'+a)&&(n.domain=o.hostname)):n.domain=o.hostname,n.path||(n.path=this.getPath(o.pathname)),n.expires||(n.expires=new Date(Date.now()+1e3*(Number(this.options.sessionTimeout||1800)||1800))),this.add(n)}get(t){return this.list(t).map(t=>t.name+'='+t.value).join('; ')}list(t){let s,i,a=[];for(s=this.cookies.length-1;s>=0;s--)i=this.cookies[s],this.isExpired(i)?this.cookies.splice(s,s):this.match(i,t)&&a.unshift(i);return a}parse(t){let s={};return(t||'').toString().split(';').forEach(t=>{let i,a=t.split('='),o=a.shift().trim().toLowerCase(),n=a.join('=').trim();if(o)switch(o){case'expires':n=new Date(n),'Invalid Date'!==n.toString()&&(s.expires=n);break;case'path':s.path=n;break;case'domain':i=n.toLowerCase(),i.length&&'.'!==i.charAt(0)&&(i='.'+i),s.domain=i;break;case'max-age':s.expires=new Date(Date.now()+1e3*(Number(n)||0));break;case'secure':s.secure=!0;break;case'httponly':s.httponly=!0;break;default:s.name||(s.name=o,s.value=n)}}),s}match(s,i){let a=t.parse(i||'');return(a.hostname===s.domain||'.'===s.domain.charAt(0)&&('.'+a.hostname).substr(-s.domain.length)===s.domain)&&(this.getPath(a.pathname).substr(0,s.path.length)===s.path&&(!s.secure||'https:'===a.protocol))}add(t){let s,i;if(!t||!t.name)return!1;for(s=0,i=this.cookies.length;s<i;s++)if(this.compare(this.cookies[s],t))return this.isExpired(t)?(this.cookies.splice(s,1),!1):(this.cookies[s]=t,!0);return this.isExpired(t)||this.cookies.push(t),!0}compare(t,s){return t.name===s.name&&t.path===s.path&&t.domain===s.domain&&t.secure===s.secure&&t.httponly==t.httponly}isExpired(t){return t.expires&&t.expires<new Date||!t.value}getPath(t){let s=(t||'/').split('/');return s.pop(),s=s.join('/').trim(),'/'!==s.charAt(0)&&(s='/'+s),'/'!==s.substr(-1)&&(s+='/'),s}}},7123,[4900]);
__d(function(e,t,s,i,n,r,o){n.exports={name:"nodemailer",version:"7.0.10",description:"Easy as cake e-mail sending from your Node.js applications",main:"lib/nodemailer.js",scripts:{test:"node --test --test-concurrency=1 test/**/*.test.js test/**/*-test.js","test:coverage":"c8 node --test --test-concurrency=1 test/**/*.test.js test/**/*-test.js",format:"prettier --write \"**/*.{js,json,md}\"","format:check":"prettier --check \"**/*.{js,json,md}\"",lint:"eslint .","lint:fix":"eslint . --fix",update:"rm -rf node_modules/ package-lock.json && ncu -u && npm install"},repository:{type:"git",url:"https://github.com/nodemailer/nodemailer.git"},keywords:["Nodemailer"],author:"Andris Reinman",license:"MIT-0",bugs:{url:"https://github.com/nodemailer/nodemailer/issues"},homepage:"https://nodemailer.com/",devDependencies:{"@aws-sdk/client-sesv2":"3.914.0",bunyan:"1.8.15",c8:"10.1.3",eslint:"9.38.0","eslint-config-prettier":"10.1.8",globals:"16.4.0",libbase64:"1.3.0",libmime:"5.3.7",libqp:"2.1.1","nodemailer-ntlm-auth":"1.0.4",prettier:"3.6.2",proxy:"1.0.2","proxy-test-server":"1.0.0","smtp-server":"3.15.0"},engines:{node:">=6.0.0"}}},7124,[]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:dns')},7125,[]);
__d(function(g,r,i,a,m,e,d){'use strict';const p=r(d[0]),t='application/octet-stream',n=new Map([['application/acad','dwg'],['application/applixware','aw'],['application/arj','arj'],['application/atom+xml','xml'],['application/atomcat+xml','atomcat'],['application/atomsvc+xml','atomsvc'],['application/base64',['mm','mme']],['application/binhex','hqx'],['application/binhex4','hqx'],['application/book',['book','boo']],['application/ccxml+xml,','ccxml'],['application/cdf','cdf'],['application/cdmi-capability','cdmia'],['application/cdmi-container','cdmic'],['application/cdmi-domain','cdmid'],['application/cdmi-object','cdmio'],['application/cdmi-queue','cdmiq'],['application/clariscad','ccad'],['application/commonground','dp'],['application/cu-seeme','cu'],['application/davmount+xml','davmount'],['application/drafting','drw'],['application/dsptype','tsp'],['application/dssc+der','dssc'],['application/dssc+xml','xdssc'],['application/dxf','dxf'],['application/ecmascript',['js','es']],['application/emma+xml','emma'],['application/envoy','evy'],['application/epub+zip','epub'],['application/excel',['xls','xl','xla','xlb','xlc','xld','xlk','xll','xlm','xlt','xlv','xlw']],['application/exi','exi'],['application/font-tdpfr','pfr'],['application/fractals','fif'],['application/freeloader','frl'],['application/futuresplash','spl'],['application/geo+json','geojson'],['application/gnutar','tgz'],['application/groupwise','vew'],['application/hlp','hlp'],['application/hta','hta'],['application/hyperstudio','stk'],['application/i-deas','unv'],['application/iges',['iges','igs']],['application/inf','inf'],['application/internet-property-stream','acx'],['application/ipfix','ipfix'],['application/java','class'],['application/java-archive','jar'],['application/java-byte-code','class'],['application/java-serialized-object','ser'],['application/java-vm','class'],['application/javascript','js'],['application/json','json'],['application/lha','lha'],['application/lzx','lzx'],['application/mac-binary','bin'],['application/mac-binhex','hqx'],['application/mac-binhex40','hqx'],['application/mac-compactpro','cpt'],['application/macbinary','bin'],['application/mads+xml','mads'],['application/marc','mrc'],['application/marcxml+xml','mrcx'],['application/mathematica','ma'],['application/mathml+xml','mathml'],['application/mbedlet','mbd'],['application/mbox','mbox'],['application/mcad','mcd'],['application/mediaservercontrol+xml','mscml'],['application/metalink4+xml','meta4'],['application/mets+xml','mets'],['application/mime','aps'],['application/mods+xml','mods'],['application/mp21','m21'],['application/mp4','mp4'],['application/mspowerpoint',['ppt','pot','pps','ppz']],['application/msword',['doc','dot','w6w','wiz','word']],['application/mswrite','wri'],['application/mxf','mxf'],['application/netmc','mcp'],['application/octet-stream',['*']],['application/oda','oda'],['application/oebps-package+xml','opf'],['application/ogg','ogx'],['application/olescript','axs'],['application/onenote','onetoc'],['application/patch-ops-error+xml','xer'],['application/pdf','pdf'],['application/pgp-encrypted','asc'],['application/pgp-signature','pgp'],['application/pics-rules','prf'],['application/pkcs-12','p12'],['application/pkcs-crl','crl'],['application/pkcs10','p10'],['application/pkcs7-mime',['p7c','p7m']],['application/pkcs7-signature','p7s'],['application/pkcs8','p8'],['application/pkix-attr-cert','ac'],['application/pkix-cert',['cer','crt']],['application/pkix-crl','crl'],['application/pkix-pkipath','pkipath'],['application/pkixcmp','pki'],['application/plain','text'],['application/pls+xml','pls'],['application/postscript',['ps','ai','eps']],['application/powerpoint','ppt'],['application/pro_eng',['part','prt']],['application/prs.cww','cww'],['application/pskc+xml','pskcxml'],['application/rdf+xml','rdf'],['application/reginfo+xml','rif'],['application/relax-ng-compact-syntax','rnc'],['application/resource-lists+xml','rl'],['application/resource-lists-diff+xml','rld'],['application/ringing-tones','rng'],['application/rls-services+xml','rs'],['application/rsd+xml','rsd'],['application/rss+xml','xml'],['application/rtf',['rtf','rtx']],['application/sbml+xml','sbml'],['application/scvp-cv-request','scq'],['application/scvp-cv-response','scs'],['application/scvp-vp-request','spq'],['application/scvp-vp-response','spp'],['application/sdp','sdp'],['application/sea','sea'],['application/set','set'],['application/set-payment-initiation','setpay'],['application/set-registration-initiation','setreg'],['application/shf+xml','shf'],['application/sla','stl'],['application/smil',['smi','smil']],['application/smil+xml','smi'],['application/solids','sol'],['application/sounder','sdr'],['application/sparql-query','rq'],['application/sparql-results+xml','srx'],['application/srgs','gram'],['application/srgs+xml','grxml'],['application/sru+xml','sru'],['application/ssml+xml','ssml'],['application/step',['step','stp']],['application/streamingmedia','ssm'],['application/tei+xml','tei'],['application/thraud+xml','tfi'],['application/timestamped-data','tsd'],['application/toolbook','tbk'],['application/vda','vda'],['application/vnd.3gpp.pic-bw-large','plb'],['application/vnd.3gpp.pic-bw-small','psb'],['application/vnd.3gpp.pic-bw-var','pvb'],['application/vnd.3gpp2.tcap','tcap'],['application/vnd.3m.post-it-notes','pwn'],['application/vnd.accpac.simply.aso','aso'],['application/vnd.accpac.simply.imp','imp'],['application/vnd.acucobol','acu'],['application/vnd.acucorp','atc'],['application/vnd.adobe.air-application-installer-package+zip','air'],['application/vnd.adobe.fxp','fxp'],['application/vnd.adobe.xdp+xml','xdp'],['application/vnd.adobe.xfdf','xfdf'],['application/vnd.ahead.space','ahead'],['application/vnd.airzip.filesecure.azf','azf'],['application/vnd.airzip.filesecure.azs','azs'],['application/vnd.amazon.ebook','azw'],['application/vnd.americandynamics.acc','acc'],['application/vnd.amiga.ami','ami'],['application/vnd.android.package-archive','apk'],['application/vnd.anser-web-certificate-issue-initiation','cii'],['application/vnd.anser-web-funds-transfer-initiation','fti'],['application/vnd.antix.game-component','atx'],['application/vnd.apple.installer+xml','mpkg'],['application/vnd.apple.mpegurl','m3u8'],['application/vnd.aristanetworks.swi','swi'],['application/vnd.audiograph','aep'],['application/vnd.blueice.multipass','mpm'],['application/vnd.bmi','bmi'],['application/vnd.businessobjects','rep'],['application/vnd.chemdraw+xml','cdxml'],['application/vnd.chipnuts.karaoke-mmd','mmd'],['application/vnd.cinderella','cdy'],['application/vnd.claymore','cla'],['application/vnd.cloanto.rp9','rp9'],['application/vnd.clonk.c4group','c4g'],['application/vnd.cluetrust.cartomobile-config','c11amc'],['application/vnd.cluetrust.cartomobile-config-pkg','c11amz'],['application/vnd.commonspace','csp'],['application/vnd.contact.cmsg','cdbcmsg'],['application/vnd.cosmocaller','cmc'],['application/vnd.crick.clicker','clkx'],['application/vnd.crick.clicker.keyboard','clkk'],['application/vnd.crick.clicker.palette','clkp'],['application/vnd.crick.clicker.template','clkt'],['application/vnd.crick.clicker.wordbank','clkw'],['application/vnd.criticaltools.wbs+xml','wbs'],['application/vnd.ctc-posml','pml'],['application/vnd.cups-ppd','ppd'],['application/vnd.curl.car','car'],['application/vnd.curl.pcurl','pcurl'],['application/vnd.data-vision.rdz','rdz'],['application/vnd.denovo.fcselayout-link','fe_launch'],['application/vnd.dna','dna'],['application/vnd.dolby.mlp','mlp'],['application/vnd.dpgraph','dpg'],['application/vnd.dreamfactory','dfac'],['application/vnd.dvb.ait','ait'],['application/vnd.dvb.service','svc'],['application/vnd.dynageo','geo'],['application/vnd.ecowin.chart','mag'],['application/vnd.enliven','nml'],['application/vnd.epson.esf','esf'],['application/vnd.epson.msf','msf'],['application/vnd.epson.quickanime','qam'],['application/vnd.epson.salt','slt'],['application/vnd.epson.ssf','ssf'],['application/vnd.eszigno3+xml','es3'],['application/vnd.ezpix-album','ez2'],['application/vnd.ezpix-package','ez3'],['application/vnd.fdf','fdf'],['application/vnd.fdsn.seed','seed'],['application/vnd.flographit','gph'],['application/vnd.fluxtime.clip','ftc'],['application/vnd.framemaker','fm'],['application/vnd.frogans.fnc','fnc'],['application/vnd.frogans.ltf','ltf'],['application/vnd.fsc.weblaunch','fsc'],['application/vnd.fujitsu.oasys','oas'],['application/vnd.fujitsu.oasys2','oa2'],['application/vnd.fujitsu.oasys3','oa3'],['application/vnd.fujitsu.oasysgp','fg5'],['application/vnd.fujitsu.oasysprs','bh2'],['application/vnd.fujixerox.ddd','ddd'],['application/vnd.fujixerox.docuworks','xdw'],['application/vnd.fujixerox.docuworks.binder','xbd'],['application/vnd.fuzzysheet','fzs'],['application/vnd.genomatix.tuxedo','txd'],['application/vnd.geogebra.file','ggb'],['application/vnd.geogebra.tool','ggt'],['application/vnd.geometry-explorer','gex'],['application/vnd.geonext','gxt'],['application/vnd.geoplan','g2w'],['application/vnd.geospace','g3w'],['application/vnd.gmx','gmx'],['application/vnd.google-earth.kml+xml','kml'],['application/vnd.google-earth.kmz','kmz'],['application/vnd.grafeq','gqf'],['application/vnd.groove-account','gac'],['application/vnd.groove-help','ghf'],['application/vnd.groove-identity-message','gim'],['application/vnd.groove-injector','grv'],['application/vnd.groove-tool-message','gtm'],['application/vnd.groove-tool-template','tpl'],['application/vnd.groove-vcard','vcg'],['application/vnd.hal+xml','hal'],['application/vnd.handheld-entertainment+xml','zmm'],['application/vnd.hbci','hbci'],['application/vnd.hhe.lesson-player','les'],['application/vnd.hp-hpgl',['hgl','hpg','hpgl']],['application/vnd.hp-hpid','hpid'],['application/vnd.hp-hps','hps'],['application/vnd.hp-jlyt','jlt'],['application/vnd.hp-pcl','pcl'],['application/vnd.hp-pclxl','pclxl'],['application/vnd.hydrostatix.sof-data','sfd-hdstx'],['application/vnd.hzn-3d-crossword','x3d'],['application/vnd.ibm.minipay','mpy'],['application/vnd.ibm.modcap','afp'],['application/vnd.ibm.rights-management','irm'],['application/vnd.ibm.secure-container','sc'],['application/vnd.iccprofile','icc'],['application/vnd.igloader','igl'],['application/vnd.immervision-ivp','ivp'],['application/vnd.immervision-ivu','ivu'],['application/vnd.insors.igm','igm'],['application/vnd.intercon.formnet','xpw'],['application/vnd.intergeo','i2g'],['application/vnd.intu.qbo','qbo'],['application/vnd.intu.qfx','qfx'],['application/vnd.ipunplugged.rcprofile','rcprofile'],['application/vnd.irepository.package+xml','irp'],['application/vnd.is-xpr','xpr'],['application/vnd.isac.fcs','fcs'],['application/vnd.jam','jam'],['application/vnd.jcp.javame.midlet-rms','rms'],['application/vnd.jisp','jisp'],['application/vnd.joost.joda-archive','joda'],['application/vnd.kahootz','ktz'],['application/vnd.kde.karbon','karbon'],['application/vnd.kde.kchart','chrt'],['application/vnd.kde.kformula','kfo'],['application/vnd.kde.kivio','flw'],['application/vnd.kde.kontour','kon'],['application/vnd.kde.kpresenter','kpr'],['application/vnd.kde.kspread','ksp'],['application/vnd.kde.kword','kwd'],['application/vnd.kenameaapp','htke'],['application/vnd.kidspiration','kia'],['application/vnd.kinar','kne'],['application/vnd.koan','skp'],['application/vnd.kodak-descriptor','sse'],['application/vnd.las.las+xml','lasxml'],['application/vnd.llamagraphics.life-balance.desktop','lbd'],['application/vnd.llamagraphics.life-balance.exchange+xml','lbe'],['application/vnd.lotus-1-2-3','123'],['application/vnd.lotus-approach','apr'],['application/vnd.lotus-freelance','pre'],['application/vnd.lotus-notes','nsf'],['application/vnd.lotus-organizer','org'],['application/vnd.lotus-screencam','scm'],['application/vnd.lotus-wordpro','lwp'],['application/vnd.macports.portpkg','portpkg'],['application/vnd.mcd','mcd'],['application/vnd.medcalcdata','mc1'],['application/vnd.mediastation.cdkey','cdkey'],['application/vnd.mfer','mwf'],['application/vnd.mfmp','mfm'],['application/vnd.micrografx.flo','flo'],['application/vnd.micrografx.igx','igx'],['application/vnd.mif','mif'],['application/vnd.mobius.daf','daf'],['application/vnd.mobius.dis','dis'],['application/vnd.mobius.mbk','mbk'],['application/vnd.mobius.mqy','mqy'],['application/vnd.mobius.msl','msl'],['application/vnd.mobius.plc','plc'],['application/vnd.mobius.txf','txf'],['application/vnd.mophun.application','mpn'],['application/vnd.mophun.certificate','mpc'],['application/vnd.mozilla.xul+xml','xul'],['application/vnd.ms-artgalry','cil'],['application/vnd.ms-cab-compressed','cab'],['application/vnd.ms-excel',['xls','xla','xlc','xlm','xlt','xlw','xlb','xll']],['application/vnd.ms-excel.addin.macroenabled.12','xlam'],['application/vnd.ms-excel.sheet.binary.macroenabled.12','xlsb'],['application/vnd.ms-excel.sheet.macroenabled.12','xlsm'],['application/vnd.ms-excel.template.macroenabled.12','xltm'],['application/vnd.ms-fontobject','eot'],['application/vnd.ms-htmlhelp','chm'],['application/vnd.ms-ims','ims'],['application/vnd.ms-lrm','lrm'],['application/vnd.ms-officetheme','thmx'],['application/vnd.ms-outlook','msg'],['application/vnd.ms-pki.certstore','sst'],['application/vnd.ms-pki.pko','pko'],['application/vnd.ms-pki.seccat','cat'],['application/vnd.ms-pki.stl','stl'],['application/vnd.ms-pkicertstore','sst'],['application/vnd.ms-pkiseccat','cat'],['application/vnd.ms-pkistl','stl'],['application/vnd.ms-powerpoint',['ppt','pot','pps','ppa','pwz']],['application/vnd.ms-powerpoint.addin.macroenabled.12','ppam'],['application/vnd.ms-powerpoint.presentation.macroenabled.12','pptm'],['application/vnd.ms-powerpoint.slide.macroenabled.12','sldm'],['application/vnd.ms-powerpoint.slideshow.macroenabled.12','ppsm'],['application/vnd.ms-powerpoint.template.macroenabled.12','potm'],['application/vnd.ms-project','mpp'],['application/vnd.ms-word.document.macroenabled.12','docm'],['application/vnd.ms-word.template.macroenabled.12','dotm'],['application/vnd.ms-works',['wks','wcm','wdb','wps']],['application/vnd.ms-wpl','wpl'],['application/vnd.ms-xpsdocument','xps'],['application/vnd.mseq','mseq'],['application/vnd.musician','mus'],['application/vnd.muvee.style','msty'],['application/vnd.neurolanguage.nlu','nlu'],['application/vnd.noblenet-directory','nnd'],['application/vnd.noblenet-sealer','nns'],['application/vnd.noblenet-web','nnw'],['application/vnd.nokia.configuration-message','ncm'],['application/vnd.nokia.n-gage.data','ngdat'],['application/vnd.nokia.n-gage.symbian.install','n-gage'],['application/vnd.nokia.radio-preset','rpst'],['application/vnd.nokia.radio-presets','rpss'],['application/vnd.nokia.ringing-tone','rng'],['application/vnd.novadigm.edm','edm'],['application/vnd.novadigm.edx','edx'],['application/vnd.novadigm.ext','ext'],['application/vnd.oasis.opendocument.chart','odc'],['application/vnd.oasis.opendocument.chart-template','otc'],['application/vnd.oasis.opendocument.database','odb'],['application/vnd.oasis.opendocument.formula','odf'],['application/vnd.oasis.opendocument.formula-template','odft'],['application/vnd.oasis.opendocument.graphics','odg'],['application/vnd.oasis.opendocument.graphics-template','otg'],['application/vnd.oasis.opendocument.image','odi'],['application/vnd.oasis.opendocument.image-template','oti'],['application/vnd.oasis.opendocument.presentation','odp'],['application/vnd.oasis.opendocument.presentation-template','otp'],['application/vnd.oasis.opendocument.spreadsheet','ods'],['application/vnd.oasis.opendocument.spreadsheet-template','ots'],['application/vnd.oasis.opendocument.text','odt'],['application/vnd.oasis.opendocument.text-master','odm'],['application/vnd.oasis.opendocument.text-template','ott'],['application/vnd.oasis.opendocument.text-web','oth'],['application/vnd.olpc-sugar','xo'],['application/vnd.oma.dd2+xml','dd2'],['application/vnd.openofficeorg.extension','oxt'],['application/vnd.openxmlformats-officedocument.presentationml.presentation','pptx'],['application/vnd.openxmlformats-officedocument.presentationml.slide','sldx'],['application/vnd.openxmlformats-officedocument.presentationml.slideshow','ppsx'],['application/vnd.openxmlformats-officedocument.presentationml.template','potx'],['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','xlsx'],['application/vnd.openxmlformats-officedocument.spreadsheetml.template','xltx'],['application/vnd.openxmlformats-officedocument.wordprocessingml.document','docx'],['application/vnd.openxmlformats-officedocument.wordprocessingml.template','dotx'],['application/vnd.osgeo.mapguide.package','mgp'],['application/vnd.osgi.dp','dp'],['application/vnd.palm','pdb'],['application/vnd.pawaafile','paw'],['application/vnd.pg.format','str'],['application/vnd.pg.osasli','ei6'],['application/vnd.picsel','efif'],['application/vnd.pmi.widget','wg'],['application/vnd.pocketlearn','plf'],['application/vnd.powerbuilder6','pbd'],['application/vnd.previewsystems.box','box'],['application/vnd.proteus.magazine','mgz'],['application/vnd.publishare-delta-tree','qps'],['application/vnd.pvi.ptid1','ptid'],['application/vnd.quark.quarkxpress','qxd'],['application/vnd.realvnc.bed','bed'],['application/vnd.recordare.musicxml','mxl'],['application/vnd.recordare.musicxml+xml','musicxml'],['application/vnd.rig.cryptonote','cryptonote'],['application/vnd.rim.cod','cod'],['application/vnd.rn-realmedia','rm'],['application/vnd.rn-realplayer','rnx'],['application/vnd.route66.link66+xml','link66'],['application/vnd.sailingtracker.track','st'],['application/vnd.seemail','see'],['application/vnd.sema','sema'],['application/vnd.semd','semd'],['application/vnd.semf','semf'],['application/vnd.shana.informed.formdata','ifm'],['application/vnd.shana.informed.formtemplate','itp'],['application/vnd.shana.informed.interchange','iif'],['application/vnd.shana.informed.package','ipk'],['application/vnd.simtech-mindmapper','twd'],['application/vnd.smaf','mmf'],['application/vnd.smart.teacher','teacher'],['application/vnd.solent.sdkm+xml','sdkm'],['application/vnd.spotfire.dxp','dxp'],['application/vnd.spotfire.sfs','sfs'],['application/vnd.stardivision.calc','sdc'],['application/vnd.stardivision.draw','sda'],['application/vnd.stardivision.impress','sdd'],['application/vnd.stardivision.math','smf'],['application/vnd.stardivision.writer','sdw'],['application/vnd.stardivision.writer-global','sgl'],['application/vnd.stepmania.stepchart','sm'],['application/vnd.sun.xml.calc','sxc'],['application/vnd.sun.xml.calc.template','stc'],['application/vnd.sun.xml.draw','sxd'],['application/vnd.sun.xml.draw.template','std'],['application/vnd.sun.xml.impress','sxi'],['application/vnd.sun.xml.impress.template','sti'],['application/vnd.sun.xml.math','sxm'],['application/vnd.sun.xml.writer','sxw'],['application/vnd.sun.xml.writer.global','sxg'],['application/vnd.sun.xml.writer.template','stw'],['application/vnd.sus-calendar','sus'],['application/vnd.svd','svd'],['application/vnd.symbian.install','sis'],['application/vnd.syncml+xml','xsm'],['application/vnd.syncml.dm+wbxml','bdm'],['application/vnd.syncml.dm+xml','xdm'],['application/vnd.tao.intent-module-archive','tao'],['application/vnd.tmobile-livetv','tmo'],['application/vnd.trid.tpt','tpt'],['application/vnd.triscape.mxs','mxs'],['application/vnd.trueapp','tra'],['application/vnd.ufdl','ufd'],['application/vnd.uiq.theme','utz'],['application/vnd.umajin','umj'],['application/vnd.unity','unityweb'],['application/vnd.uoml+xml','uoml'],['application/vnd.vcx','vcx'],['application/vnd.visio','vsd'],['application/vnd.visionary','vis'],['application/vnd.vsf','vsf'],['application/vnd.wap.wbxml','wbxml'],['application/vnd.wap.wmlc','wmlc'],['application/vnd.wap.wmlscriptc','wmlsc'],['application/vnd.webturbo','wtb'],['application/vnd.wolfram.player','nbp'],['application/vnd.wordperfect','wpd'],['application/vnd.wqd','wqd'],['application/vnd.wt.stf','stf'],['application/vnd.xara',['web','xar']],['application/vnd.xfdl','xfdl'],['application/vnd.yamaha.hv-dic','hvd'],['application/vnd.yamaha.hv-script','hvs'],['application/vnd.yamaha.hv-voice','hvp'],['application/vnd.yamaha.openscoreformat','osf'],['application/vnd.yamaha.openscoreformat.osfpvg+xml','osfpvg'],['application/vnd.yamaha.smaf-audio','saf'],['application/vnd.yamaha.smaf-phrase','spf'],['application/vnd.yellowriver-custom-menu','cmp'],['application/vnd.zul','zir'],['application/vnd.zzazz.deck+xml','zaz'],['application/vocaltec-media-desc','vmd'],['application/vocaltec-media-file','vmf'],['application/voicexml+xml','vxml'],['application/widget','wgt'],['application/winhlp','hlp'],['application/wordperfect',['wp','wp5','wp6','wpd']],['application/wordperfect6.0',['w60','wp5']],['application/wordperfect6.1','w61'],['application/wsdl+xml','wsdl'],['application/wspolicy+xml','wspolicy'],['application/x-123','wk1'],['application/x-7z-compressed','7z'],['application/x-abiword','abw'],['application/x-ace-compressed','ace'],['application/x-aim','aim'],['application/x-authorware-bin','aab'],['application/x-authorware-map','aam'],['application/x-authorware-seg','aas'],['application/x-bcpio','bcpio'],['application/x-binary','bin'],['application/x-binhex40','hqx'],['application/x-bittorrent','torrent'],['application/x-bsh',['bsh','sh','shar']],['application/x-bytecode.elisp','elc'],['application/x-bytecode.python','pyc'],['application/x-bzip','bz'],['application/x-bzip2',['boz','bz2']],['application/x-cdf','cdf'],['application/x-cdlink','vcd'],['application/x-chat',['cha','chat']],['application/x-chess-pgn','pgn'],['application/x-cmu-raster','ras'],['application/x-cocoa','cco'],['application/x-compactpro','cpt'],['application/x-compress','z'],['application/x-compressed',['tgz','gz','z','zip']],['application/x-conference','nsc'],['application/x-cpio','cpio'],['application/x-cpt','cpt'],['application/x-csh','csh'],['application/x-debian-package','deb'],['application/x-deepv','deepv'],['application/x-director',['dir','dcr','dxr']],['application/x-doom','wad'],['application/x-dtbncx+xml','ncx'],['application/x-dtbook+xml','dtb'],['application/x-dtbresource+xml','res'],['application/x-dvi','dvi'],['application/x-elc','elc'],['application/x-envoy',['env','evy']],['application/x-esrehber','es'],['application/x-excel',['xls','xla','xlb','xlc','xld','xlk','xll','xlm','xlt','xlv','xlw']],['application/x-font-bdf','bdf'],['application/x-font-ghostscript','gsf'],['application/x-font-linux-psf','psf'],['application/x-font-otf','otf'],['application/x-font-pcf','pcf'],['application/x-font-snf','snf'],['application/x-font-ttf','ttf'],['application/x-font-type1','pfa'],['application/x-font-woff','woff'],['application/x-frame','mif'],['application/x-freelance','pre'],['application/x-futuresplash','spl'],['application/x-gnumeric','gnumeric'],['application/x-gsp','gsp'],['application/x-gss','gss'],['application/x-gtar','gtar'],['application/x-gzip',['gz','gzip']],['application/x-hdf','hdf'],['application/x-helpfile',['help','hlp']],['application/x-httpd-imap','imap'],['application/x-ima','ima'],['application/x-internet-signup',['ins','isp']],['application/x-internett-signup','ins'],['application/x-inventor','iv'],['application/x-ip2','ip'],['application/x-iphone','iii'],['application/x-java-class','class'],['application/x-java-commerce','jcm'],['application/x-java-jnlp-file','jnlp'],['application/x-javascript','js'],['application/x-koan',['skd','skm','skp','skt']],['application/x-ksh','ksh'],['application/x-latex',['latex','ltx']],['application/x-lha','lha'],['application/x-lisp','lsp'],['application/x-livescreen','ivy'],['application/x-lotus','wq1'],['application/x-lotusscreencam','scm'],['application/x-lzh','lzh'],['application/x-lzx','lzx'],['application/x-mac-binhex40','hqx'],['application/x-macbinary','bin'],['application/x-magic-cap-package-1.0','mc$'],['application/x-mathcad','mcd'],['application/x-meme','mm'],['application/x-midi',['mid','midi']],['application/x-mif','mif'],['application/x-mix-transfer','nix'],['application/x-mobipocket-ebook','prc'],['application/x-mplayer2','asx'],['application/x-ms-application','application'],['application/x-ms-wmd','wmd'],['application/x-ms-wmz','wmz'],['application/x-ms-xbap','xbap'],['application/x-msaccess','mdb'],['application/x-msbinder','obd'],['application/x-mscardfile','crd'],['application/x-msclip','clp'],['application/x-msdownload',['exe','dll']],['application/x-msexcel',['xls','xla','xlw']],['application/x-msmediaview',['mvb','m13','m14']],['application/x-msmetafile','wmf'],['application/x-msmoney','mny'],['application/x-mspowerpoint','ppt'],['application/x-mspublisher','pub'],['application/x-msschedule','scd'],['application/x-msterminal','trm'],['application/x-mswrite','wri'],['application/x-navi-animation','ani'],['application/x-navidoc','nvd'],['application/x-navimap','map'],['application/x-navistyle','stl'],['application/x-netcdf',['cdf','nc']],['application/x-newton-compatible-pkg','pkg'],['application/x-nokia-9000-communicator-add-on-software','aos'],['application/x-omc','omc'],['application/x-omcdatamaker','omcd'],['application/x-omcregerator','omcr'],['application/x-pagemaker',['pm4','pm5']],['application/x-pcl','pcl'],['application/x-perfmon',['pma','pmc','pml','pmr','pmw']],['application/x-pixclscript','plx'],['application/x-pkcs10','p10'],['application/x-pkcs12',['p12','pfx']],['application/x-pkcs7-certificates',['p7b','spc']],['application/x-pkcs7-certreqresp','p7r'],['application/x-pkcs7-mime',['p7m','p7c']],['application/x-pkcs7-signature',['p7s','p7a']],['application/x-pointplus','css'],['application/x-portable-anymap','pnm'],['application/x-project',['mpc','mpt','mpv','mpx']],['application/x-qpro','wb1'],['application/x-rar-compressed','rar'],['application/x-rtf','rtf'],['application/x-sdp','sdp'],['application/x-sea','sea'],['application/x-seelogo','sl'],['application/x-sh','sh'],['application/x-shar',['shar','sh']],['application/x-shockwave-flash','swf'],['application/x-silverlight-app','xap'],['application/x-sit','sit'],['application/x-sprite',['spr','sprite']],['application/x-stuffit','sit'],['application/x-stuffitx','sitx'],['application/x-sv4cpio','sv4cpio'],['application/x-sv4crc','sv4crc'],['application/x-tar','tar'],['application/x-tbook',['sbk','tbk']],['application/x-tcl','tcl'],['application/x-tex','tex'],['application/x-tex-tfm','tfm'],['application/x-texinfo',['texi','texinfo']],['application/x-troff',['roff','t','tr']],['application/x-troff-man','man'],['application/x-troff-me','me'],['application/x-troff-ms','ms'],['application/x-troff-msvideo','avi'],['application/x-ustar','ustar'],['application/x-visio',['vsd','vst','vsw']],['application/x-vnd.audioexplosion.mzz','mzz'],['application/x-vnd.ls-xpix','xpix'],['application/x-vrml','vrml'],['application/x-wais-source',['src','wsrc']],['application/x-winhelp','hlp'],['application/x-wintalk','wtk'],['application/x-world',['wrl','svr']],['application/x-wpwin','wpd'],['application/x-wri','wri'],['application/x-x509-ca-cert',['cer','crt','der']],['application/x-x509-user-cert','crt'],['application/x-xfig','fig'],['application/x-xpinstall','xpi'],['application/x-zip-compressed','zip'],['application/xcap-diff+xml','xdf'],['application/xenc+xml','xenc'],['application/xhtml+xml','xhtml'],['application/xml','xml'],['application/xml-dtd','dtd'],['application/xop+xml','xop'],['application/xslt+xml','xslt'],['application/xspf+xml','xspf'],['application/xv+xml','mxml'],['application/yang','yang'],['application/yin+xml','yin'],['application/ynd.ms-pkipko','pko'],['application/zip','zip'],['audio/adpcm','adp'],['audio/aiff',['aiff','aif','aifc']],['audio/basic',['snd','au']],['audio/it','it'],['audio/make',['funk','my','pfunk']],['audio/make.my.funk','pfunk'],['audio/mid',['mid','rmi']],['audio/midi',['midi','kar','mid']],['audio/mod','mod'],['audio/mp4','mp4a'],['audio/mpeg',['mpga','mp3','m2a','mp2','mpa','mpg']],['audio/mpeg3','mp3'],['audio/nspaudio',['la','lma']],['audio/ogg','oga'],['audio/s3m','s3m'],['audio/tsp-audio','tsi'],['audio/tsplayer','tsp'],['audio/vnd.dece.audio','uva'],['audio/vnd.digital-winds','eol'],['audio/vnd.dra','dra'],['audio/vnd.dts','dts'],['audio/vnd.dts.hd','dtshd'],['audio/vnd.lucent.voice','lvp'],['audio/vnd.ms-playready.media.pya','pya'],['audio/vnd.nuera.ecelp4800','ecelp4800'],['audio/vnd.nuera.ecelp7470','ecelp7470'],['audio/vnd.nuera.ecelp9600','ecelp9600'],['audio/vnd.qcelp','qcp'],['audio/vnd.rip','rip'],['audio/voc','voc'],['audio/voxware','vox'],['audio/wav','wav'],['audio/webm','weba'],['audio/x-aac','aac'],['audio/x-adpcm','snd'],['audio/x-aiff',['aiff','aif','aifc']],['audio/x-au','au'],['audio/x-gsm',['gsd','gsm']],['audio/x-jam','jam'],['audio/x-liveaudio','lam'],['audio/x-mid',['mid','midi']],['audio/x-midi',['midi','mid']],['audio/x-mod','mod'],['audio/x-mpeg','mp2'],['audio/x-mpeg-3','mp3'],['audio/x-mpegurl','m3u'],['audio/x-mpequrl','m3u'],['audio/x-ms-wax','wax'],['audio/x-ms-wma','wma'],['audio/x-nspaudio',['la','lma']],['audio/x-pn-realaudio',['ra','ram','rm','rmm','rmp']],['audio/x-pn-realaudio-plugin',['ra','rmp','rpm']],['audio/x-psid','sid'],['audio/x-realaudio','ra'],['audio/x-twinvq','vqf'],['audio/x-twinvq-plugin',['vqe','vql']],['audio/x-vnd.audioexplosion.mjuicemediafile','mjf'],['audio/x-voc','voc'],['audio/x-wav','wav'],['audio/xm','xm'],['chemical/x-cdx','cdx'],['chemical/x-cif','cif'],['chemical/x-cmdf','cmdf'],['chemical/x-cml','cml'],['chemical/x-csml','csml'],['chemical/x-pdb',['pdb','xyz']],['chemical/x-xyz','xyz'],['drawing/x-dwf','dwf'],['i-world/i-vrml','ivr'],['image/bmp',['bmp','bm']],['image/cgm','cgm'],['image/cis-cod','cod'],['image/cmu-raster',['ras','rast']],['image/fif','fif'],['image/florian',['flo','turbot']],['image/g3fax','g3'],['image/gif','gif'],['image/ief',['ief','iefs']],['image/jpeg',['jpeg','jpe','jpg','jfif','jfif-tbnl']],['image/jutvision','jut'],['image/ktx','ktx'],['image/naplps',['nap','naplps']],['image/pict',['pic','pict']],['image/pipeg','jfif'],['image/pjpeg',['jfif','jpe','jpeg','jpg']],['image/png',['png','x-png']],['image/prs.btif','btif'],['image/svg+xml','svg'],['image/tiff',['tif','tiff']],['image/vasa','mcf'],['image/vnd.adobe.photoshop','psd'],['image/vnd.dece.graphic','uvi'],['image/vnd.djvu','djvu'],['image/vnd.dvb.subtitle','sub'],['image/vnd.dwg',['dwg','dxf','svf']],['image/vnd.dxf','dxf'],['image/vnd.fastbidsheet','fbs'],['image/vnd.fpx','fpx'],['image/vnd.fst','fst'],['image/vnd.fujixerox.edmics-mmr','mmr'],['image/vnd.fujixerox.edmics-rlc','rlc'],['image/vnd.ms-modi','mdi'],['image/vnd.net-fpx',['fpx','npx']],['image/vnd.rn-realflash','rf'],['image/vnd.rn-realpix','rp'],['image/vnd.wap.wbmp','wbmp'],['image/vnd.xiff','xif'],['image/webp','webp'],['image/x-cmu-raster','ras'],['image/x-cmx','cmx'],['image/x-dwg',['dwg','dxf','svf']],['image/x-freehand','fh'],['image/x-icon','ico'],['image/x-jg','art'],['image/x-jps','jps'],['image/x-niff',['niff','nif']],['image/x-pcx','pcx'],['image/x-pict',['pct','pic']],['image/x-portable-anymap','pnm'],['image/x-portable-bitmap','pbm'],['image/x-portable-graymap','pgm'],['image/x-portable-greymap','pgm'],['image/x-portable-pixmap','ppm'],['image/x-quicktime',['qif','qti','qtif']],['image/x-rgb','rgb'],['image/x-tiff',['tif','tiff']],['image/x-windows-bmp','bmp'],['image/x-xbitmap','xbm'],['image/x-xbm','xbm'],['image/x-xpixmap',['xpm','pm']],['image/x-xwd','xwd'],['image/x-xwindowdump','xwd'],['image/xbm','xbm'],['image/xpm','xpm'],['message/rfc822',['eml','mht','mhtml','nws','mime']],['model/iges',['iges','igs']],['model/mesh','msh'],['model/vnd.collada+xml','dae'],['model/vnd.dwf','dwf'],['model/vnd.gdl','gdl'],['model/vnd.gtw','gtw'],['model/vnd.mts','mts'],['model/vnd.vtu','vtu'],['model/vrml',['vrml','wrl','wrz']],['model/x-pov','pov'],['multipart/x-gzip','gzip'],['multipart/x-ustar','ustar'],['multipart/x-zip','zip'],['music/crescendo',['mid','midi']],['music/x-karaoke','kar'],['paleovu/x-pv','pvu'],['text/asp','asp'],['text/calendar','ics'],['text/css','css'],['text/csv','csv'],['text/ecmascript','js'],['text/h323','323'],['text/html',['html','htm','stm','acgi','htmls','htx','shtml']],['text/iuls','uls'],['text/javascript','js'],['text/mcf','mcf'],['text/n3','n3'],['text/pascal','pas'],['text/plain',['txt','bas','c','h','c++','cc','com','conf','cxx','def','f','f90','for','g','hh','idc','jav','java','list','log','lst','m','mar','pl','sdml','text']],['text/plain-bas','par'],['text/prs.lines.tag','dsc'],['text/richtext',['rtx','rt','rtf']],['text/scriplet','wsc'],['text/scriptlet','sct'],['text/sgml',['sgm','sgml']],['text/tab-separated-values','tsv'],['text/troff','t'],['text/turtle','ttl'],['text/uri-list',['uni','unis','uri','uris']],['text/vnd.abc','abc'],['text/vnd.curl','curl'],['text/vnd.curl.dcurl','dcurl'],['text/vnd.curl.mcurl','mcurl'],['text/vnd.curl.scurl','scurl'],['text/vnd.fly','fly'],['text/vnd.fmi.flexstor','flx'],['text/vnd.graphviz','gv'],['text/vnd.in3d.3dml','3dml'],['text/vnd.in3d.spot','spot'],['text/vnd.rn-realtext','rt'],['text/vnd.sun.j2me.app-descriptor','jad'],['text/vnd.wap.wml','wml'],['text/vnd.wap.wmlscript','wmls'],['text/webviewhtml','htt'],['text/x-asm',['asm','s']],['text/x-audiosoft-intra','aip'],['text/x-c',['c','cc','cpp']],['text/x-component','htc'],['text/x-fortran',['for','f','f77','f90']],['text/x-h',['h','hh']],['text/x-java-source',['java','jav']],['text/x-java-source,java','java'],['text/x-la-asf','lsx'],['text/x-m','m'],['text/x-pascal','p'],['text/x-script','hlb'],['text/x-script.csh','csh'],['text/x-script.elisp','el'],['text/x-script.guile','scm'],['text/x-script.ksh','ksh'],['text/x-script.lisp','lsp'],['text/x-script.perl','pl'],['text/x-script.perl-module','pm'],['text/x-script.phyton','py'],['text/x-script.rexx','rexx'],['text/x-script.scheme','scm'],['text/x-script.sh','sh'],['text/x-script.tcl','tcl'],['text/x-script.tcsh','tcsh'],['text/x-script.zsh','zsh'],['text/x-server-parsed-html',['shtml','ssi']],['text/x-setext','etx'],['text/x-sgml',['sgm','sgml']],['text/x-speech',['spc','talk']],['text/x-uil','uil'],['text/x-uuencode',['uu','uue']],['text/x-vcalendar','vcs'],['text/x-vcard','vcf'],['text/xml','xml'],['video/3gpp','3gp'],['video/3gpp2','3g2'],['video/animaflex','afl'],['video/avi','avi'],['video/avs-video','avs'],['video/dl','dl'],['video/fli','fli'],['video/gl','gl'],['video/h261','h261'],['video/h263','h263'],['video/h264','h264'],['video/jpeg','jpgv'],['video/jpm','jpm'],['video/mj2','mj2'],['video/mp4','mp4'],['video/mpeg',['mpeg','mp2','mpa','mpe','mpg','mpv2','m1v','m2v','mp3']],['video/msvideo','avi'],['video/ogg','ogv'],['video/quicktime',['mov','qt','moov']],['video/vdo','vdo'],['video/vivo',['viv','vivo']],['video/vnd.dece.hd','uvh'],['video/vnd.dece.mobile','uvm'],['video/vnd.dece.pd','uvp'],['video/vnd.dece.sd','uvs'],['video/vnd.dece.video','uvv'],['video/vnd.fvt','fvt'],['video/vnd.mpegurl','mxu'],['video/vnd.ms-playready.media.pyv','pyv'],['video/vnd.rn-realvideo','rv'],['video/vnd.uvvu.mp4','uvu'],['video/vnd.vivo',['viv','vivo']],['video/vosaic','vos'],['video/webm','webm'],['video/x-amt-demorun','xdr'],['video/x-amt-showrun','xsr'],['video/x-atomic3d-feature','fmf'],['video/x-dl','dl'],['video/x-dv',['dif','dv']],['video/x-f4v','f4v'],['video/x-fli','fli'],['video/x-flv','flv'],['video/x-gl','gl'],['video/x-isvideo','isu'],['video/x-la-asf',['lsf','lsx']],['video/x-m4v','m4v'],['video/x-motion-jpeg','mjpg'],['video/x-mpeg',['mp3','mp2']],['video/x-mpeq2a','mp2'],['video/x-ms-asf',['asf','asr','asx']],['video/x-ms-asf-plugin','asx'],['video/x-ms-wm','wm'],['video/x-ms-wmv','wmv'],['video/x-ms-wmx','wmx'],['video/x-ms-wvx','wvx'],['video/x-msvideo','avi'],['video/x-qtc','qtc'],['video/x-scm','scm'],['video/x-sgi-movie',['movie','mv']],['windows/metafile','wmf'],['www/mime','mime'],['x-conference/x-cooltalk','ice'],['x-music/x-midi',['mid','midi']],['x-world/x-3dmf',['3dm','3dmf','qd3','qd3d']],['x-world/x-svr','svr'],['x-world/x-vrml',['flr','vrml','wrl','wrz','xaf','xof']],['x-world/x-vrt','vrt'],['xgl/drawing','xgz'],['xgl/movie','xmz']]),o=new Map([['123','application/vnd.lotus-1-2-3'],['323','text/h323'],['*','application/octet-stream'],['3dm','x-world/x-3dmf'],['3dmf','x-world/x-3dmf'],['3dml','text/vnd.in3d.3dml'],['3g2','video/3gpp2'],['3gp','video/3gpp'],['7z','application/x-7z-compressed'],['a','application/octet-stream'],['aab','application/x-authorware-bin'],['aac','audio/x-aac'],['aam','application/x-authorware-map'],['aas','application/x-authorware-seg'],['abc','text/vnd.abc'],['abw','application/x-abiword'],['ac','application/pkix-attr-cert'],['acc','application/vnd.americandynamics.acc'],['ace','application/x-ace-compressed'],['acgi','text/html'],['acu','application/vnd.acucobol'],['acx','application/internet-property-stream'],['adp','audio/adpcm'],['aep','application/vnd.audiograph'],['afl','video/animaflex'],['afp','application/vnd.ibm.modcap'],['ahead','application/vnd.ahead.space'],['ai','application/postscript'],['aif',['audio/aiff','audio/x-aiff']],['aifc',['audio/aiff','audio/x-aiff']],['aiff',['audio/aiff','audio/x-aiff']],['aim','application/x-aim'],['aip','text/x-audiosoft-intra'],['air','application/vnd.adobe.air-application-installer-package+zip'],['ait','application/vnd.dvb.ait'],['ami','application/vnd.amiga.ami'],['ani','application/x-navi-animation'],['aos','application/x-nokia-9000-communicator-add-on-software'],['apk','application/vnd.android.package-archive'],['application','application/x-ms-application'],['apr','application/vnd.lotus-approach'],['aps','application/mime'],['arc','application/octet-stream'],['arj',['application/arj','application/octet-stream']],['art','image/x-jg'],['asf','video/x-ms-asf'],['asm','text/x-asm'],['aso','application/vnd.accpac.simply.aso'],['asp','text/asp'],['asr','video/x-ms-asf'],['asx',['video/x-ms-asf','application/x-mplayer2','video/x-ms-asf-plugin']],['atc','application/vnd.acucorp'],['atomcat','application/atomcat+xml'],['atomsvc','application/atomsvc+xml'],['atx','application/vnd.antix.game-component'],['au',['audio/basic','audio/x-au']],['avi',['video/avi','video/msvideo','application/x-troff-msvideo','video/x-msvideo']],['avs','video/avs-video'],['aw','application/applixware'],['axs','application/olescript'],['azf','application/vnd.airzip.filesecure.azf'],['azs','application/vnd.airzip.filesecure.azs'],['azw','application/vnd.amazon.ebook'],['bas','text/plain'],['bcpio','application/x-bcpio'],['bdf','application/x-font-bdf'],['bdm','application/vnd.syncml.dm+wbxml'],['bed','application/vnd.realvnc.bed'],['bh2','application/vnd.fujitsu.oasysprs'],['bin',['application/octet-stream','application/mac-binary','application/macbinary','application/x-macbinary','application/x-binary']],['bm','image/bmp'],['bmi','application/vnd.bmi'],['bmp',['image/bmp','image/x-windows-bmp']],['boo','application/book'],['book','application/book'],['box','application/vnd.previewsystems.box'],['boz','application/x-bzip2'],['bsh','application/x-bsh'],['btif','image/prs.btif'],['bz','application/x-bzip'],['bz2','application/x-bzip2'],['c',['text/plain','text/x-c']],['c++','text/plain'],['c11amc','application/vnd.cluetrust.cartomobile-config'],['c11amz','application/vnd.cluetrust.cartomobile-config-pkg'],['c4g','application/vnd.clonk.c4group'],['cab','application/vnd.ms-cab-compressed'],['car','application/vnd.curl.car'],['cat',['application/vnd.ms-pkiseccat','application/vnd.ms-pki.seccat']],['cc',['text/plain','text/x-c']],['ccad','application/clariscad'],['cco','application/x-cocoa'],['ccxml','application/ccxml+xml,'],['cdbcmsg','application/vnd.contact.cmsg'],['cdf',['application/cdf','application/x-cdf','application/x-netcdf']],['cdkey','application/vnd.mediastation.cdkey'],['cdmia','application/cdmi-capability'],['cdmic','application/cdmi-container'],['cdmid','application/cdmi-domain'],['cdmio','application/cdmi-object'],['cdmiq','application/cdmi-queue'],['cdx','chemical/x-cdx'],['cdxml','application/vnd.chemdraw+xml'],['cdy','application/vnd.cinderella'],['cer',['application/pkix-cert','application/x-x509-ca-cert']],['cgm','image/cgm'],['cha','application/x-chat'],['chat','application/x-chat'],['chm','application/vnd.ms-htmlhelp'],['chrt','application/vnd.kde.kchart'],['cif','chemical/x-cif'],['cii','application/vnd.anser-web-certificate-issue-initiation'],['cil','application/vnd.ms-artgalry'],['cla','application/vnd.claymore'],['class',['application/octet-stream','application/java','application/java-byte-code','application/java-vm','application/x-java-class']],['clkk','application/vnd.crick.clicker.keyboard'],['clkp','application/vnd.crick.clicker.palette'],['clkt','application/vnd.crick.clicker.template'],['clkw','application/vnd.crick.clicker.wordbank'],['clkx','application/vnd.crick.clicker'],['clp','application/x-msclip'],['cmc','application/vnd.cosmocaller'],['cmdf','chemical/x-cmdf'],['cml','chemical/x-cml'],['cmp','application/vnd.yellowriver-custom-menu'],['cmx','image/x-cmx'],['cod',['image/cis-cod','application/vnd.rim.cod']],['com',['application/octet-stream','text/plain']],['conf','text/plain'],['cpio','application/x-cpio'],['cpp','text/x-c'],['cpt',['application/mac-compactpro','application/x-compactpro','application/x-cpt']],['crd','application/x-mscardfile'],['crl',['application/pkix-crl','application/pkcs-crl']],['crt',['application/pkix-cert','application/x-x509-user-cert','application/x-x509-ca-cert']],['cryptonote','application/vnd.rig.cryptonote'],['csh',['text/x-script.csh','application/x-csh']],['csml','chemical/x-csml'],['csp','application/vnd.commonspace'],['css',['text/css','application/x-pointplus']],['csv','text/csv'],['cu','application/cu-seeme'],['curl','text/vnd.curl'],['cww','application/prs.cww'],['cxx','text/plain'],['dae','model/vnd.collada+xml'],['daf','application/vnd.mobius.daf'],['davmount','application/davmount+xml'],['dcr','application/x-director'],['dcurl','text/vnd.curl.dcurl'],['dd2','application/vnd.oma.dd2+xml'],['ddd','application/vnd.fujixerox.ddd'],['deb','application/x-debian-package'],['deepv','application/x-deepv'],['def','text/plain'],['der','application/x-x509-ca-cert'],['dfac','application/vnd.dreamfactory'],['dif','video/x-dv'],['dir','application/x-director'],['dis','application/vnd.mobius.dis'],['djvu','image/vnd.djvu'],['dl',['video/dl','video/x-dl']],['dll','application/x-msdownload'],['dms','application/octet-stream'],['dna','application/vnd.dna'],['doc','application/msword'],['docm','application/vnd.ms-word.document.macroenabled.12'],['docx','application/vnd.openxmlformats-officedocument.wordprocessingml.document'],['dot','application/msword'],['dotm','application/vnd.ms-word.template.macroenabled.12'],['dotx','application/vnd.openxmlformats-officedocument.wordprocessingml.template'],['dp',['application/commonground','application/vnd.osgi.dp']],['dpg','application/vnd.dpgraph'],['dra','audio/vnd.dra'],['drw','application/drafting'],['dsc','text/prs.lines.tag'],['dssc','application/dssc+der'],['dtb','application/x-dtbook+xml'],['dtd','application/xml-dtd'],['dts','audio/vnd.dts'],['dtshd','audio/vnd.dts.hd'],['dump','application/octet-stream'],['dv','video/x-dv'],['dvi','application/x-dvi'],['dwf',['model/vnd.dwf','drawing/x-dwf']],['dwg',['application/acad','image/vnd.dwg','image/x-dwg']],['dxf',['application/dxf','image/vnd.dwg','image/vnd.dxf','image/x-dwg']],['dxp','application/vnd.spotfire.dxp'],['dxr','application/x-director'],['ecelp4800','audio/vnd.nuera.ecelp4800'],['ecelp7470','audio/vnd.nuera.ecelp7470'],['ecelp9600','audio/vnd.nuera.ecelp9600'],['edm','application/vnd.novadigm.edm'],['edx','application/vnd.novadigm.edx'],['efif','application/vnd.picsel'],['ei6','application/vnd.pg.osasli'],['el','text/x-script.elisp'],['elc',['application/x-elc','application/x-bytecode.elisp']],['eml','message/rfc822'],['emma','application/emma+xml'],['env','application/x-envoy'],['eol','audio/vnd.digital-winds'],['eot','application/vnd.ms-fontobject'],['eps','application/postscript'],['epub','application/epub+zip'],['es',['application/ecmascript','application/x-esrehber']],['es3','application/vnd.eszigno3+xml'],['esf','application/vnd.epson.esf'],['etx','text/x-setext'],['evy',['application/envoy','application/x-envoy']],['exe',['application/octet-stream','application/x-msdownload']],['exi','application/exi'],['ext','application/vnd.novadigm.ext'],['ez2','application/vnd.ezpix-album'],['ez3','application/vnd.ezpix-package'],['f',['text/plain','text/x-fortran']],['f4v','video/x-f4v'],['f77','text/x-fortran'],['f90',['text/plain','text/x-fortran']],['fbs','image/vnd.fastbidsheet'],['fcs','application/vnd.isac.fcs'],['fdf','application/vnd.fdf'],['fe_launch','application/vnd.denovo.fcselayout-link'],['fg5','application/vnd.fujitsu.oasysgp'],['fh','image/x-freehand'],['fif',['application/fractals','image/fif']],['fig','application/x-xfig'],['fli',['video/fli','video/x-fli']],['flo',['image/florian','application/vnd.micrografx.flo']],['flr','x-world/x-vrml'],['flv','video/x-flv'],['flw','application/vnd.kde.kivio'],['flx','text/vnd.fmi.flexstor'],['fly','text/vnd.fly'],['fm','application/vnd.framemaker'],['fmf','video/x-atomic3d-feature'],['fnc','application/vnd.frogans.fnc'],['for',['text/plain','text/x-fortran']],['fpx',['image/vnd.fpx','image/vnd.net-fpx']],['frl','application/freeloader'],['fsc','application/vnd.fsc.weblaunch'],['fst','image/vnd.fst'],['ftc','application/vnd.fluxtime.clip'],['fti','application/vnd.anser-web-funds-transfer-initiation'],['funk','audio/make'],['fvt','video/vnd.fvt'],['fxp','application/vnd.adobe.fxp'],['fzs','application/vnd.fuzzysheet'],['g','text/plain'],['g2w','application/vnd.geoplan'],['g3','image/g3fax'],['g3w','application/vnd.geospace'],['gac','application/vnd.groove-account'],['gdl','model/vnd.gdl'],['geo','application/vnd.dynageo'],['geojson','application/geo+json'],['gex','application/vnd.geometry-explorer'],['ggb','application/vnd.geogebra.file'],['ggt','application/vnd.geogebra.tool'],['ghf','application/vnd.groove-help'],['gif','image/gif'],['gim','application/vnd.groove-identity-message'],['gl',['video/gl','video/x-gl']],['gmx','application/vnd.gmx'],['gnumeric','application/x-gnumeric'],['gph','application/vnd.flographit'],['gqf','application/vnd.grafeq'],['gram','application/srgs'],['grv','application/vnd.groove-injector'],['grxml','application/srgs+xml'],['gsd','audio/x-gsm'],['gsf','application/x-font-ghostscript'],['gsm','audio/x-gsm'],['gsp','application/x-gsp'],['gss','application/x-gss'],['gtar','application/x-gtar'],['gtm','application/vnd.groove-tool-message'],['gtw','model/vnd.gtw'],['gv','text/vnd.graphviz'],['gxt','application/vnd.geonext'],['gz',['application/x-gzip','application/x-compressed']],['gzip',['multipart/x-gzip','application/x-gzip']],['h',['text/plain','text/x-h']],['h261','video/h261'],['h263','video/h263'],['h264','video/h264'],['hal','application/vnd.hal+xml'],['hbci','application/vnd.hbci'],['hdf','application/x-hdf'],['help','application/x-helpfile'],['hgl','application/vnd.hp-hpgl'],['hh',['text/plain','text/x-h']],['hlb','text/x-script'],['hlp',['application/winhlp','application/hlp','application/x-helpfile','application/x-winhelp']],['hpg','application/vnd.hp-hpgl'],['hpgl','application/vnd.hp-hpgl'],['hpid','application/vnd.hp-hpid'],['hps','application/vnd.hp-hps'],['hqx',['application/mac-binhex40','application/binhex','application/binhex4','application/mac-binhex','application/x-binhex40','application/x-mac-binhex40']],['hta','application/hta'],['htc','text/x-component'],['htke','application/vnd.kenameaapp'],['htm','text/html'],['html','text/html'],['htmls','text/html'],['htt','text/webviewhtml'],['htx','text/html'],['hvd','application/vnd.yamaha.hv-dic'],['hvp','application/vnd.yamaha.hv-voice'],['hvs','application/vnd.yamaha.hv-script'],['i2g','application/vnd.intergeo'],['icc','application/vnd.iccprofile'],['ice','x-conference/x-cooltalk'],['ico','image/x-icon'],['ics','text/calendar'],['idc','text/plain'],['ief','image/ief'],['iefs','image/ief'],['ifm','application/vnd.shana.informed.formdata'],['iges',['application/iges','model/iges']],['igl','application/vnd.igloader'],['igm','application/vnd.insors.igm'],['igs',['application/iges','model/iges']],['igx','application/vnd.micrografx.igx'],['iif','application/vnd.shana.informed.interchange'],['iii','application/x-iphone'],['ima','application/x-ima'],['imap','application/x-httpd-imap'],['imp','application/vnd.accpac.simply.imp'],['ims','application/vnd.ms-ims'],['inf','application/inf'],['ins',['application/x-internet-signup','application/x-internett-signup']],['ip','application/x-ip2'],['ipfix','application/ipfix'],['ipk','application/vnd.shana.informed.package'],['irm','application/vnd.ibm.rights-management'],['irp','application/vnd.irepository.package+xml'],['isp','application/x-internet-signup'],['isu','video/x-isvideo'],['it','audio/it'],['itp','application/vnd.shana.informed.formtemplate'],['iv','application/x-inventor'],['ivp','application/vnd.immervision-ivp'],['ivr','i-world/i-vrml'],['ivu','application/vnd.immervision-ivu'],['ivy','application/x-livescreen'],['jad','text/vnd.sun.j2me.app-descriptor'],['jam',['application/vnd.jam','audio/x-jam']],['jar','application/java-archive'],['jav',['text/plain','text/x-java-source']],['java',['text/plain','text/x-java-source,java','text/x-java-source']],['jcm','application/x-java-commerce'],['jfif',['image/pipeg','image/jpeg','image/pjpeg']],['jfif-tbnl','image/jpeg'],['jisp','application/vnd.jisp'],['jlt','application/vnd.hp-jlyt'],['jnlp','application/x-java-jnlp-file'],['joda','application/vnd.joost.joda-archive'],['jpe',['image/jpeg','image/pjpeg']],['jpeg',['image/jpeg','image/pjpeg']],['jpg',['image/jpeg','image/pjpeg']],['jpgv','video/jpeg'],['jpm','video/jpm'],['jps','image/x-jps'],['js',['application/javascript','application/ecmascript','text/javascript','text/ecmascript','application/x-javascript']],['json','application/json'],['jut','image/jutvision'],['kar',['audio/midi','music/x-karaoke']],['karbon','application/vnd.kde.karbon'],['kfo','application/vnd.kde.kformula'],['kia','application/vnd.kidspiration'],['kml','application/vnd.google-earth.kml+xml'],['kmz','application/vnd.google-earth.kmz'],['kne','application/vnd.kinar'],['kon','application/vnd.kde.kontour'],['kpr','application/vnd.kde.kpresenter'],['ksh',['application/x-ksh','text/x-script.ksh']],['ksp','application/vnd.kde.kspread'],['ktx','image/ktx'],['ktz','application/vnd.kahootz'],['kwd','application/vnd.kde.kword'],['la',['audio/nspaudio','audio/x-nspaudio']],['lam','audio/x-liveaudio'],['lasxml','application/vnd.las.las+xml'],['latex','application/x-latex'],['lbd','application/vnd.llamagraphics.life-balance.desktop'],['lbe','application/vnd.llamagraphics.life-balance.exchange+xml'],['les','application/vnd.hhe.lesson-player'],['lha',['application/octet-stream','application/lha','application/x-lha']],['lhx','application/octet-stream'],['link66','application/vnd.route66.link66+xml'],['list','text/plain'],['lma',['audio/nspaudio','audio/x-nspaudio']],['log','text/plain'],['lrm','application/vnd.ms-lrm'],['lsf','video/x-la-asf'],['lsp',['application/x-lisp','text/x-script.lisp']],['lst','text/plain'],['lsx',['video/x-la-asf','text/x-la-asf']],['ltf','application/vnd.frogans.ltf'],['ltx','application/x-latex'],['lvp','audio/vnd.lucent.voice'],['lwp','application/vnd.lotus-wordpro'],['lzh',['application/octet-stream','application/x-lzh']],['lzx',['application/lzx','application/octet-stream','application/x-lzx']],['m',['text/plain','text/x-m']],['m13','application/x-msmediaview'],['m14','application/x-msmediaview'],['m1v','video/mpeg'],['m21','application/mp21'],['m2a','audio/mpeg'],['m2v','video/mpeg'],['m3u',['audio/x-mpegurl','audio/x-mpequrl']],['m3u8','application/vnd.apple.mpegurl'],['m4v','video/x-m4v'],['ma','application/mathematica'],['mads','application/mads+xml'],['mag','application/vnd.ecowin.chart'],['man','application/x-troff-man'],['map','application/x-navimap'],['mar','text/plain'],['mathml','application/mathml+xml'],['mbd','application/mbedlet'],['mbk','application/vnd.mobius.mbk'],['mbox','application/mbox'],['mc$','application/x-magic-cap-package-1.0'],['mc1','application/vnd.medcalcdata'],['mcd',['application/mcad','application/vnd.mcd','application/x-mathcad']],['mcf',['image/vasa','text/mcf']],['mcp','application/netmc'],['mcurl','text/vnd.curl.mcurl'],['mdb','application/x-msaccess'],['mdi','image/vnd.ms-modi'],['me','application/x-troff-me'],['meta4','application/metalink4+xml'],['mets','application/mets+xml'],['mfm','application/vnd.mfmp'],['mgp','application/vnd.osgeo.mapguide.package'],['mgz','application/vnd.proteus.magazine'],['mht','message/rfc822'],['mhtml','message/rfc822'],['mid',['audio/mid','audio/midi','music/crescendo','x-music/x-midi','audio/x-midi','application/x-midi','audio/x-mid']],['midi',['audio/midi','music/crescendo','x-music/x-midi','audio/x-midi','application/x-midi','audio/x-mid']],['mif',['application/vnd.mif','application/x-mif','application/x-frame']],['mime',['message/rfc822','www/mime']],['mj2','video/mj2'],['mjf','audio/x-vnd.audioexplosion.mjuicemediafile'],['mjpg','video/x-motion-jpeg'],['mlp','application/vnd.dolby.mlp'],['mm',['application/base64','application/x-meme']],['mmd','application/vnd.chipnuts.karaoke-mmd'],['mme','application/base64'],['mmf','application/vnd.smaf'],['mmr','image/vnd.fujixerox.edmics-mmr'],['mny','application/x-msmoney'],['mod',['audio/mod','audio/x-mod']],['mods','application/mods+xml'],['moov','video/quicktime'],['mov','video/quicktime'],['movie','video/x-sgi-movie'],['mp2',['video/mpeg','audio/mpeg','video/x-mpeg','audio/x-mpeg','video/x-mpeq2a']],['mp3',['audio/mpeg','audio/mpeg3','video/mpeg','audio/x-mpeg-3','video/x-mpeg']],['mp4',['video/mp4','application/mp4']],['mp4a','audio/mp4'],['mpa',['video/mpeg','audio/mpeg']],['mpc',['application/vnd.mophun.certificate','application/x-project']],['mpe','video/mpeg'],['mpeg','video/mpeg'],['mpg',['video/mpeg','audio/mpeg']],['mpga','audio/mpeg'],['mpkg','application/vnd.apple.installer+xml'],['mpm','application/vnd.blueice.multipass'],['mpn','application/vnd.mophun.application'],['mpp','application/vnd.ms-project'],['mpt','application/x-project'],['mpv','application/x-project'],['mpv2','video/mpeg'],['mpx','application/x-project'],['mpy','application/vnd.ibm.minipay'],['mqy','application/vnd.mobius.mqy'],['mrc','application/marc'],['mrcx','application/marcxml+xml'],['ms','application/x-troff-ms'],['mscml','application/mediaservercontrol+xml'],['mseq','application/vnd.mseq'],['msf','application/vnd.epson.msf'],['msg','application/vnd.ms-outlook'],['msh','model/mesh'],['msl','application/vnd.mobius.msl'],['msty','application/vnd.muvee.style'],['mts','model/vnd.mts'],['mus','application/vnd.musician'],['musicxml','application/vnd.recordare.musicxml+xml'],['mv','video/x-sgi-movie'],['mvb','application/x-msmediaview'],['mwf','application/vnd.mfer'],['mxf','application/mxf'],['mxl','application/vnd.recordare.musicxml'],['mxml','application/xv+xml'],['mxs','application/vnd.triscape.mxs'],['mxu','video/vnd.mpegurl'],['my','audio/make'],['mzz','application/x-vnd.audioexplosion.mzz'],['n-gage','application/vnd.nokia.n-gage.symbian.install'],['n3','text/n3'],['nap','image/naplps'],['naplps','image/naplps'],['nbp','application/vnd.wolfram.player'],['nc','application/x-netcdf'],['ncm','application/vnd.nokia.configuration-message'],['ncx','application/x-dtbncx+xml'],['ngdat','application/vnd.nokia.n-gage.data'],['nif','image/x-niff'],['niff','image/x-niff'],['nix','application/x-mix-transfer'],['nlu','application/vnd.neurolanguage.nlu'],['nml','application/vnd.enliven'],['nnd','application/vnd.noblenet-directory'],['nns','application/vnd.noblenet-sealer'],['nnw','application/vnd.noblenet-web'],['npx','image/vnd.net-fpx'],['nsc','application/x-conference'],['nsf','application/vnd.lotus-notes'],['nvd','application/x-navidoc'],['nws','message/rfc822'],['o','application/octet-stream'],['oa2','application/vnd.fujitsu.oasys2'],['oa3','application/vnd.fujitsu.oasys3'],['oas','application/vnd.fujitsu.oasys'],['obd','application/x-msbinder'],['oda','application/oda'],['odb','application/vnd.oasis.opendocument.database'],['odc','application/vnd.oasis.opendocument.chart'],['odf','application/vnd.oasis.opendocument.formula'],['odft','application/vnd.oasis.opendocument.formula-template'],['odg','application/vnd.oasis.opendocument.graphics'],['odi','application/vnd.oasis.opendocument.image'],['odm','application/vnd.oasis.opendocument.text-master'],['odp','application/vnd.oasis.opendocument.presentation'],['ods','application/vnd.oasis.opendocument.spreadsheet'],['odt','application/vnd.oasis.opendocument.text'],['oga','audio/ogg'],['ogv','video/ogg'],['ogx','application/ogg'],['omc','application/x-omc'],['omcd','application/x-omcdatamaker'],['omcr','application/x-omcregerator'],['onetoc','application/onenote'],['opf','application/oebps-package+xml'],['org','application/vnd.lotus-organizer'],['osf','application/vnd.yamaha.openscoreformat'],['osfpvg','application/vnd.yamaha.openscoreformat.osfpvg+xml'],['otc','application/vnd.oasis.opendocument.chart-template'],['otf','application/x-font-otf'],['otg','application/vnd.oasis.opendocument.graphics-template'],['oth','application/vnd.oasis.opendocument.text-web'],['oti','application/vnd.oasis.opendocument.image-template'],['otp','application/vnd.oasis.opendocument.presentation-template'],['ots','application/vnd.oasis.opendocument.spreadsheet-template'],['ott','application/vnd.oasis.opendocument.text-template'],['oxt','application/vnd.openofficeorg.extension'],['p','text/x-pascal'],['p10',['application/pkcs10','application/x-pkcs10']],['p12',['application/pkcs-12','application/x-pkcs12']],['p7a','application/x-pkcs7-signature'],['p7b','application/x-pkcs7-certificates'],['p7c',['application/pkcs7-mime','application/x-pkcs7-mime']],['p7m',['application/pkcs7-mime','application/x-pkcs7-mime']],['p7r','application/x-pkcs7-certreqresp'],['p7s',['application/pkcs7-signature','application/x-pkcs7-signature']],['p8','application/pkcs8'],['par','text/plain-bas'],['part','application/pro_eng'],['pas','text/pascal'],['paw','application/vnd.pawaafile'],['pbd','application/vnd.powerbuilder6'],['pbm','image/x-portable-bitmap'],['pcf','application/x-font-pcf'],['pcl',['application/vnd.hp-pcl','application/x-pcl']],['pclxl','application/vnd.hp-pclxl'],['pct','image/x-pict'],['pcurl','application/vnd.curl.pcurl'],['pcx','image/x-pcx'],['pdb',['application/vnd.palm','chemical/x-pdb']],['pdf','application/pdf'],['pfa','application/x-font-type1'],['pfr','application/font-tdpfr'],['pfunk',['audio/make','audio/make.my.funk']],['pfx','application/x-pkcs12'],['pgm',['image/x-portable-graymap','image/x-portable-greymap']],['pgn','application/x-chess-pgn'],['pgp','application/pgp-signature'],['pic',['image/pict','image/x-pict']],['pict','image/pict'],['pkg','application/x-newton-compatible-pkg'],['pki','application/pkixcmp'],['pkipath','application/pkix-pkipath'],['pko',['application/ynd.ms-pkipko','application/vnd.ms-pki.pko']],['pl',['text/plain','text/x-script.perl']],['plb','application/vnd.3gpp.pic-bw-large'],['plc','application/vnd.mobius.plc'],['plf','application/vnd.pocketlearn'],['pls','application/pls+xml'],['plx','application/x-pixclscript'],['pm',['text/x-script.perl-module','image/x-xpixmap']],['pm4','application/x-pagemaker'],['pm5','application/x-pagemaker'],['pma','application/x-perfmon'],['pmc','application/x-perfmon'],['pml',['application/vnd.ctc-posml','application/x-perfmon']],['pmr','application/x-perfmon'],['pmw','application/x-perfmon'],['png','image/png'],['pnm',['application/x-portable-anymap','image/x-portable-anymap']],['portpkg','application/vnd.macports.portpkg'],['pot',['application/vnd.ms-powerpoint','application/mspowerpoint']],['potm','application/vnd.ms-powerpoint.template.macroenabled.12'],['potx','application/vnd.openxmlformats-officedocument.presentationml.template'],['pov','model/x-pov'],['ppa','application/vnd.ms-powerpoint'],['ppam','application/vnd.ms-powerpoint.addin.macroenabled.12'],['ppd','application/vnd.cups-ppd'],['ppm','image/x-portable-pixmap'],['pps',['application/vnd.ms-powerpoint','application/mspowerpoint']],['ppsm','application/vnd.ms-powerpoint.slideshow.macroenabled.12'],['ppsx','application/vnd.openxmlformats-officedocument.presentationml.slideshow'],['ppt',['application/vnd.ms-powerpoint','application/mspowerpoint','application/powerpoint','application/x-mspowerpoint']],['pptm','application/vnd.ms-powerpoint.presentation.macroenabled.12'],['pptx','application/vnd.openxmlformats-officedocument.presentationml.presentation'],['ppz','application/mspowerpoint'],['prc','application/x-mobipocket-ebook'],['pre',['application/vnd.lotus-freelance','application/x-freelance']],['prf','application/pics-rules'],['prt','application/pro_eng'],['ps','application/postscript'],['psb','application/vnd.3gpp.pic-bw-small'],['psd',['application/octet-stream','image/vnd.adobe.photoshop']],['psf','application/x-font-linux-psf'],['pskcxml','application/pskc+xml'],['ptid','application/vnd.pvi.ptid1'],['pub','application/x-mspublisher'],['pvb','application/vnd.3gpp.pic-bw-var'],['pvu','paleovu/x-pv'],['pwn','application/vnd.3m.post-it-notes'],['pwz','application/vnd.ms-powerpoint'],['py','text/x-script.phyton'],['pya','audio/vnd.ms-playready.media.pya'],['pyc','application/x-bytecode.python'],['pyv','video/vnd.ms-playready.media.pyv'],['qam','application/vnd.epson.quickanime'],['qbo','application/vnd.intu.qbo'],['qcp','audio/vnd.qcelp'],['qd3','x-world/x-3dmf'],['qd3d','x-world/x-3dmf'],['qfx','application/vnd.intu.qfx'],['qif','image/x-quicktime'],['qps','application/vnd.publishare-delta-tree'],['qt','video/quicktime'],['qtc','video/x-qtc'],['qti','image/x-quicktime'],['qtif','image/x-quicktime'],['qxd','application/vnd.quark.quarkxpress'],['ra',['audio/x-realaudio','audio/x-pn-realaudio','audio/x-pn-realaudio-plugin']],['ram','audio/x-pn-realaudio'],['rar','application/x-rar-compressed'],['ras',['image/cmu-raster','application/x-cmu-raster','image/x-cmu-raster']],['rast','image/cmu-raster'],['rcprofile','application/vnd.ipunplugged.rcprofile'],['rdf','application/rdf+xml'],['rdz','application/vnd.data-vision.rdz'],['rep','application/vnd.businessobjects'],['res','application/x-dtbresource+xml'],['rexx','text/x-script.rexx'],['rf','image/vnd.rn-realflash'],['rgb','image/x-rgb'],['rif','application/reginfo+xml'],['rip','audio/vnd.rip'],['rl','application/resource-lists+xml'],['rlc','image/vnd.fujixerox.edmics-rlc'],['rld','application/resource-lists-diff+xml'],['rm',['application/vnd.rn-realmedia','audio/x-pn-realaudio']],['rmi','audio/mid'],['rmm','audio/x-pn-realaudio'],['rmp',['audio/x-pn-realaudio-plugin','audio/x-pn-realaudio']],['rms','application/vnd.jcp.javame.midlet-rms'],['rnc','application/relax-ng-compact-syntax'],['rng',['application/ringing-tones','application/vnd.nokia.ringing-tone']],['rnx','application/vnd.rn-realplayer'],['roff','application/x-troff'],['rp','image/vnd.rn-realpix'],['rp9','application/vnd.cloanto.rp9'],['rpm','audio/x-pn-realaudio-plugin'],['rpss','application/vnd.nokia.radio-presets'],['rpst','application/vnd.nokia.radio-preset'],['rq','application/sparql-query'],['rs','application/rls-services+xml'],['rsd','application/rsd+xml'],['rt',['text/richtext','text/vnd.rn-realtext']],['rtf',['application/rtf','text/richtext','application/x-rtf']],['rtx',['text/richtext','application/rtf']],['rv','video/vnd.rn-realvideo'],['s','text/x-asm'],['s3m','audio/s3m'],['saf','application/vnd.yamaha.smaf-audio'],['saveme','application/octet-stream'],['sbk','application/x-tbook'],['sbml','application/sbml+xml'],['sc','application/vnd.ibm.secure-container'],['scd','application/x-msschedule'],['scm',['application/vnd.lotus-screencam','video/x-scm','text/x-script.guile','application/x-lotusscreencam','text/x-script.scheme']],['scq','application/scvp-cv-request'],['scs','application/scvp-cv-response'],['sct','text/scriptlet'],['scurl','text/vnd.curl.scurl'],['sda','application/vnd.stardivision.draw'],['sdc','application/vnd.stardivision.calc'],['sdd','application/vnd.stardivision.impress'],['sdkm','application/vnd.solent.sdkm+xml'],['sdml','text/plain'],['sdp',['application/sdp','application/x-sdp']],['sdr','application/sounder'],['sdw','application/vnd.stardivision.writer'],['sea',['application/sea','application/x-sea']],['see','application/vnd.seemail'],['seed','application/vnd.fdsn.seed'],['sema','application/vnd.sema'],['semd','application/vnd.semd'],['semf','application/vnd.semf'],['ser','application/java-serialized-object'],['set','application/set'],['setpay','application/set-payment-initiation'],['setreg','application/set-registration-initiation'],['sfd-hdstx','application/vnd.hydrostatix.sof-data'],['sfs','application/vnd.spotfire.sfs'],['sgl','application/vnd.stardivision.writer-global'],['sgm',['text/sgml','text/x-sgml']],['sgml',['text/sgml','text/x-sgml']],['sh',['application/x-shar','application/x-bsh','application/x-sh','text/x-script.sh']],['shar',['application/x-bsh','application/x-shar']],['shf','application/shf+xml'],['shtml',['text/html','text/x-server-parsed-html']],['sid','audio/x-psid'],['sis','application/vnd.symbian.install'],['sit',['application/x-stuffit','application/x-sit']],['sitx','application/x-stuffitx'],['skd','application/x-koan'],['skm','application/x-koan'],['skp',['application/vnd.koan','application/x-koan']],['skt','application/x-koan'],['sl','application/x-seelogo'],['sldm','application/vnd.ms-powerpoint.slide.macroenabled.12'],['sldx','application/vnd.openxmlformats-officedocument.presentationml.slide'],['slt','application/vnd.epson.salt'],['sm','application/vnd.stepmania.stepchart'],['smf','application/vnd.stardivision.math'],['smi',['application/smil','application/smil+xml']],['smil','application/smil'],['snd',['audio/basic','audio/x-adpcm']],['snf','application/x-font-snf'],['sol','application/solids'],['spc',['text/x-speech','application/x-pkcs7-certificates']],['spf','application/vnd.yamaha.smaf-phrase'],['spl',['application/futuresplash','application/x-futuresplash']],['spot','text/vnd.in3d.spot'],['spp','application/scvp-vp-response'],['spq','application/scvp-vp-request'],['spr','application/x-sprite'],['sprite','application/x-sprite'],['src','application/x-wais-source'],['sru','application/sru+xml'],['srx','application/sparql-results+xml'],['sse','application/vnd.kodak-descriptor'],['ssf','application/vnd.epson.ssf'],['ssi','text/x-server-parsed-html'],['ssm','application/streamingmedia'],['ssml','application/ssml+xml'],['sst',['application/vnd.ms-pkicertstore','application/vnd.ms-pki.certstore']],['st','application/vnd.sailingtracker.track'],['stc','application/vnd.sun.xml.calc.template'],['std','application/vnd.sun.xml.draw.template'],['step','application/step'],['stf','application/vnd.wt.stf'],['sti','application/vnd.sun.xml.impress.template'],['stk','application/hyperstudio'],['stl',['application/vnd.ms-pkistl','application/sla','application/vnd.ms-pki.stl','application/x-navistyle']],['stm','text/html'],['stp','application/step'],['str','application/vnd.pg.format'],['stw','application/vnd.sun.xml.writer.template'],['sub','image/vnd.dvb.subtitle'],['sus','application/vnd.sus-calendar'],['sv4cpio','application/x-sv4cpio'],['sv4crc','application/x-sv4crc'],['svc','application/vnd.dvb.service'],['svd','application/vnd.svd'],['svf',['image/vnd.dwg','image/x-dwg']],['svg','image/svg+xml'],['svr',['x-world/x-svr','application/x-world']],['swf','application/x-shockwave-flash'],['swi','application/vnd.aristanetworks.swi'],['sxc','application/vnd.sun.xml.calc'],['sxd','application/vnd.sun.xml.draw'],['sxg','application/vnd.sun.xml.writer.global'],['sxi','application/vnd.sun.xml.impress'],['sxm','application/vnd.sun.xml.math'],['sxw','application/vnd.sun.xml.writer'],['t',['text/troff','application/x-troff']],['talk','text/x-speech'],['tao','application/vnd.tao.intent-module-archive'],['tar','application/x-tar'],['tbk',['application/toolbook','application/x-tbook']],['tcap','application/vnd.3gpp2.tcap'],['tcl',['text/x-script.tcl','application/x-tcl']],['tcsh','text/x-script.tcsh'],['teacher','application/vnd.smart.teacher'],['tei','application/tei+xml'],['tex','application/x-tex'],['texi','application/x-texinfo'],['texinfo','application/x-texinfo'],['text',['application/plain','text/plain']],['tfi','application/thraud+xml'],['tfm','application/x-tex-tfm'],['tgz',['application/gnutar','application/x-compressed']],['thmx','application/vnd.ms-officetheme'],['tif',['image/tiff','image/x-tiff']],['tiff',['image/tiff','image/x-tiff']],['tmo','application/vnd.tmobile-livetv'],['torrent','application/x-bittorrent'],['tpl','application/vnd.groove-tool-template'],['tpt','application/vnd.trid.tpt'],['tr','application/x-troff'],['tra','application/vnd.trueapp'],['trm','application/x-msterminal'],['tsd','application/timestamped-data'],['tsi','audio/tsp-audio'],['tsp',['application/dsptype','audio/tsplayer']],['tsv','text/tab-separated-values'],['ttf','application/x-font-ttf'],['ttl','text/turtle'],['turbot','image/florian'],['twd','application/vnd.simtech-mindmapper'],['txd','application/vnd.genomatix.tuxedo'],['txf','application/vnd.mobius.txf'],['txt','text/plain'],['ufd','application/vnd.ufdl'],['uil','text/x-uil'],['uls','text/iuls'],['umj','application/vnd.umajin'],['uni','text/uri-list'],['unis','text/uri-list'],['unityweb','application/vnd.unity'],['unv','application/i-deas'],['uoml','application/vnd.uoml+xml'],['uri','text/uri-list'],['uris','text/uri-list'],['ustar',['application/x-ustar','multipart/x-ustar']],['utz','application/vnd.uiq.theme'],['uu',['application/octet-stream','text/x-uuencode']],['uue','text/x-uuencode'],['uva','audio/vnd.dece.audio'],['uvh','video/vnd.dece.hd'],['uvi','image/vnd.dece.graphic'],['uvm','video/vnd.dece.mobile'],['uvp','video/vnd.dece.pd'],['uvs','video/vnd.dece.sd'],['uvu','video/vnd.uvvu.mp4'],['uvv','video/vnd.dece.video'],['vcd','application/x-cdlink'],['vcf','text/x-vcard'],['vcg','application/vnd.groove-vcard'],['vcs','text/x-vcalendar'],['vcx','application/vnd.vcx'],['vda','application/vda'],['vdo','video/vdo'],['vew','application/groupwise'],['vis','application/vnd.visionary'],['viv',['video/vivo','video/vnd.vivo']],['vivo',['video/vivo','video/vnd.vivo']],['vmd','application/vocaltec-media-desc'],['vmf','application/vocaltec-media-file'],['voc',['audio/voc','audio/x-voc']],['vos','video/vosaic'],['vox','audio/voxware'],['vqe','audio/x-twinvq-plugin'],['vqf','audio/x-twinvq'],['vql','audio/x-twinvq-plugin'],['vrml',['model/vrml','x-world/x-vrml','application/x-vrml']],['vrt','x-world/x-vrt'],['vsd',['application/vnd.visio','application/x-visio']],['vsf','application/vnd.vsf'],['vst','application/x-visio'],['vsw','application/x-visio'],['vtu','model/vnd.vtu'],['vxml','application/voicexml+xml'],['w60','application/wordperfect6.0'],['w61','application/wordperfect6.1'],['w6w','application/msword'],['wad','application/x-doom'],['wav',['audio/wav','audio/x-wav']],['wax','audio/x-ms-wax'],['wb1','application/x-qpro'],['wbmp','image/vnd.wap.wbmp'],['wbs','application/vnd.criticaltools.wbs+xml'],['wbxml','application/vnd.wap.wbxml'],['wcm','application/vnd.ms-works'],['wdb','application/vnd.ms-works'],['web','application/vnd.xara'],['weba','audio/webm'],['webm','video/webm'],['webp','image/webp'],['wg','application/vnd.pmi.widget'],['wgt','application/widget'],['wiz','application/msword'],['wk1','application/x-123'],['wks','application/vnd.ms-works'],['wm','video/x-ms-wm'],['wma','audio/x-ms-wma'],['wmd','application/x-ms-wmd'],['wmf',['windows/metafile','application/x-msmetafile']],['wml','text/vnd.wap.wml'],['wmlc','application/vnd.wap.wmlc'],['wmls','text/vnd.wap.wmlscript'],['wmlsc','application/vnd.wap.wmlscriptc'],['wmv','video/x-ms-wmv'],['wmx','video/x-ms-wmx'],['wmz','application/x-ms-wmz'],['woff','application/x-font-woff'],['word','application/msword'],['wp','application/wordperfect'],['wp5',['application/wordperfect','application/wordperfect6.0']],['wp6','application/wordperfect'],['wpd',['application/wordperfect','application/vnd.wordperfect','application/x-wpwin']],['wpl','application/vnd.ms-wpl'],['wps','application/vnd.ms-works'],['wq1','application/x-lotus'],['wqd','application/vnd.wqd'],['wri',['application/mswrite','application/x-wri','application/x-mswrite']],['wrl',['model/vrml','x-world/x-vrml','application/x-world']],['wrz',['model/vrml','x-world/x-vrml']],['wsc','text/scriplet'],['wsdl','application/wsdl+xml'],['wspolicy','application/wspolicy+xml'],['wsrc','application/x-wais-source'],['wtb','application/vnd.webturbo'],['wtk','application/x-wintalk'],['wvx','video/x-ms-wvx'],['x-png','image/png'],['x3d','application/vnd.hzn-3d-crossword'],['xaf','x-world/x-vrml'],['xap','application/x-silverlight-app'],['xar','application/vnd.xara'],['xbap','application/x-ms-xbap'],['xbd','application/vnd.fujixerox.docuworks.binder'],['xbm',['image/xbm','image/x-xbm','image/x-xbitmap']],['xdf','application/xcap-diff+xml'],['xdm','application/vnd.syncml.dm+xml'],['xdp','application/vnd.adobe.xdp+xml'],['xdr','video/x-amt-demorun'],['xdssc','application/dssc+xml'],['xdw','application/vnd.fujixerox.docuworks'],['xenc','application/xenc+xml'],['xer','application/patch-ops-error+xml'],['xfdf','application/vnd.adobe.xfdf'],['xfdl','application/vnd.xfdl'],['xgz','xgl/drawing'],['xhtml','application/xhtml+xml'],['xif','image/vnd.xiff'],['xl','application/excel'],['xla',['application/vnd.ms-excel','application/excel','application/x-msexcel','application/x-excel']],['xlam','application/vnd.ms-excel.addin.macroenabled.12'],['xlb',['application/excel','application/vnd.ms-excel','application/x-excel']],['xlc',['application/vnd.ms-excel','application/excel','application/x-excel']],['xld',['application/excel','application/x-excel']],['xlk',['application/excel','application/x-excel']],['xll',['application/excel','application/vnd.ms-excel','application/x-excel']],['xlm',['application/vnd.ms-excel','application/excel','application/x-excel']],['xls',['application/vnd.ms-excel','application/excel','application/x-msexcel','application/x-excel']],['xlsb','application/vnd.ms-excel.sheet.binary.macroenabled.12'],['xlsm','application/vnd.ms-excel.sheet.macroenabled.12'],['xlsx','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'],['xlt',['application/vnd.ms-excel','application/excel','application/x-excel']],['xltm','application/vnd.ms-excel.template.macroenabled.12'],['xltx','application/vnd.openxmlformats-officedocument.spreadsheetml.template'],['xlv',['application/excel','application/x-excel']],['xlw',['application/vnd.ms-excel','application/excel','application/x-msexcel','application/x-excel']],['xm','audio/xm'],['xml',['application/xml','text/xml','application/atom+xml','application/rss+xml']],['xmz','xgl/movie'],['xo','application/vnd.olpc-sugar'],['xof','x-world/x-vrml'],['xop','application/xop+xml'],['xpi','application/x-xpinstall'],['xpix','application/x-vnd.ls-xpix'],['xpm',['image/xpm','image/x-xpixmap']],['xpr','application/vnd.is-xpr'],['xps','application/vnd.ms-xpsdocument'],['xpw','application/vnd.intercon.formnet'],['xslt','application/xslt+xml'],['xsm','application/vnd.syncml+xml'],['xspf','application/xspf+xml'],['xsr','video/x-amt-showrun'],['xul','application/vnd.mozilla.xul+xml'],['xwd',['image/x-xwd','image/x-xwindowdump']],['xyz',['chemical/x-xyz','chemical/x-pdb']],['yang','application/yang'],['yin','application/yin+xml'],['z',['application/x-compressed','application/x-compress']],['zaz','application/vnd.zzazz.deck+xml'],['zip',['application/zip','multipart/x-zip','application/x-zip-compressed','application/x-compressed']],['zir','application/vnd.zul'],['zmm','application/vnd.handheld-entertainment+xml'],['zoo','application/octet-stream'],['zsh','text/x-script.zsh']]);m.exports={detectMimeType(n){if(!n)return t;let c=p.parse(n),l=(c.ext.substr(1)||c.name||'').split('?').shift().trim().toLowerCase(),s=t;return o.has(l)&&(s=o.get(l)),Array.isArray(s)?s[0]:s},detectExtension(p){if(!p)return"bin";let t=(p||'').toLowerCase().trim().split('/'),o=t.shift().trim(),c=t.join('/').trim();if(n.has(o+'/'+c)){let p=n.get(o+'/'+c);return Array.isArray(p)?p[0]:p}return'text'===o?'txt':'bin'}}},7126,[4908]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]),i=r(d[1]),s=r(d[2]).parseDataURI;m.exports=class{constructor(t){this.mail=t||{},this.message=!1}compile(){return this._alternatives=this.getAlternatives(),this._htmlNode=this._alternatives.filter(t=>/^text\/html\b/i.test(t.contentType)).pop(),this._attachments=this.getAttachments(!!this._htmlNode),this._useRelated=!(!this._htmlNode||!this._attachments.related.length),this._useAlternative=this._alternatives.length>1,this._useMixed=this._attachments.attached.length>1||this._alternatives.length&&1===this._attachments.attached.length,this.mail.raw?this.message=new t('message/rfc822',{newline:this.mail.newline}).setRaw(this.mail.raw):this._useMixed?this.message=this._createMixed():this._useAlternative?this.message=this._createAlternative():this._useRelated?this.message=this._createRelated():this.message=this._createContentNode(!1,[].concat(this._alternatives||[]).concat(this._attachments.attached||[]).shift()||{contentType:'text/plain',content:''}),this.mail.headers&&this.message.addHeader(this.mail.headers),['from','sender','to','cc','bcc','reply-to','in-reply-to','references','subject','message-id','date'].forEach(t=>{let i=t.replace(/-(\w)/g,(t,i)=>i.toUpperCase());this.mail[i]&&this.message.setHeader(t,this.mail[i])}),this.mail.envelope&&this.message.setEnvelope(this.mail.envelope),this.message.messageId(),this.message}getAttachments(t){let s,n,l=[].concat(this.mail.attachments||[]).map((t,s)=>{let n;/^data:/i.test(t.path||t.href)&&(t=this._processDataUrl(t));let l,c=t.contentType||i.detectMimeType(t.filename||t.path||t.href||'bin'),h=/^image\//i.test(c),o=/^message\//i.test(c),p=t.contentDisposition||(o||h&&t.cid?'inline':'attachment');return l='contentTransferEncoding'in t?t.contentTransferEncoding:o?'7bit':'base64',n={contentType:c,contentDisposition:p,contentTransferEncoding:l},t.filename?n.filename=t.filename:o||!1===t.filename||(n.filename=(t.path||t.href||'').split('/').pop().split('?').shift()||'attachment-'+(s+1),n.filename.indexOf('.')<0&&(n.filename+='.'+i.detectExtension(n.contentType))),/^https?:\/\//i.test(t.path)&&(t.href=t.path,t.path=void 0),t.cid&&(n.cid=t.cid),t.raw?n.raw=t.raw:t.path?n.content={path:t.path}:t.href?n.content={href:t.href,httpHeaders:t.httpHeaders}:n.content=t.content||'',t.encoding&&(n.encoding=t.encoding),t.headers&&(n.headers=t.headers),n});return this.mail.icalEvent&&(s='object'==typeof this.mail.icalEvent&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?this.mail.icalEvent:{content:this.mail.icalEvent},n={},Object.keys(s).forEach(t=>{n[t]=s[t]}),n.contentType='application/ics',n.headers||(n.headers={}),n.filename=n.filename||'invite.ics',n.headers['Content-Disposition']='attachment',n.headers['Content-Transfer-Encoding']='base64'),t?{attached:l.filter(t=>!t.cid).concat(n||[]),related:l.filter(t=>!!t.cid)}:{attached:l.concat(n||[]),related:[]}}getAlternatives(){let t,s,n,l,c,h,o=[];return this.mail.text&&(t='object'==typeof this.mail.text&&(this.mail.text.content||this.mail.text.path||this.mail.text.href||this.mail.text.raw)?this.mail.text:{content:this.mail.text},t.contentType='text/plain; charset=utf-8'),this.mail.watchHtml&&(n='object'==typeof this.mail.watchHtml&&(this.mail.watchHtml.content||this.mail.watchHtml.path||this.mail.watchHtml.href||this.mail.watchHtml.raw)?this.mail.watchHtml:{content:this.mail.watchHtml},n.contentType='text/watch-html; charset=utf-8'),this.mail.amp&&(l='object'==typeof this.mail.amp&&(this.mail.amp.content||this.mail.amp.path||this.mail.amp.href||this.mail.amp.raw)?this.mail.amp:{content:this.mail.amp},l.contentType='text/x-amp-html; charset=utf-8'),this.mail.icalEvent&&(c='object'==typeof this.mail.icalEvent&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?this.mail.icalEvent:{content:this.mail.icalEvent},h={},Object.keys(c).forEach(t=>{h[t]=c[t]}),h.content&&'object'==typeof h.content&&(h.content._resolve=!0),h.filename=!1,h.contentType='text/calendar; charset=utf-8; method='+(h.method||'PUBLISH').toString().trim().toUpperCase(),h.headers||(h.headers={})),this.mail.html&&(s='object'==typeof this.mail.html&&(this.mail.html.content||this.mail.html.path||this.mail.html.href||this.mail.html.raw)?this.mail.html:{content:this.mail.html},s.contentType='text/html; charset=utf-8'),[].concat(t||[]).concat(n||[]).concat(l||[]).concat(s||[]).concat(h||[]).concat(this.mail.alternatives||[]).forEach(t=>{let s;/^data:/i.test(t.path||t.href)&&(t=this._processDataUrl(t)),s={contentType:t.contentType||i.detectMimeType(t.filename||t.path||t.href||'txt'),contentTransferEncoding:t.contentTransferEncoding},t.filename&&(s.filename=t.filename),/^https?:\/\//i.test(t.path)&&(t.href=t.path,t.path=void 0),t.raw?s.raw=t.raw:t.path?s.content={path:t.path}:t.href?s.content={href:t.href}:s.content=t.content||'',t.encoding&&(s.encoding=t.encoding),t.headers&&(s.headers=t.headers),o.push(s)}),o}_createMixed(i){let s;return s=i?i.createChild('multipart/mixed',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new t('multipart/mixed',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._useAlternative?this._createAlternative(s):this._useRelated&&this._createRelated(s),[].concat(!this._useAlternative&&this._alternatives||[]).concat(this._attachments.attached||[]).forEach(t=>{this._useRelated&&t===this._htmlNode||this._createContentNode(s,t)}),s}_createAlternative(i){let s;return s=i?i.createChild('multipart/alternative',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new t('multipart/alternative',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._alternatives.forEach(t=>{this._useRelated&&this._htmlNode===t?this._createRelated(s):this._createContentNode(s,t)}),s}_createRelated(i){let s;return s=i?i.createChild('multipart/related; type="text/html"',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new t('multipart/related; type="text/html"',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._createContentNode(s,this._htmlNode),this._attachments.related.forEach(t=>this._createContentNode(s,t)),s}_createContentNode(i,s){let n;(s=s||{}).content=s.content||'';let l=(s.encoding||'utf8').toString().toLowerCase().replace(/[-_\s]/g,'');return n=i?i.createChild(s.contentType,{filename:s.filename,textEncoding:this.mail.textEncoding,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new t(s.contentType,{filename:s.filename,baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),s.headers&&n.addHeader(s.headers),s.cid&&n.setHeader('Content-Id','<'+s.cid.replace(/[<>]/g,'')+'>'),s.contentTransferEncoding?n.setHeader('Content-Transfer-Encoding',s.contentTransferEncoding):this.mail.encoding&&/^text\//i.test(s.contentType)&&n.setHeader('Content-Transfer-Encoding',this.mail.encoding),/^text\//i.test(s.contentType)&&!s.contentDisposition||n.setHeader('Content-Disposition',s.contentDisposition||(s.cid&&/^image\//i.test(s.contentType)?'inline':'attachment')),'string'!=typeof s.content||['utf8','usascii','ascii'].includes(l)||(s.content=Buffer.from(s.content,l)),s.raw?n.setRaw(s.raw):n.setContent(s.content),n}_processDataUrl(t){const i=t.path||t.href;if(!i||'string'!=typeof i)return t;if(!i.startsWith('data:'))return t;if(i.length>52428800){let s='application/octet-stream';const n=i.indexOf(',');if(n>0&&n<200){const t=i.substring(5,n).split(';');t[0]&&t[0].includes('/')&&(s=t[0].trim())}return Object.assign({},t,{path:!1,href:!1,content:Buffer.alloc(0),contentType:t.contentType||s})}let n;try{n=s(i)}catch(i){return t}return n?(t.content=n.data,t.contentType=t.contentType||n.contentType,'path'in t&&(t.path=!1),'href'in t&&(t.href=!1),t):t}}},7127,[7128,7130,7121]);
__d(function(g,r,_i,_a,m,e,d){'use strict';const t=r(d[0]),s=r(d[1]),n=r(d[2]),i=r(d[3]).PassThrough,o=r(d[4]),a=r(d[5]),h=r(d[6]),c=r(d[7]),l=r(d[8]),p=r(d[9]),u=r(d[10]),f=r(d[11]),_=r(d[12]);class y{constructor(s,n){this.nodeCounter=0,n=n||{},this.baseBoundary=n.baseBoundary||t.randomBytes(8).toString('hex'),this.boundaryPrefix=n.boundaryPrefix||'--_NmP',this.disableFileAccess=!!n.disableFileAccess,this.disableUrlAccess=!!n.disableUrlAccess,this.normalizeHeaderKey=n.normalizeHeaderKey,this.date=new Date,this.rootNode=n.rootNode||this,this.keepBcc=!!n.keepBcc,n.filename&&(this.filename=n.filename,s||(s=a.detectMimeType(this.filename.split('.').pop()))),this.textEncoding=(n.textEncoding||'').toString().trim().charAt(0).toUpperCase(),this.parentNode=n.parentNode,this.hostname=n.hostname,this.newline=n.newline,this.childNodes=[],this._nodeId=++this.rootNode.nodeCounter,this._headers=[],this._isPlainText=!1,this._hasLongLines=!1,this._envelope=!1,this._raw=!1,this._transforms=[],this._processFuncs=[],s&&this.setHeader('Content-Type',s)}createChild(t,s){s||'object'!=typeof t||(s=t,t=void 0);let n=new y(t,s);return this.appendChild(n),n}appendChild(t){return t.rootNode!==this.rootNode&&(t.rootNode=this.rootNode,t._nodeId=++this.rootNode.nodeCounter),t.parentNode=this,this.childNodes.push(t),t}replace(t){return t===this?this:(this.parentNode.childNodes.forEach((s,n)=>{s===this&&(t.rootNode=this.rootNode,t.parentNode=this.parentNode,t._nodeId=this._nodeId,this.rootNode=this,this.parentNode=void 0,t.parentNode.childNodes[n]=t)}),t)}remove(){if(!this.parentNode)return this;for(let t=this.parentNode.childNodes.length-1;t>=0;t--)if(this.parentNode.childNodes[t]===this)return this.parentNode.childNodes.splice(t,1),this.parentNode=void 0,this.rootNode=this,this}setHeader(t,s){let n,i=!1;if(!s&&t&&'object'==typeof t)return t.key&&'value'in t?this.setHeader(t.key,t.value):Array.isArray(t)?t.forEach(t=>{this.setHeader(t.key,t.value)}):Object.keys(t).forEach(s=>{this.setHeader(s,t[s])}),this;n={key:t=this._normalizeHeaderKey(t),value:s};for(let s=0,o=this._headers.length;s<o;s++)this._headers[s].key===t&&(i?(this._headers.splice(s,1),s--,o--):(this._headers[s]=n,i=!0));return i||this._headers.push(n),this}addHeader(t,s){return!s&&t&&'object'==typeof t?(t.key&&t.value?this.addHeader(t.key,t.value):Array.isArray(t)?t.forEach(t=>{this.addHeader(t.key,t.value)}):Object.keys(t).forEach(s=>{this.addHeader(s,t[s])}),this):Array.isArray(s)?(s.forEach(s=>{this.addHeader(t,s)}),this):(this._headers.push({key:this._normalizeHeaderKey(t),value:s}),this)}getHeader(t){t=this._normalizeHeaderKey(t);for(let s=0,n=this._headers.length;s<n;s++)if(this._headers[s].key===t)return this._headers[s].value}setContent(t){return this.content=t,'function'==typeof this.content.pipe?(this._contentErrorHandler=t=>{this.content.removeListener('error',this._contentErrorHandler),this.content=t},this.content.once('error',this._contentErrorHandler)):'string'==typeof this.content&&(this._isPlainText=a.isPlainText(this.content),this._isPlainText&&a.hasLongerLines(this.content,76)&&(this._hasLongLines=!0)),this}build(t){let s;t||(s=new Promise((s,n)=>{t=o.callbackPromise(s,n)}));let n=this.createReadStream(),i=[],a=0,h=!1;return n.on('readable',()=>{let t;for(;null!==(t=n.read());)i.push(t),a+=t.length}),n.once('error',s=>{if(!h)return h=!0,t(s)}),n.once('end',s=>{if(!h)return h=!0,s&&s.length&&(i.push(s),a+=s.length),t(null,Buffer.concat(i,a))}),s}getTransferEncoding(){let t=!1,s=(this.getHeader('Content-Type')||'').toString().toLowerCase().trim();return this.content&&(t=(this.getHeader('Content-Transfer-Encoding')||'').toString().toLowerCase().trim(),t&&['base64','quoted-printable'].includes(t)||(/^text\//i.test(s)?t=this._isPlainText&&!this._hasLongLines?'7bit':'string'==typeof this.content||this.content instanceof Buffer?'Q'===this._getTextEncoding(this.content)?'quoted-printable':'base64':'B'===this.textEncoding?'base64':'quoted-printable':/^(multipart|message)\//i.test(s)||(t=t||'base64'))),t}buildHeaders(){let t=this.getTransferEncoding(),s=[];if(t&&this.setHeader('Content-Transfer-Encoding',t),this.filename&&!this.getHeader('Content-Disposition')&&this.setHeader('Content-Disposition','attachment'),this.rootNode===this){this.getHeader('Date')||this.setHeader('Date',this.date.toUTCString().replace(/GMT/,'+0000')),this.messageId(),this.getHeader('MIME-Version')||this.setHeader('MIME-Version','1.0');for(let t=this._headers.length-2;t>=0;t--){let s=this._headers[t];'Content-Type'===s.key&&(this._headers.splice(t,1),this._headers.push(s))}}return this._headers.forEach(t=>{let n,i,o=t.key,h=t.value,c={};if(!h||'object'!=typeof h||['From','Sender','To','Cc','Bcc','Reply-To','Date','References'].includes(o)||(Object.keys(h).forEach(t=>{'value'!==t&&(c[t]=h[t])}),h=(h.value||'').toString(),h.trim()))if(c.prepared)c.foldLines?s.push(a.foldLines(o+': '+h)):s.push(o+': '+h);else{switch(t.key){case'Content-Disposition':n=a.parseHeaderValue(h),this.filename&&(n.params.filename=this.filename),h=a.buildHeaderValue(n);break;case'Content-Type':n=a.parseHeaderValue(h),this._handleContentType(n),n.value.match(/^text\/plain\b/)&&'string'==typeof this.content&&/[\u0080-\uFFFF]/.test(this.content)&&(n.params.charset='utf-8'),h=a.buildHeaderValue(n),this.filename&&(i=this._encodeWords(this.filename),(i!==this.filename||/[\s'"\\;:/=(),<>@[\]?]|^-/.test(i))&&(i='"'+i+'"'),h+='; name='+i);break;case'Bcc':if(!this.keepBcc)return}if(h=this._encodeHeaderValue(o,h),(h||'').toString().trim()){if('function'==typeof this.normalizeHeaderKey){let t=this.normalizeHeaderKey(o,h);t&&'string'==typeof t&&t.length&&(o=t)}s.push(a.foldLines(o+': '+h,76))}}}),s.join('\r\n')}createReadStream(t){let s,n=new i(t=t||{}),o=n;this.stream(n,t,t=>{t?o.emit('error',t):n.end()});for(let t=0,n=this._transforms.length;t<n;t++)s='function'==typeof this._transforms[t]?this._transforms[t]():this._transforms[t],o.once('error',t=>{s.emit('error',t)}),o=o.pipe(s);s=new u,o.once('error',t=>{s.emit('error',t)}),o=o.pipe(s);for(let t=0,n=this._processFuncs.length;t<n;t++)s=this._processFuncs[t],o=s(o);if(this.newline){const t=['win','windows','dos','\r\n'].includes(this.newline.toString().toLowerCase())?new f:new _,s=o.pipe(t);return o.on('error',t=>s.emit('error',t)),s}return o}transform(t){this._transforms.push(t)}processFunc(t){this._processFuncs.push(t)}stream(t,s,n){let i,o,a=this.getTransferEncoding(),l=!1,p=t=>{l||(l=!0,n(t))},u=()=>{let n=0,i=()=>{if(n>=this.childNodes.length)return t.write('\r\n--'+this.boundary+'--\r\n'),p();let o=this.childNodes[n++];t.write((n>1?'\r\n':'')+'--'+this.boundary+'\r\n'),o.stream(t,s,t=>{if(t)return p(t);setImmediate(i)})};if(!this.multipart)return p();setImmediate(i)},f=()=>{if(this.content){if('[object Error]'===Object.prototype.toString.call(this.content))return p(this.content);'function'==typeof this.content.pipe&&(this.content.removeListener('error',this._contentErrorHandler),this._contentErrorHandler=t=>p(t),this.content.once('error',this._contentErrorHandler));let n=()=>{['quoted-printable','base64'].includes(a)?(i=new('base64'===a?c:h).Encoder(s),i.pipe(t,{end:!1}),i.once('end',u),i.once('error',t=>p(t)),o=this._getStream(this.content),o.pipe(i)):(o=this._getStream(this.content),o.pipe(t,{end:!1}),o.once('end',u)),o.once('error',t=>p(t))};if(this.content._resolve){let t=[],s=0,i=!1,o=this._getStream(this.content);o.on('error',t=>{i||(i=!0,p(t))}),o.on('readable',()=>{let n;for(;null!==(n=o.read());)t.push(n),s+=n.length}),o.on('end',()=>{i||(i=!0,this.content._resolve=!1,this.content._resolvedValue=Buffer.concat(t,s),setImmediate(n))})}else setImmediate(n);return}return setImmediate(u)};this._raw?setImmediate(()=>{if('[object Error]'===Object.prototype.toString.call(this._raw))return p(this._raw);'function'==typeof this._raw.pipe&&this._raw.removeListener('error',this._contentErrorHandler);let s=this._getStream(this._raw);s.pipe(t,{end:!1}),s.on('error',s=>t.emit('error',s)),s.on('end',u)}):(t.write(this.buildHeaders()+'\r\n\r\n'),setImmediate(f))}setEnvelope(t){let s;this._envelope={from:!1,to:[]},t.from&&(s=[],this._convertAddresses(this._parseAddresses(t.from),s),s=s.filter(t=>t&&t.address),s.length&&s[0]&&(this._envelope.from=s[0].address)),['to','cc','bcc'].forEach(s=>{t[s]&&this._convertAddresses(this._parseAddresses(t[s]),this._envelope.to)}),this._envelope.to=this._envelope.to.map(t=>t.address).filter(t=>t);let n=['to','cc','bcc','from'];return Object.keys(t).forEach(s=>{n.includes(s)||(this._envelope[s]=t[s])}),this}getAddresses(){let t={};return this._headers.forEach(s=>{let n=s.key.toLowerCase();['from','sender','reply-to','to','cc','bcc'].includes(n)&&(Array.isArray(t[n])||(t[n]=[]),this._convertAddresses(this._parseAddresses(s.value),t[n]))}),t}getEnvelope(){if(this._envelope)return this._envelope;let t={from:!1,to:[]};return this._headers.forEach(s=>{let n=[];'From'===s.key||!t.from&&['Reply-To','Sender'].includes(s.key)?(this._convertAddresses(this._parseAddresses(s.value),n),n.length&&n[0]&&(t.from=n[0].address)):['To','Cc','Bcc'].includes(s.key)&&this._convertAddresses(this._parseAddresses(s.value),t.to)}),t.to=t.to.map(t=>t.address),t}messageId(){let t=this.getHeader('Message-ID');return t||(t=this._generateMessageId(),this.setHeader('Message-ID',t)),t}setRaw(t){return this._raw=t,this._raw&&'function'==typeof this._raw.pipe&&(this._contentErrorHandler=t=>{this._raw.removeListener('error',this._contentErrorHandler),this._raw=t},this._raw.once('error',this._contentErrorHandler)),this}_getStream(t){let n;return t._resolvedValue?(n=new i,setImmediate(()=>{try{n.end(t._resolvedValue)}catch(t){n.emit('error',t)}}),n):'function'==typeof t.pipe?t:t&&'string'==typeof t.path&&!t.href?this.disableFileAccess?(n=new i,setImmediate(()=>n.emit('error',new Error('File access rejected for '+t.path))),n):s.createReadStream(t.path):t&&'string'==typeof t.href?this.disableUrlAccess?(n=new i,setImmediate(()=>n.emit('error',new Error('Url access rejected for '+t.href))),n):p(t.href,{headers:t.httpHeaders}):(n=new i,setImmediate(()=>{try{n.end(t||'')}catch(t){n.emit('error',t)}}),n)}_parseAddresses(t){return[].concat.apply([],[].concat(t).map(t=>t&&t.address?(t.address=this._normalizeAddress(t.address),t.name=t.name||'',[t]):l(t)))}_normalizeHeaderKey(t){return t=(t||'').toString().replace(/\r?\n|\r/g,' ').trim().toLowerCase().replace(/^X-SMTPAPI$|^(MIME|DKIM|ARC|BIMI)\b|^[a-z]|-(SPF|FBL|ID|MD5)$|-[a-z]/gi,t=>t.toUpperCase()).replace(/^Content-Features$/i,'Content-features')}_handleContentType(t){this.contentType=t.value.trim().toLowerCase(),this.multipart=!!/^multipart\//i.test(this.contentType)&&this.contentType.substr(this.contentType.indexOf('/')+1),this.multipart?this.boundary=t.params.boundary=t.params.boundary||this.boundary||this._generateBoundary():this.boundary=!1}_generateBoundary(){return this.rootNode.boundaryPrefix+'-'+this.rootNode.baseBoundary+'-Part_'+this._nodeId}_encodeHeaderValue(t,s){switch(t=this._normalizeHeaderKey(t)){case'From':case'Sender':case'To':case'Cc':case'Bcc':case'Reply-To':return this._convertAddresses(this._parseAddresses(s));case'Message-ID':case'In-Reply-To':case'Content-Id':return'<'!==(s=(s||'').toString().replace(/\r?\n|\r/g,' ')).charAt(0)&&(s='<'+s),'>'!==s.charAt(s.length-1)&&(s+='>'),s;case'References':return(s=[].concat.apply([],[].concat(s||'').map(t=>(t=(t||'').toString().replace(/\r?\n|\r/g,' ').trim()).replace(/<[^>]*>/g,t=>t.replace(/\s/g,'')).split(/\s+/))).map(t=>('<'!==t.charAt(0)&&(t='<'+t),'>'!==t.charAt(t.length-1)&&(t+='>'),t))).join(' ').trim();case'Date':return'[object Date]'===Object.prototype.toString.call(s)?s.toUTCString().replace(/GMT/,'+0000'):(s=(s||'').toString().replace(/\r?\n|\r/g,' '),this._encodeWords(s));case'Content-Type':case'Content-Disposition':return(s||'').toString().replace(/\r?\n|\r/g,' ');default:return s=(s||'').toString().replace(/\r?\n|\r/g,' '),this._encodeWords(s)}}_convertAddresses(t,s){let n=[];return s=s||[],[].concat(t||[]).forEach(t=>{if(t.address)t.address=this._normalizeAddress(t.address),t.name?t.name&&n.push(`${this._encodeAddressName(t.name)} <${t.address}>`):n.push(t.address.indexOf(' ')>=0?`<${t.address}>`:`${t.address}`),t.address&&(s.filter(s=>s.address===t.address).length||s.push(t));else if(t.group){let i=(t.group.length?this._convertAddresses(t.group,s):'').trim();n.push(`${this._encodeAddressName(t.name)}:${i};`)}}),n.join(', ')}_normalizeAddress(t){let s=(t=(t||'').toString().replace(/[\x00-\x1F<>]+/g,' ').trim()).lastIndexOf('@');if(s<0)return t;let i,o=t.substr(0,s),a=t.substr(s+1);try{i=n.toASCII(a.toLowerCase())}catch(t){}return o.indexOf(' ')>=0&&('"'!==o.charAt(0)&&(o='"'+o),'"'!==o.substr(-1)&&(o+='"')),`${o}@${i}`}_encodeAddressName(t){return/^[\w ]*$/.test(t)?t:/^[\x20-\x7e]*$/.test(t)?'"'+t.replace(/([\\"])/g,'\\$1')+'"':a.encodeWord(t,this._getTextEncoding(t),52)}_encodeWords(t){return a.encodeWords(t,this._getTextEncoding(t),52,!0)}_getTextEncoding(t){t=(t||'').toString();let s,n,i=this.textEncoding;return i||(n=(t.match(/[\x00-\x08\x0B\x0C\x0E-\x1F\u0080-\uFFFF]/g)||[]).length,s=(t.match(/[a-z]/gi)||[]).length,i=n<s?'Q':'B'),i}_generateMessageId(){return'<'+[2,2,2,6].reduce((s,n)=>s+'-'+t.randomBytes(n).toString('hex'),t.randomBytes(4).toString('hex'))+'@'+(this.getEnvelope().from||this.hostname||'localhost').split('@').pop()+'>'}}m.exports=y},7128,[4791,4907,7129,4793,7121,7130,7132,7131,7133,7122,7134,7135,7136]);
__d(function(g,r,_i,a,_m,e,d){'use strict';const t=2147483647,n=36,o=/^xn--/,c=/[^\0-\x7F]/,i=/[\x2E\u3002\uFF0E\uFF61]/g,s={overflow:'Overflow: input needs wider integers to process','not-basic':'Illegal input >= 0x80 (not a basic code point)','invalid-input':'Invalid input'},u=Math.floor,f=String.fromCharCode;function l(t){throw new RangeError(s[t])}function h(t,n){const o=[];let c=t.length;for(;c--;)o[c]=n(t[c]);return o}function p(t,n){const o=t.split('@');let c='';o.length>1&&(c=o[0]+'@',t=o[1]);return c+h((t=t.replace(i,'.')).split('.'),n).join('.')}function v(t){const n=[];let o=0;const c=t.length;for(;o<c;){const i=t.charCodeAt(o++);if(i>=55296&&i<=56319&&o<c){const c=t.charCodeAt(o++);56320==(64512&c)?n.push(((1023&i)<<10)+(1023&c)+65536):(n.push(i),o--)}else n.push(i)}return n}const w=function(t){return t>=48&&t<58?t-48+26:t>=65&&t<91?t-65:t>=97&&t<123?t-97:n},C=function(t,n){return t+22+75*(t<26)-((0!=n)<<5)},x=function(t,o,c){let i=0;for(t=c?u(t/700):t>>1,t+=u(t/o);t>455;i+=n)t=u(t/35);return u(i+36*t/(t+38))},A=function(o){const c=[],i=o.length;let s=0,f=128,h=72,p=o.lastIndexOf("-");p<0&&(p=0);for(let t=0;t<p;++t)o.charCodeAt(t)>=128&&l('not-basic'),c.push(o.charCodeAt(t));for(let v=p>0?p+1:0;v<i;){const p=s;for(let c=1,f=n;;f+=n){v>=i&&l('invalid-input');const p=w(o.charCodeAt(v++));p>=n&&l('invalid-input'),p>u((t-s)/c)&&l('overflow'),s+=p*c;const C=f<=h?1:f>=h+26?26:f-h;if(p<C)break;const x=n-C;c>u(t/x)&&l('overflow'),c*=x}const C=c.length+1;h=x(s-p,C,0==p),u(s/C)>t-f&&l('overflow'),f+=u(s/C),s%=C,c.splice(s++,0,f)}return String.fromCodePoint(...c)},b=function(o){const c=[],i=(o=v(o)).length;let s=128,h=0,p=72;for(const t of o)t<128&&c.push(f(t));const w=c.length;let A=w;for(w&&c.push("-");A<i;){let i=t;for(const t of o)t>=s&&t<i&&(i=t);const v=A+1;i-s>u((t-h)/v)&&l('overflow'),h+=(i-s)*v,s=i;for(const i of o)if(i<s&&++h>t&&l('overflow'),i===s){let t=h;for(let o=n;;o+=n){const i=o<=p?1:o>=p+26?26:o-p;if(t<i)break;const s=t-i,l=n-i;c.push(f(C(i+s%l,0))),t=u(s/l)}c.push(f(C(t,0))),p=x(h,v,A===w),h=0,++A}++h,++s}return c.join('')},F={version:'2.3.1',ucs2:{decode:v,encode:t=>String.fromCodePoint(...t)},decode:A,encode:b,toASCII:function(t){return p(t,function(t){return c.test(t)?'xn--'+b(t):t})},toUnicode:function(t){return p(t,function(t){return o.test(t)?A(t.slice(4).toLowerCase()):t})}};_m.exports=F},7129,[]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]),n=r(d[1]),s=r(d[2]);m.exports={isPlainText:(t,n)=>'string'==typeof t&&!(n?/[\x00-\x08\x0b\x0c\x0e-\x1f"\u0080-\uFFFF]/:/[\x00-\x08\x0b\x0c\x0e-\x1f\u0080-\uFFFF]/).test(t),hasLongerLines:(t,n)=>t.length>131072||new RegExp('^.{'+(n+1)+',}','m').test(t),encodeWord(s,l,i){let h;if((i=i||0)&&i>12&&(i-=12),'Q'===(l=(l||'Q').toString().toUpperCase().trim().charAt(0))?h=n.encode(s).replace(/[^a-z0-9!*+\-/=]/gi,t=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return' '===t?'_':'='+(1===n.length?'0'+n:n)}):'B'===l&&(h='string'==typeof s?s:t.encode(s),i=i?Math.max(3,(i-i%4)/4*3):0),i&&('B'!==l?h:t.encode(s)).length>i)if('Q'===l)h=this.splitMimeEncodedString(h,i).join("?= =?UTF-8?"+l+'?');else{let n=[],s='';for(let l=0,o=h.length;l<o;l++){let u=h.charAt(l);/[\ud83c\ud83d\ud83e]/.test(u)&&l<o-1&&(u+=h.charAt(++l)),Buffer.byteLength(s+u)<=i||0===l?s+=u:(n.push(t.encode(s)),s=u)}s&&n.push(t.encode(s)),h=n.length>1?n.join("?= =?UTF-8?"+l+'?'):n.join('')}else'B'===l&&(h=t.encode(s));return"=?UTF-8?"+l+'?'+h+('?='===h.substr(-2)?'':'?=')},encodeWords(t,n,s,l){let i;s=s||0;let h=t.match(/(?:^|\s)([^\s]*["\u0080-\uFFFF])/);if(!h)return t;if(l)return this.encodeWord(t,n,s);let o=t.match(/(["\u0080-\uFFFF][^\s]*)[^"\u0080-\uFFFF]*$/);if(!o)return t;let u=h.index+(h[0].match(/[^\s]/)||{index:0}).index,c=o.index+(o[1]||'').length;return i=(u?t.substr(0,u):'')+this.encodeWord(t.substring(u,c),n||'Q',s)+(c<t.length?t.substr(c):''),i},buildHeaderValue(t){let n=[];return Object.keys(t.params||{}).forEach(s=>{let l=t.params[s];!this.isPlainText(l,!0)||l.length>=75?this.buildHeaderParam(s,l,50).forEach(t=>{/[\s"\\;:/=(),<>@[\]?]|^[-']|'$/.test(t.value)&&'*'!==t.key.substr(-1)?n.push(t.key+'='+JSON.stringify(t.value)):n.push(t.key+'='+t.value)}):/[\s'"\\;:/=(),<>@[\]?]|^-/.test(l)?n.push(s+'='+JSON.stringify(l)):n.push(s+'='+l)}),t.value+(n.length?'; '+n.join('; '):'')},buildHeaderParam(t,n,s){let l,i,h,o,u,c,p=[],f='string'==typeof n?n:(n||'').toString(),F=0;if(s=s||50,this.isPlainText(n,!0)){if(f.length<=s)return[{key:t,value:f}];f=f.replace(new RegExp('.{'+s+'}','g'),t=>(p.push({line:t}),'')),f&&p.push({line:f})}else{if(/[\uD800-\uDBFF]/.test(f)){for(l=[],u=0,c=f.length;u<c;u++)i=f.charAt(u),h=i.charCodeAt(0),h>=55296&&h<=56319&&u<c-1?(i+=f.charAt(u+1),l.push(i),u++):l.push(i);f=l}o="utf-8''";let t=!0;for(F=0,u=0,c=f.length;u<c;u++){if(i=f[u],t)i=this.safeEncodeURIComponent(i);else if(i=' '===i?i:this.safeEncodeURIComponent(i),i!==f[u]){if(!((this.safeEncodeURIComponent(o)+i).length>=s)){t=!0,u=F,o='';continue}p.push({line:o,encoded:t}),o='',F=u-1}(o+i).length>=s?(p.push({line:o,encoded:t}),o=i=' '===f[u]?' ':this.safeEncodeURIComponent(f[u]),i===f[u]?(t=!1,F=u-1):t=!0):o+=i}o&&p.push({line:o,encoded:t})}return p.map((n,s)=>({key:t+'*'+s+(n.encoded?'*':''),value:n.line}))},parseHeaderValue(t){let n,s={value:!1,params:{}},l=!1,i='',h='value',o=!1,u=!1;for(let c=0,p=t.length;c<p;c++)if(n=t.charAt(c),'key'===h){if('='===n){l=i.trim().toLowerCase(),h='value',i='';continue}i+=n}else{if(u)i+=n;else{if('\\'===n){u=!0;continue}o&&n===o?o=!1:o||'"'!==n?o||';'!==n?i+=n:(!1===l?s.value=i.trim():s.params[l]=i.trim(),h='key',i=''):o=n}u=!1}return'value'===h?!1===l?s.value=i.trim():s.params[l]=i.trim():i.trim()&&(s.params[i.trim().toLowerCase()]=''),Object.keys(s.params).forEach(t=>{let n,l,i,h;(i=t.match(/(\*(\d+)|\*(\d+)\*|\*)$/))&&(n=t.substr(0,i.index),l=Number(i[2]||i[3])||0,s.params[n]&&'object'==typeof s.params[n]||(s.params[n]={charset:!1,values:[]}),h=s.params[t],0===l&&'*'===i[0].substr(-1)&&(i=h.match(/^([^']*)'[^']*'(.*)$/))&&(s.params[n].charset=i[1]||'iso-8859-1',h=i[2]),s.params[n].values[l]=h,delete s.params[t])}),Object.keys(s.params).forEach(t=>{let n;s.params[t]&&Array.isArray(s.params[t].values)&&(n=s.params[t].values.map(t=>t||'').join(''),s.params[t].charset?s.params[t]='=?'+s.params[t].charset+'?Q?'+n.replace(/[=?_\s]/g,t=>{let n=t.charCodeAt(0).toString(16);return' '===t?'_':'%'+(n.length<2?'0':'')+n}).replace(/%/g,'=')+'?=':s.params[t]=n)}),s},detectExtension:t=>s.detectExtension(t),detectMimeType:t=>s.detectMimeType(t),foldLines(t,n,s){n=n||76;let l,i,h=0,o=(t=(t||'').toString()).length,u='';for(;h<o;){if(l=t.substr(h,n),l.length<n){u+=l;break}(i=l.match(/^[^\n\r]*(\r?\n|\r)/))?(l=i[0],u+=l,h+=l.length):((i=l.match(/(\s+)[^\s]*$/))&&i[0].length-(s?(i[1]||'').length:0)<l.length?l=l.substr(0,l.length-(i[0].length-(s?(i[1]||'').length:0))):(i=t.substr(h+l.length).match(/^[^\s]+(\s*)/))&&(l+=i[0].substr(0,i[0].length-(s?0:(i[1]||'').length))),u+=l,h+=l.length,h<o&&(u+='\r\n'))}return u},splitMimeEncodedString:(t,n)=>{let s,l,i,h,o=[];for(n=Math.max(n||0,12);t.length;){for(s=t.substr(0,n),(l=s.match(/[=][0-9A-F]?$/i))&&(s=s.substr(0,l.index)),h=!1;!h;)h=!0,(l=t.substr(s.length).match(/^[=]([0-9A-F]{2})/i))&&(i=parseInt(l[1],16),i<194&&i>127&&(s=s.substr(0,s.length-3),h=!1));s.length&&o.push(s),t=t.substr(s.length)}return o},encodeURICharComponent:t=>{let n='',s=t.charCodeAt(0).toString(16).toUpperCase();if(s.length%2&&(s='0'+s),s.length>2)for(let t=0,l=s.length/2;t<l;t++)n+='%'+s.substr(t,2);else n+='%'+s;return n},safeEncodeURIComponent(t){t=(t||'').toString();try{t=encodeURIComponent(t)}catch(n){return t.replace(/[^\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]+/g,'')}return t.replace(/[\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]/g,t=>this.encodeURICharComponent(t))}}},7130,[7131,7132,7126]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]).Transform;function n(t){return'string'==typeof t&&(t=Buffer.from(t,'utf-8')),t.toString('base64')}function s(t,n){if(n=n||76,(t=(t||'').toString()).length<=n)return t;let s=[],h=0,u=1024*n;for(;h<t.length;){let o=t.substr(h,u).replace(new RegExp('.{'+n+'}','g'),'$&\r\n');s.push(o),h+=u}return s.join('')}m.exports={encode:n,wrap:s,Encoder:class extends t{constructor(t){super(),this.options=t||{},!1!==this.options.lineLength&&(this.options.lineLength=this.options.lineLength||76),this._curLine='',this._remainingBytes=!1,this.inputBytes=0,this.outputBytes=0}_transform(t,h,u){if('buffer'!==h&&(t=Buffer.from(t,h)),!t||!t.length)return setImmediate(u);this.inputBytes+=t.length,this._remainingBytes&&this._remainingBytes.length&&(t=Buffer.concat([this._remainingBytes,t],this._remainingBytes.length+t.length),this._remainingBytes=!1),t.length%3?(this._remainingBytes=t.slice(t.length-t.length%3),t=t.slice(0,t.length-t.length%3)):this._remainingBytes=!1;let o=this._curLine+n(t);if(this.options.lineLength){o=s(o,this.options.lineLength);let t=o.lastIndexOf('\n');t<0?(this._curLine=o,o=''):(this._curLine=o.substring(t+1),o=o.substring(0,t+1),o&&!o.endsWith('\r\n')&&(o+='\r\n'))}else this._curLine='';o&&(this.outputBytes+=o.length,this.push(Buffer.from(o,'ascii'))),setImmediate(u)}_flush(t){this._remainingBytes&&this._remainingBytes.length&&(this._curLine+=n(this._remainingBytes)),this._curLine&&(this.outputBytes+=this._curLine.length,this.push(Buffer.from(this._curLine,'ascii')),this._curLine=''),t()}}}},7131,[4793]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]).Transform;function n(t){'string'==typeof t&&(t=Buffer.from(t,'utf-8'));let n,s=[[9],[10],[13],[32,60],[62,126]],i='';for(let l=0,u=t.length;l<u;l++)n=t[l],h(n,s)&&(32!==n&&9!==n||l!==u-1&&10!==t[l+1]&&13!==t[l+1])?i+=String.fromCharCode(n):i+='='+(n<16?'0':'')+n.toString(16).toUpperCase();return i}function s(t,n){if(n=n||76,(t=(t||'').toString()).length<=n)return t;let s,h,i,l=0,u=t.length,o=Math.floor(n/3),f='';for(;l<u;)if(i=t.substr(l,n),s=i.match(/\r\n/))i=i.substr(0,s.index+s[0].length),f+=i,l+=i.length;else if('\n'!==i.substr(-1))if(s=i.substr(-o).match(/\n.*?$/))i=i.substr(0,i.length-(s[0].length-1)),f+=i,l+=i.length;else{if(i.length>n-o&&(s=i.substr(-o).match(/[ \t.,!?][^ \t.,!?]*$/)))i=i.substr(0,i.length-(s[0].length-1));else if(i.match(/[=][\da-f]{0,2}$/i))for((s=i.match(/[=][\da-f]{0,1}$/i))&&(i=i.substr(0,i.length-s[0].length));i.length>3&&i.length<u-l&&!i.match(/^(?:=[\da-f]{2}){1,4}$/i)&&(s=i.match(/[=][\da-f]{2}$/gi))&&(h=parseInt(s[0].substr(1,2),16),!(h<128))&&(i=i.substr(0,i.length-3),!(h>=192)););l+i.length<u&&'\n'!==i.substr(-1)?(i.length===n&&i.match(/[=][\da-f]{2}$/i)?i=i.substr(0,i.length-3):i.length===n&&(i=i.substr(0,i.length-1)),l+=i.length,i+='=\r\n'):l+=i.length,f+=i}else f+=i,l+=i.length;return f}function h(t,n){for(let s=n.length-1;s>=0;s--)if(n[s].length){if(1===n[s].length&&t===n[s][0])return!0;if(2===n[s].length&&t>=n[s][0]&&t<=n[s][1])return!0}return!1}m.exports={encode:n,wrap:s,Encoder:class extends t{constructor(t){super(),this.options=t||{},!1!==this.options.lineLength&&(this.options.lineLength=this.options.lineLength||76),this._curLine='',this.inputBytes=0,this.outputBytes=0}_transform(t,h,i){let l;if('buffer'!==h&&(t=Buffer.from(t,h)),!t||!t.length)return i();this.inputBytes+=t.length,this.options.lineLength?(l=this._curLine+n(t),l=s(l,this.options.lineLength),l=l.replace(/(^|\n)([^\n]*)$/,(t,n,s)=>(this._curLine=s,n)),l&&(this.outputBytes+=l.length,this.push(l))):(l=n(t),this.outputBytes+=l.length,this.push(l,'ascii')),i()}_flush(t){this._curLine&&(this.outputBytes+=this._curLine.length,this.push(this._curLine,'ascii')),t()}}}},7132,[4793]);
__d(function(g,r,_i,a,m,e,d){'use strict';function t(t){let s,o,i,h=!1,l='text',u=[],c={address:[],comment:[],group:[],text:[],textWasQuoted:[]},p=!1;for(o=0,i=t.length;o<i;o++){let s=t[o],n=o?t[o-1]:null;if('operator'===s.type)switch(s.value){case'<':l='address',p=!1;break;case'(':l='comment',p=!1;break;case':':l='group',h=!0,p=!1;break;case'"':p=!p,l='text';break;default:l='text',p=!1}else s.value&&('address'===l&&(s.value=s.value.replace(/^[^<]*<\s*/,'')),n&&n.noBreak&&c[l].length?(c[l][c[l].length-1]+=s.value,'text'===l&&p&&(c.textWasQuoted[c.textWasQuoted.length-1]=!0)):(c[l].push(s.value),'text'===l&&c.textWasQuoted.push(p)))}if(!c.text.length&&c.comment.length&&(c.text=c.comment,c.comment=[]),h){c.text=c.text.join(' ');let t=[];if(c.group.length){n(c.group.join(',')).forEach(s=>{s.group?t=t.concat(s.group):t.push(s)})}u.push({name:c.text||s&&s.name,group:t})}else{if(!c.address.length&&c.text.length){for(o=c.text.length-1;o>=0;o--)if(!c.textWasQuoted[o]&&c.text[o].match(/^[^@\s]+@[^@\s]+$/)){c.address=c.text.splice(o,1),c.textWasQuoted.splice(o,1);break}let t=function(t){return c.address.length?t:(c.address=[t.trim()],' ')};if(!c.address.length)for(o=c.text.length-1;o>=0&&(c.textWasQuoted[o]||(c.text[o]=c.text[o].replace(/\s*\b[^@\s]+@[^\s]+\b\s*/,t).trim(),!c.address.length));o--);}if(!c.text.length&&c.comment.length&&(c.text=c.comment,c.comment=[]),c.address.length>1&&(c.text=c.text.concat(c.address.splice(1))),c.text=c.text.join(' '),c.address=c.address.join(' '),!c.address&&h)return[];s={address:c.address||c.text||'',name:c.text||c.address||''},s.address===s.name&&((s.address||'').match(/@/)?s.name='':s.address=''),u.push(s)}return u}class s{constructor(t){this.str=(t||'').toString(),this.operatorCurrent='',this.operatorExpecting='',this.node=null,this.escaped=!1,this.list=[],this.operators={'"':'"','(':')','<':'>',',':'',':':';',';':''}}tokenize(){let t=[];for(let t=0,s=this.str.length;t<s;t++){let n=this.str.charAt(t),o=t<s-1?this.str.charAt(t+1):null;this.checkChar(n,o)}return this.list.forEach(s=>{s.value=(s.value||'').toString().trim(),s.value&&t.push(s)}),t}checkChar(t,s){if(this.escaped);else{if(t===this.operatorExpecting)return this.node={type:'operator',value:t},s&&![' ','\t','\r','\n',',',';'].includes(s)&&(this.node.noBreak=!0),this.list.push(this.node),this.node=null,this.operatorExpecting='',void(this.escaped=!1);if(!this.operatorExpecting&&t in this.operators)return this.node={type:'operator',value:t},this.list.push(this.node),this.node=null,this.operatorExpecting=this.operators[t],void(this.escaped=!1);if(['"',"'"].includes(this.operatorExpecting)&&'\\'===t)return void(this.escaped=!0)}this.node||(this.node={type:'text',value:''},this.list.push(this.node)),'\n'===t&&(t=' '),(t.charCodeAt(0)>=33||[' ','\t'].includes(t))&&(this.node.value+=t),this.escaped=!1}}function n(n,o){o=o||{};let i=new s(n).tokenize(),h=[],l=[],u=[];if(i.forEach(t=>{'operator'!==t.type||','!==t.value&&';'!==t.value?l.push(t):(l.length&&h.push(l),l=[])}),l.length&&h.push(l),h.forEach(s=>{(s=t(s)).length&&(u=u.concat(s))}),o.flatten){let t=[],s=n=>{n.forEach(n=>{if(n.group)return s(n.group);t.push(n)})};return s(u),t}return u}m.exports=n},7133,[]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]).Transform;m.exports=class extends t{constructor(){super(),this.lastByte=!1}_transform(t,s,h){t.length&&(this.lastByte=t[t.length-1]),this.push(t),h()}_flush(t){return 10===this.lastByte?t():13===this.lastByte?(this.push(Buffer.from('\n')),t()):(this.push(Buffer.from('\r\n')),t())}}},7134,[4793]);
__d(function(g,r,_i,a,m,e,d){'use strict';const s=r(d[0]).Transform;m.exports=class extends s{constructor(s){super(s),this.options=s||{},this.lastByte=!1}_transform(s,t,h){let i,n=0;for(let t=0,h=s.length;t<h;t++)10===s[t]&&(t&&13!==s[t-1]||!t&&13!==this.lastByte)&&(t>n&&(i=s.slice(n,t),this.push(i)),this.push(Buffer.from('\r\n')),n=t+1);n&&n<s.length?(i=s.slice(n),this.push(i)):n||this.push(s),this.lastByte=s[s.length-1],h()}}},7135,[4793]);
__d(function(g,r,_i,a,m,e,d){'use strict';const s=r(d[0]).Transform;m.exports=class extends s{constructor(s){super(s),this.options=s||{}}_transform(s,t,n){let o,h=0;for(let t=0,n=s.length;t<n;t++)13===s[t]&&(o=s.slice(h,t),h=t+1,this.push(o));h&&h<s.length?(o=s.slice(h),this.push(o)):h||this.push(s),n()}}},7136,[4793]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]),s=r(d[1]),h=r(d[2]),o=r(d[3]).PassThrough,n=r(d[4]),c=r(d[5]),u=r(d[6]);class l{constructor(t,s,h,o){this.options=t||{},this.keys=s,this.cacheTreshold=Number(this.options.cacheTreshold)||2097152,this.hashAlgo=this.options.hashAlgo||"sha256",this.cacheDir=this.options.cacheDir||!1,this.chunks=[],this.chunklen=0,this.readPos=0,this.cachePath=!!this.cacheDir&&c.join(this.cacheDir,'message.'+Date.now()+'-'+u.randomBytes(14).toString('hex')),this.cache=!1,this.headers=!1,this.bodyHash=!1,this.parser=!1,this.relaxedBody=!1,this.input=h,this.output=o,this.output.usingCache=!1,this.hasErrored=!1,this.input.on('error',t=>{this.hasErrored=!0,this.cleanup(),o.emit('error',t)})}cleanup(){this.cache&&this.cachePath&&n.unlink(this.cachePath,()=>!1)}createReadCache(){this.cache=n.createReadStream(this.cachePath),this.cache.once('error',t=>{this.cleanup(),this.output.emit('error',t)}),this.cache.once('close',()=>{this.cleanup()}),this.cache.pipe(this.output)}sendNextChunk(){if(this.hasErrored)return;if(this.readPos>=this.chunks.length)return this.cache?this.createReadCache():this.output.end();let t=this.chunks[this.readPos++];if(!1===this.output.write(t))return this.output.once('drain',()=>{this.sendNextChunk()});setImmediate(()=>this.sendNextChunk())}sendSignedOutput(){let t=0,s=()=>{if(t>=this.keys.length)return this.output.write(this.parser.rawHeaders),setImmediate(()=>this.sendNextChunk());let o=this.keys[t++],n=h(this.headers,this.hashAlgo,this.bodyHash,{domainName:o.domainName,keySelector:o.keySelector,privateKey:o.privateKey,headerFieldNames:this.options.headerFieldNames,skipFields:this.options.skipFields});return n&&this.output.write(Buffer.from(n+'\r\n')),setImmediate(s)};if(this.bodyHash&&this.headers)return s();this.output.write(this.parser.rawHeaders),this.sendNextChunk()}createWriteCache(){this.output.usingCache=!0,this.cache=n.createWriteStream(this.cachePath),this.cache.once('error',t=>{this.cleanup(),this.relaxedBody.unpipe(this.cache),this.relaxedBody.on('readable',()=>{for(;null!==this.relaxedBody.read(););}),this.hasErrored=!0,this.output.emit('error',t)}),this.cache.once('close',()=>{this.sendSignedOutput()}),this.relaxedBody.removeAllListeners('readable'),this.relaxedBody.pipe(this.cache)}signStream(){this.parser=new t,this.relaxedBody=new s({hashAlgo:this.hashAlgo}),this.parser.on('headers',t=>{this.headers=t}),this.relaxedBody.on('hash',t=>{this.bodyHash=t}),this.relaxedBody.on('readable',()=>{let t;if(!this.cache)for(;null!==(t=this.relaxedBody.read());)if(this.chunks.push(t),this.chunklen+=t.length,this.chunklen>=this.cacheTreshold&&this.cachePath)return this.createWriteCache()}),this.relaxedBody.on('end',()=>{this.cache||this.sendSignedOutput()}),this.parser.pipe(this.relaxedBody),setImmediate(()=>this.input.pipe(this.parser))}}m.exports=class{constructor(t){this.options=t||{},this.keys=[].concat(this.options.keys||{domainName:t.domainName,keySelector:t.keySelector,privateKey:t.privateKey})}sign(t,s){let h=new o,n=t,c=!1;Buffer.isBuffer(t)?(c=t,n=new o):'string'==typeof t&&(c=Buffer.from(t),n=new o);let u=this.options;s&&Object.keys(s).length&&(u={},Object.keys(this.options||{}).forEach(t=>{u[t]=this.options[t]}),Object.keys(s||{}).forEach(t=>{t in u||(u[t]=s[t])}));let p=new l(u,this.keys,n,h);return setImmediate(()=>{p.signStream(),c&&setImmediate(()=>{n.end(c)})}),h}}},7137,[7138,7139,7140,4793,4907,4908,4791]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]).Transform;m.exports=class extends t{constructor(t){super(t),this.lastBytes=Buffer.alloc(4),this.headersParsed=!1,this.headerBytes=0,this.headerChunks=[],this.rawHeaders=!1,this.bodySize=0}updateLastBytes(t){let s=this.lastBytes.length,h=Math.min(t.length,s);for(let t=0,i=s-h;t<i;t++)this.lastBytes[t]=this.lastBytes[t+h];for(let i=1;i<=h;i++)this.lastBytes[s-i]=t[t.length-i]}checkHeaders(t){if(this.headersParsed)return!0;let s=this.lastBytes.length,h=0;this.curLinePos=0;for(let i=0,l=this.lastBytes.length+t.length;i<l;i++){let l;if(l=i<s?this.lastBytes[i]:t[i-s],10===l&&i){let l=i-1<s?this.lastBytes[i-1]:t[i-1-s],n=i>1&&(i-2<s?this.lastBytes[i-2]:t[i-2-s]);if(10===l){this.headersParsed=!0,h=i-s+1,this.headerBytes+=h;break}if(13===l&&10===n){this.headersParsed=!0,h=i-s+1,this.headerBytes+=h;break}}}if(this.headersParsed){if(this.headerChunks.push(t.slice(0,h)),this.rawHeaders=Buffer.concat(this.headerChunks,this.headerBytes),this.headerChunks=null,this.emit('headers',this.parseHeaders()),t.length-1>h){let s=t.slice(h);this.bodySize+=s.length,setImmediate(()=>this.push(s))}return!1}return this.headerBytes+=t.length,this.headerChunks.push(t),this.updateLastBytes(t),!1}_transform(t,s,h){if(!t||!t.length)return h();let i;'string'==typeof t&&(t=Buffer.from(t,s));try{i=this.checkHeaders(t)}catch(t){return h(t)}i&&(this.bodySize+=t.length,this.push(t)),setImmediate(h)}_flush(t){if(this.headerChunks){let t=Buffer.concat(this.headerChunks,this.headerBytes);this.bodySize+=t.length,this.push(t),this.headerChunks=null}t()}parseHeaders(){let t=(this.rawHeaders||'').toString().split(/\r?\n/);for(let s=t.length-1;s>0;s--)/^\s/.test(t[s])&&(t[s-1]+='\n'+t[s],t.splice(s,1));return t.filter(t=>t.trim()).map(t=>({key:t.substr(0,t.indexOf(':')).trim().toLowerCase(),line:t}))}}},7138,[4793]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]).Transform,i=r(d[1]);m.exports=class extends t{constructor(t){super(),t=t||{},this.chunkBuffer=[],this.chunkBufferLen=0,this.bodyHash=i.createHash(t.hashAlgo||'sha1'),this.remainder='',this.byteLength=0,this.debug=t.debug,this._debugBody=!!t.debug&&[]}updateHash(t){let i,s='',h='file';for(let i=t.length-1;i>=0;i--){let n=t[i];if('file'!==h||10!==n&&13!==n)if('file'!==h||9!==n&&32!==n)if('line'!==h||9!==n&&32!==n){if(('file'===h||'line'===h)&&(h='body',i===t.length-1))break}else;else h='line';else;if(0===i){if('file'===h&&(!this.remainder||/[\r\n]$/.test(this.remainder))||'line'===h&&(!this.remainder||/[ \t]$/.test(this.remainder)))return void(this.remainder+=t.toString('binary'));if('line'===h||'file'===h){s=t.toString('binary'),t=!1;break}}if('body'===h){s=t.slice(i+1).toString('binary'),t=t.slice(0,i+1);break}}let n=!!this.remainder;if(t&&!n)for(let i=0,s=t.length;i<s;i++){if(i&&10===t[i]&&13!==t[i-1]){n=!0;break}if(i&&13===t[i]&&32===t[i-1]){n=!0;break}if(i&&32===t[i]&&32===t[i-1]){n=!0;break}if(9===t[i]){n=!0;break}}n?(i=this.remainder+(t?t.toString('binary'):''),this.remainder=s,i=i.replace(/\r?\n/g,'\n').replace(/[ \t]*$/gm,'').replace(/[ \t]+/gm,' ').replace(/\n/g,'\r\n'),t=Buffer.from(i,'binary')):s&&(this.remainder=s),this.debug&&this._debugBody.push(t),this.bodyHash.update(t)}_transform(t,i,s){if(!t||!t.length)return s();'string'==typeof t&&(t=Buffer.from(t,i)),this.updateHash(t),this.byteLength+=t.length,this.push(t),s()}_flush(t){/[\r\n]$/.test(this.remainder)&&this.byteLength>2&&this.bodyHash.update(Buffer.from('\r\n')),this.byteLength||this.push(Buffer.from('\r\n')),this.emit('hash',this.bodyHash.digest('base64'),!!this.debug&&Buffer.concat(this._debugBody)),t()}}},7139,[4793,4791]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]),s=r(d[1]),n=r(d[2]);function i(n,i,o,c,l){let p=['v=1','a=rsa-'+c,'c=relaxed/relaxed','d='+t.toASCII(n),'q=dns/txt','s='+i,'bh='+l,'h='+o].join('; ');return s.foldLines('DKIM-Signature: '+p,76)+';\r\n b='}function o(t,s,n){let i=new Set,o=new Set,l=new Map;(n||'').toLowerCase().split(':').forEach(t=>{o.add(t.trim())}),(s||'').toLowerCase().split(':').filter(t=>!o.has(t.trim())).forEach(t=>{i.add(t.trim())});for(let s=t.length-1;s>=0;s--){let n=t[s];i.has(n.key)&&!l.has(n.key)&&l.set(n.key,c(n.line))}let p=[],u=[];return i.forEach(t=>{l.has(t)&&(u.push(t),p.push(t+':'+l.get(t)))}),{headers:p.join('\r\n')+'\r\n',fieldNames:u.join(':')}}function c(t){return t.substr(t.indexOf(':')+1).replace(/\r?\n/g,'').replace(/\s+/g,' ').trim()}m.exports=(t,s,l,p)=>{let u,h,f=o(t,(p=p||{}).headerFieldNames||"From:Sender:Reply-To:Subject:Date:Message-ID:To:Cc:MIME-Version:Content-Type:Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:List-Id:List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive",p.skipFields),C=i(p.domainName,p.keySelector,f.fieldNames,s,l);f.headers+='dkim-signature:'+c(C),u=n.createSign(('rsa-'+s).toUpperCase()),u.update(f.headers);try{h=u.sign(p.privateKey,'base64')}catch(t){return!1}return C+h.replace(/(^.{73}|.{75}(?!\r?\n|\r))/g,'$&\r\n ').trim()},m.exports.relaxedHeaders=o},7140,[7129,7130,4791]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]),o=r(d[1]),n=r(d[2]);m.exports=function s(c,u,h,f){let l,p,b,y=n.parse(c);l={host:y.hostname,port:Number(y.port)?Number(y.port):'https:'===y.protocol?443:80},'https:'===y.protocol?(l.rejectUnauthorized=!1,p=o.connect.bind(o)):p=t.connect.bind(t);let T=!1,x=t=>{if(!T){T=!0;try{b.destroy()}catch(t){}f(t)}},E=()=>{let t=new Error('Proxy socket timed out');t.code='ETIMEDOUT',x(t)};b=p(l,()=>{if(T)return;let t={Host:h+':'+u,Connection:'close'};y.auth&&(t['Proxy-Authorization']='Basic '+Buffer.from(y.auth).toString('base64')),b.write('CONNECT '+h+':'+u+' HTTP/1.1\r\n'+Object.keys(t).map(o=>o+': '+t[o]).join('\r\n')+'\r\n\r\n');let o='',n=t=>{let s,c;if(!T&&(o+=t.toString('binary'),s=o.match(/\r\n\r\n/))){if(b.removeListener('data',n),c=o.substr(s.index+s[0].length),o=o.substr(0,s.index),c&&b.unshift(Buffer.from(c,'binary')),T=!0,s=o.match(/^HTTP\/\d+\.\d+ (\d+)/i),!s||'2'!==(s[1]||'').charAt(0)){try{b.destroy()}catch(t){}return f(new Error('Invalid response from proxy'+(s&&': '+s[1]||'')))}return b.removeListener('error',x),b.removeListener('timeout',E),b.setTimeout(0),f(null,b)}};b.on('data',n)}),b.setTimeout(s.timeout||3e4),b.on('timeout',E),b.once('error',x)}},7141,[4898,4899,4900]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]),s=r(d[1]),i=r(d[2]);m.exports=class{constructor(t,s){this.mailer=t,this.data={},this.message=null,s=s||{};let i=t.options||{},n=t._defaults||{};Object.keys(s).forEach(t=>{this.data[t]=s[t]}),this.data.headers=this.data.headers||{},Object.keys(n).forEach(t=>{t in this.data?'headers'===t&&Object.keys(n.headers).forEach(t=>{t in this.data.headers||(this.data.headers[t]=n.headers[t])}):this.data[t]=n[t]}),['disableFileAccess','disableUrlAccess','normalizeHeaderKey'].forEach(t=>{t in i&&(this.data[t]=i[t])})}resolveContent(...s){return t.resolveContent(...s)}resolveAll(n){let o=[[this.data,'html'],[this.data,'text'],[this.data,'watchHtml'],[this.data,'amp'],[this.data,'icalEvent']];this.data.alternatives&&this.data.alternatives.length&&this.data.alternatives.forEach((t,s)=>{o.push([this.data.alternatives,s])}),this.data.attachments&&this.data.attachments.length&&this.data.attachments.forEach((t,s)=>{t.filename||(t.filename=(t.path||t.href||'').split('/').pop().split('?').shift()||'attachment-'+(s+1),t.filename.indexOf('.')<0&&(t.filename+='.'+i.detectExtension(t.contentType))),t.contentType||(t.contentType=i.detectMimeType(t.filename||t.path||t.href||'bin')),o.push([this.data.attachments,s])});let h=new s;['from','to','cc','bcc','sender','replyTo'].forEach(t=>{let s;this.message?s=[].concat(h._parseAddresses(this.message.getHeader('replyTo'===t?'reply-to':t))||[]):this.data[t]&&(s=[].concat(h._parseAddresses(this.data[t])||[])),s&&s.length?this.data[t]=s:t in this.data&&(this.data[t]=null)});['from','sender'].forEach(t=>{this.data[t]&&(this.data[t]=this.data[t].shift())});let l=0,c=()=>{if(l>=o.length)return n(null,this.data);let s=o[l++];if(!s[0]||!s[0][s[1]])return c();t.resolveContent(...s,(t,i)=>{if(t)return n(t);let o={content:i};s[0][s[1]]&&'object'==typeof s[0][s[1]]&&!Buffer.isBuffer(s[0][s[1]])&&Object.keys(s[0][s[1]]).forEach(t=>{t in o||['content','path','href','raw'].includes(t)||(o[t]=s[0][s[1]][t])}),s[0][s[1]]=o,c()})};setImmediate(()=>c())}normalize(t){let s=this.data.envelope||this.message.getEnvelope(),i=this.message.messageId();this.resolveAll((n,o)=>{if(n)return t(n);if(o.envelope=s,o.messageId=i,['html','text','watchHtml','amp'].forEach(t=>{o[t]&&o[t].content&&('string'==typeof o[t].content?o[t]=o[t].content:Buffer.isBuffer(o[t].content)&&(o[t]=o[t].content.toString()))}),o.icalEvent&&Buffer.isBuffer(o.icalEvent.content)&&(o.icalEvent.content=o.icalEvent.content.toString('base64'),o.icalEvent.encoding='base64'),o.alternatives&&o.alternatives.length&&o.alternatives.forEach(t=>{t&&t.content&&Buffer.isBuffer(t.content)&&(t.content=t.content.toString('base64'),t.encoding='base64')}),o.attachments&&o.attachments.length&&o.attachments.forEach(t=>{t&&t.content&&Buffer.isBuffer(t.content)&&(t.content=t.content.toString('base64'),t.encoding='base64')}),o.normalizedHeaders={},Object.keys(o.headers||{}).forEach(t=>{let s=[].concat(o.headers[t]||[]).shift();s=s&&s.value||s,s&&(['references','in-reply-to','message-id','content-id'].includes(t)&&(s=this.message._encodeHeaderValue(t,s)),o.normalizedHeaders[t]=s)}),o.list&&'object'==typeof o.list){this._getListHeaders(o.list).forEach(t=>{o.normalizedHeaders[t.key]=t.value.map(t=>t&&t.value||t).join(', ')})}return o.references&&(o.normalizedHeaders.references=this.message._encodeHeaderValue('references',o.references)),o.inReplyTo&&(o.normalizedHeaders['in-reply-to']=this.message._encodeHeaderValue('in-reply-to',o.inReplyTo)),t(null,o)})}setMailerHeader(){this.message&&this.data.xMailer&&this.message.setHeader('X-Mailer',this.data.xMailer)}setPriorityHeaders(){if(this.message&&this.data.priority)switch((this.data.priority||'').toString().toLowerCase()){case'high':this.message.setHeader('X-Priority','1 (Highest)'),this.message.setHeader('X-MSMail-Priority','High'),this.message.setHeader('Importance','High');break;case'low':this.message.setHeader('X-Priority','5 (Lowest)'),this.message.setHeader('X-MSMail-Priority','Low'),this.message.setHeader('Importance','Low')}}setListHeaders(){this.message&&this.data.list&&'object'==typeof this.data.list&&this.data.list&&'object'==typeof this.data.list&&this._getListHeaders(this.data.list).forEach(t=>{t.value.forEach(s=>{this.message.addHeader(t.key,s)})})}_getListHeaders(t){return Object.keys(t).map(s=>({key:'list-'+s.toLowerCase().trim(),value:[].concat(t[s]||[]).map(t=>({prepared:!0,foldLines:!0,value:[].concat(t||[]).map(t=>{if('string'==typeof t&&(t={url:t}),t&&t.url){if('id'===s.toLowerCase().trim()){let s=t.comment||'';return s=i.isPlainText(s)?'"'+s+'"':i.encodeWord(s),(t.comment?s+' ':'')+this._formatListUrl(t.url).replace(/^<[^:]+\/{,2}/,'')}let n=t.comment||'';return i.isPlainText(n)||(n=i.encodeWord(n)),this._formatListUrl(t.url)+(t.comment?' ('+n+')':'')}return''}).filter(t=>t).join(', ')}))}))}_formatListUrl(t){return t=t.replace(/[\s<]+|[\s>]+/g,''),/^(https?|mailto|ftp):/.test(t)?'<'+t+'>':/^[^@]+@[^@]+$/.test(t)?'<mailto:'+t+'>':'<http://'+t+'>'}}},7142,[7121,7128,7130]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]),i=r(d[1]),s=r(d[2]),n=r(d[3]),o=r(d[4]),c=r(d[5]);m.exports=class extends t{constructor(t){let i;super(),'string'==typeof(t=t||{})&&(t={url:t});let l=t.service;'function'==typeof t.getSocket&&(this.getSocket=t.getSocket),t.url&&(i=o.parseConnectionUrl(t.url),l=l||i.service),this.options=o.assign(!1,t,i,l&&n(l)),this.options.maxConnections=this.options.maxConnections||5,this.options.maxMessages=this.options.maxMessages||100,this.logger=o.getLogger(this.options,{component:this.options.component||'smtp-pool'});let u=new s(this.options);this.name='SMTP (pool)',this.version=c.version+'[client:'+u.version+']',this._rateLimit={counter:0,timeout:null,waiting:[],checkpoint:!1,delta:Number(this.options.rateDelta)||1e3,limit:Number(this.options.rateLimit)||0},this._closed=!1,this._queue=[],this._connections=[],this._connectionCounter=0,this.idling=!0,setImmediate(()=>{this.idling&&this.emit('idle')})}getSocket(t,i){return setImmediate(()=>i(null,!1))}send(t,i){return!this._closed&&(this._queue.push({mail:t,requeueAttempts:0,callback:i}),this.idling&&this._queue.length>=this.options.maxConnections&&(this.idling=!1),setImmediate(()=>this._processMessages()),!0)}close(){let t,i=this._connections.length;if(this._closed=!0,clearTimeout(this._rateLimit.timeout),!i&&!this._queue.length)return;for(let s=i-1;s>=0;s--)this._connections[s]&&this._connections[s].available&&(t=this._connections[s],t.close(),this.logger.info({tnx:'connection',cid:t.id,action:'removed'},'Connection #%s removed',t.id));if(i&&!this._connections.length&&this.logger.debug({tnx:'connection'},'All connections removed'),!this._queue.length)return;let s=()=>{if(!this._queue.length)return void this.logger.debug({tnx:'connection'},'Pending queue entries cleared');let i=this._queue.shift();if(i&&'function'==typeof i.callback)try{i.callback(new Error('Connection pool was closed'))}catch(i){this.logger.error({err:i,tnx:'callback',cid:t.id},'Callback error for #%s: %s',t.id,i.message)}setImmediate(s)};setImmediate(s)}_processMessages(){let t,i,s;if(this._closed)return;if(!this._queue.length)return void(this.idling||(this.idling=!0,this.emit('idle')));for(i=0,s=this._connections.length;i<s;i++)if(this._connections[i].available){t=this._connections[i];break}if(!t&&this._connections.length<this.options.maxConnections&&(t=this._createConnection()),!t)return void(this.idling=!1);!this.idling&&this._queue.length<this.options.maxConnections&&(this.idling=!0,this.emit('idle'));let n=t.queueEntry=this._queue.shift();n.messageId=(t.queueEntry.mail.message.getHeader('message-id')||'').replace(/[<>\s]/g,''),t.available=!1,this.logger.debug({tnx:'pool',cid:t.id,messageId:n.messageId,action:'assign'},'Assigned message <%s> to #%s (%s)',n.messageId,t.id,t.messages+1),this._rateLimit.limit&&(this._rateLimit.counter++,this._rateLimit.checkpoint||(this._rateLimit.checkpoint=Date.now())),t.send(n.mail,(i,s)=>{if(n===t.queueEntry){try{n.callback(i,s)}catch(i){this.logger.error({err:i,tnx:'callback',cid:t.id},'Callback error for #%s: %s',t.id,i.message)}t.queueEntry=!1}})}_createConnection(){let t=new i(this);return t.id=++this._connectionCounter,this.logger.info({tnx:'pool',cid:t.id,action:'conection'},'Created new pool resource #%s',t.id),t.on('available',()=>{this.logger.debug({tnx:'connection',cid:t.id,action:'available'},'Connection #%s became available',t.id),this._closed?this.close():this._processMessages()}),t.once('error',i=>{if('EMAXLIMIT'!==i.code?this.logger.error({err:i,tnx:'pool',cid:t.id},'Pool Error for #%s: %s',t.id,i.message):this.logger.debug({tnx:'pool',cid:t.id,action:'maxlimit'},'Max messages limit exchausted for #%s',t.id),t.queueEntry){try{t.queueEntry.callback(i)}catch(i){this.logger.error({err:i,tnx:'callback',cid:t.id},'Callback error for #%s: %s',t.id,i.message)}t.queueEntry=!1}this._removeConnection(t),this._continueProcessing()}),t.once('close',()=>{this.logger.info({tnx:'connection',cid:t.id,action:'closed'},'Connection #%s was closed',t.id),this._removeConnection(t),t.queueEntry?setTimeout(()=>{t.queueEntry&&(this._shouldRequeuOnConnectionClose(t.queueEntry)?this._requeueEntryOnConnectionClose(t):this._failDeliveryOnConnectionClose(t)),this._continueProcessing()},50):(this._closed||!this.idling||this._connections.length||this.emit('clear'),this._continueProcessing())}),this._connections.push(t),t}_shouldRequeuOnConnectionClose(t){return void 0===this.options.maxRequeues||this.options.maxRequeues<0||t.requeueAttempts<this.options.maxRequeues}_failDeliveryOnConnectionClose(t){if(t.queueEntry&&t.queueEntry.callback){try{t.queueEntry.callback(new Error('Reached maximum number of retries after connection was closed'))}catch(i){this.logger.error({err:i,tnx:'callback',messageId:t.queueEntry.messageId,cid:t.id},'Callback error for #%s: %s',t.id,i.message)}t.queueEntry=!1}}_requeueEntryOnConnectionClose(t){t.queueEntry.requeueAttempts=t.queueEntry.requeueAttempts+1,this.logger.debug({tnx:'pool',cid:t.id,messageId:t.queueEntry.messageId,action:'requeue'},'Re-queued message <%s> for #%s. Attempt: #%s',t.queueEntry.messageId,t.id,t.queueEntry.requeueAttempts),this._queue.unshift(t.queueEntry),t.queueEntry=!1}_continueProcessing(){this._closed?this.close():setTimeout(()=>this._processMessages(),100)}_removeConnection(t){let i=this._connections.indexOf(t);-1!==i&&this._connections.splice(i,1)}_checkRateLimit(t){if(!this._rateLimit.limit)return t();let i=Date.now();return this._rateLimit.counter<this._rateLimit.limit?t():(this._rateLimit.waiting.push(t),this._rateLimit.checkpoint<=i-this._rateLimit.delta?this._clearRateLimit():void(this._rateLimit.timeout||(this._rateLimit.timeout=setTimeout(()=>this._clearRateLimit(),this._rateLimit.delta-(i-this._rateLimit.checkpoint)),this._rateLimit.checkpoint=i)))}_clearRateLimit(){for(clearTimeout(this._rateLimit.timeout),this._rateLimit.timeout=null,this._rateLimit.counter=0,this._rateLimit.checkpoint=!1;this._rateLimit.waiting.length;){let t=this._rateLimit.waiting.shift();setImmediate(t)}}isIdle(){return this.idling}verify(t){let n;t||(n=new Promise((i,s)=>{t=o.callbackPromise(i,s)}));let c=new i(this).auth;return this.getSocket(this.options,(i,n)=>{if(i)return t(i);let l=this.options;n&&n.connection&&(this.logger.info({tnx:'proxy',remoteAddress:n.connection.remoteAddress,remotePort:n.connection.remotePort,destHost:l.host||'',destPort:l.port||'',action:'connected'},'Using proxied socket from %s:%s to %s:%s',n.connection.remoteAddress,n.connection.remotePort,l.host||'',l.port||''),l=o.assign(!1,l),Object.keys(n).forEach(t=>{l[t]=n[t]}));let u=new s(l),h=!1;u.once('error',i=>{if(!h)return h=!0,u.close(),t(i)}),u.once('end',()=>{if(!h)return h=!0,t(new Error('Connection closed'))});let _=()=>{if(!h)return h=!0,u.quit(),t(null,!0)};u.connect(()=>{if(!h)if(c&&(u.allowsAuth||l.forceAuth))u.login(c,i=>{if(!h)return i?(h=!0,u.close(),t(i)):void _()});else{if(!c&&u.allowsAuth&&l.forceAuth){let i=new Error('Authentication info was not provided');return i.code='NoAuth',h=!0,u.close(),t(i)}_()}})}),n}}},7143,[4897,7144,7145,7148,7121,7124]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]),o=r(d[1]).assign,s=r(d[2]),n=r(d[3]);m.exports=class extends n{constructor(t){if(super(),this.pool=t,this.options=t.options,this.logger=this.pool.logger,this.options.auth)switch((this.options.auth.type||'').toString().toUpperCase()){case'OAUTH2':{let t=new s(this.options.auth,this.logger);t.provisionCallback=this.pool.mailer&&this.pool.mailer.get('oauth2_provision_cb')||t.provisionCallback,this.auth={type:'OAUTH2',user:this.options.auth.user,oauth2:t,method:'XOAUTH2'},t.on('token',t=>this.pool.mailer.emit('token',t)),t.on('error',t=>this.emit('error',t));break}default:if(!this.options.auth.user&&!this.options.auth.pass)break;this.auth={type:(this.options.auth.type||'').toString().toUpperCase()||'LOGIN',user:this.options.auth.user,credentials:{user:this.options.auth.user||'',pass:this.options.auth.pass,options:this.options.auth.options},method:(this.options.auth.method||'').trim().toUpperCase()||this.options.authMethod||!1}}this._connection=!1,this._connected=!1,this.messages=0,this.available=!0}connect(s){this.pool.getSocket(this.options,(n,h)=>{if(n)return s(n);let c=!1,l=this.options;h&&h.connection&&(this.logger.info({tnx:'proxy',remoteAddress:h.connection.remoteAddress,remotePort:h.connection.remotePort,destHost:l.host||'',destPort:l.port||'',action:'connected'},'Using proxied socket from %s:%s to %s:%s',h.connection.remoteAddress,h.connection.remotePort,l.host||'',l.port||''),l=o(!1,l),Object.keys(h).forEach(t=>{l[t]=h[t]})),this.connection=new t(l),this.connection.once('error',t=>{if(this.emit('error',t),!c)return c=!0,s(t)}),this.connection.once('end',()=>{if(this.close(),c)return;c=!0;let t=setTimeout(()=>{if(c)return;let t=new Error('Unexpected socket close');this.connection&&this.connection._socket&&this.connection._socket.upgrading&&(t.code='ETLS'),s(t)},1e3);try{t.unref()}catch(t){}}),this.connection.connect(()=>{if(!c)return this.auth&&(this.connection.allowsAuth||l.forceAuth)?void this.connection.login(this.auth,t=>{if(!c){if(c=!0,t)return this.connection.close(),this.emit('error',t),s(t);this._connected=!0,s(null,!0)}}):(c=!0,this._connected=!0,s(null,!0))})})}send(t,o){if(!this._connected)return this.connect(s=>s?o(s):this.send(t,o));let s=t.message.getEnvelope(),n=t.message.messageId(),h=[].concat(s.to||[]);h.length>3&&h.push('...and '+h.splice(2).length+' more'),this.logger.info({tnx:'send',messageId:n,cid:this.id},'Sending message %s using #%s to <%s>',n,this.id,h.join(', ')),t.data.dsn&&(s.dsn=t.data.dsn),this.connection.send(s,t.message.createReadStream(),(t,h)=>{if(this.messages++,t)return this.connection.close(),this.emit('error',t),o(t);h.envelope={from:s.from,to:s.to},h.messageId=n,setImmediate(()=>{let t;this.messages>=this.options.maxMessages?(t=new Error('Resource exhausted'),t.code='EMAXLIMIT',this.connection.close(),this.emit('error',t)):this.pool._checkRateLimit(()=>{this.available=!0,this.emit('available')})}),o(null,h)})}close(){this._connected=!1,this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.connection&&this.connection.close(),this.emit('close')}}},7144,[7145,7121,7147,4897]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]),s=r(d[1]).EventEmitter,i=r(d[2]),o=r(d[3]),n=r(d[4]),h=r(d[5]),c=r(d[6]),u=r(d[7]).PassThrough,_=r(d[8]),p=6e5;m.exports=class extends s{constructor(s){super(s),this.id=h.randomBytes(8).toString('base64').replace(/\W/g,''),this.stage='init',this.options=s||{},this.secureConnection=!!this.options.secure,this.alreadySecured=!!this.options.secured,this.port=Number(this.options.port)||(this.secureConnection?465:587),this.host=this.options.host||'localhost',this.servername=this.options.servername?this.options.servername:!i.isIP(this.host)&&this.host,this.allowInternalNetworkInterfaces=this.options.allowInternalNetworkInterfaces||!1,void 0===this.options.secure&&465===this.port&&(this.secureConnection=!0),this.name=this.options.name||this._getHostname(),this.logger=_.getLogger(this.options,{component:this.options.component||'smtp-connection',sid:this.id}),this.customAuth=new Map,Object.keys(this.options.customAuth||{}).forEach(t=>{let s=(t||'').toString().trim().toUpperCase();s&&this.customAuth.set(s,this.options.customAuth[t])}),this.version=t.version,this.authenticated=!1,this.destroyed=!1,this.secure=!!this.secureConnection,this._remainder='',this._responseQueue=[],this.lastServerResponse=!1,this._socket=!1,this._supportedAuth=[],this.allowsAuth=!1,this._envelope=!1,this._supportedExtensions=[],this._maxAllowedSize=0,this._responseActions=[],this._recipientQueue=[],this._greetingTimeout=!1,this._connectionTimeout=!1,this._destroyed=!1,this._closing=!1,this._onSocketData=t=>this._onData(t),this._onSocketError=t=>this._onError(t,'ESOCKET',!1,'CONN'),this._onSocketClose=()=>this._onClose(),this._onSocketEnd=()=>this._onEnd(),this._onSocketTimeout=()=>this._onTimeout()}connect(t){if('function'==typeof t){this.once('connect',()=>{this.logger.debug({tnx:'smtp'},'SMTP handshake finished'),t()});const s=this._isDestroyedMessage('connect');if(s)return t(this._formatError(s,'ECONNECTION',!1,'CONN'))}let s={port:this.port,host:this.host,allowInternalNetworkInterfaces:this.allowInternalNetworkInterfaces,timeout:this.options.dnsTimeout||3e4};this.options.localAddress&&(s.localAddress=this.options.localAddress);let n=()=>{this._connectionTimeout=setTimeout(()=>{this._onError('Connection timeout','ETIMEDOUT',!1,'CONN')},this.options.connectionTimeout||12e4),this._socket.on('error',this._onSocketError)};return this.options.connection?(this._socket=this.options.connection,n(),void(this.secureConnection&&!this.alreadySecured?setImmediate(()=>this._upgradeConnection(t=>{t?this._onError(new Error('Error initiating TLS - '+(t.message||t)),'ETLS',!1,'CONN'):this._onConnect()})):setImmediate(()=>this._onConnect()))):this.options.socket?(this._socket=this.options.socket,_.resolveHostname(s,(t,i)=>{if(t)return setImmediate(()=>this._onError(t,'EDNS',!1,'CONN'));this.logger.debug({tnx:'dns',source:s.host,resolved:i.host,cached:!!i.cached},'Resolved %s as %s [cache %s]',s.host,i.host,i.cached?'hit':'miss'),Object.keys(i).forEach(t=>{'_'!==t.charAt(0)&&i[t]&&(s[t]=i[t])});try{this._socket.connect(this.port,this.host,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),n()}catch(t){return setImmediate(()=>this._onError(t,'ECONNECTION',!1,'CONN'))}})):this.secureConnection?(this.options.tls&&Object.keys(this.options.tls).forEach(t=>{s[t]=this.options.tls[t]}),this.servername&&!s.servername&&(s.servername=this.servername),_.resolveHostname(s,(t,i)=>{if(t)return setImmediate(()=>this._onError(t,'EDNS',!1,'CONN'));this.logger.debug({tnx:'dns',source:s.host,resolved:i.host,cached:!!i.cached},'Resolved %s as %s [cache %s]',s.host,i.host,i.cached?'hit':'miss'),Object.keys(i).forEach(t=>{'_'!==t.charAt(0)&&i[t]&&(s[t]=i[t])});try{this._socket=o.connect(s,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),n()}catch(t){return setImmediate(()=>this._onError(t,'ECONNECTION',!1,'CONN'))}})):_.resolveHostname(s,(t,o)=>{if(t)return setImmediate(()=>this._onError(t,'EDNS',!1,'CONN'));this.logger.debug({tnx:'dns',source:s.host,resolved:o.host,cached:!!o.cached},'Resolved %s as %s [cache %s]',s.host,o.host,o.cached?'hit':'miss'),Object.keys(o).forEach(t=>{'_'!==t.charAt(0)&&o[t]&&(s[t]=o[t])});try{this._socket=i.connect(s,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),n()}catch(t){return setImmediate(()=>this._onError(t,'ECONNECTION',!1,'CONN'))}})}quit(){this._sendCommand('QUIT'),this._responseActions.push(this.close)}close(){if(clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._responseActions=[],this._closing)return;this._closing=!0;let t='end';'init'===this.stage&&(t='destroy'),this.logger.debug({tnx:'smtp'},'Closing connection to the server using "%s"',t);let s=this._socket&&this._socket.socket||this._socket;if(s&&!s.destroyed)try{s[t]()}catch(t){}this._destroy()}login(t,s){const i=this._isDestroyedMessage('login');if(i)return s(this._formatError(i,'ECONNECTION',!1,'API'));if(this._auth=t||{},this._authMethod=(this._auth.method||'').toString().trim().toUpperCase()||!1,this._authMethod||!this._auth.oauth2||this._auth.credentials?this._authMethod&&('XOAUTH2'!==this._authMethod||this._auth.oauth2)||(this._authMethod=(this._supportedAuth[0]||'PLAIN').toUpperCase().trim()):this._authMethod='XOAUTH2',!('XOAUTH2'===this._authMethod||this._auth.credentials&&this._auth.credentials.user&&this._auth.credentials.pass)){if(!(this._auth.user&&this._auth.pass||this.customAuth.has(this._authMethod)))return s(this._formatError('Missing credentials for "'+this._authMethod+'"','EAUTH',!1,'API'));this._auth.credentials={user:this._auth.user,pass:this._auth.pass,options:this._auth.options}}if(this.customAuth.has(this._authMethod)){let t,i=this.customAuth.get(this._authMethod),o=!1,n=()=>{o||(o=!0,this.logger.info({tnx:'smtp',username:this._auth.user,action:'authenticated',method:this._authMethod},'User %s authenticated',JSON.stringify(this._auth.user)),this.authenticated=!0,s(null,!0))},h=i=>{o||(o=!0,s(this._formatError(i,'EAUTH',t,'AUTH '+this._authMethod)))},c=i({auth:this._auth,method:this._authMethod,extensions:[].concat(this._supportedExtensions),authMethods:[].concat(this._supportedAuth),maxAllowedSize:this._maxAllowedSize||!1,sendCommand:(s,i)=>{let o;return i||(o=new Promise((t,s)=>{i=_.callbackPromise(t,s)})),this._responseActions.push(o=>{t=o;let n=o.match(/^(\d+)(?:\s(\d+\.\d+\.\d+))?\s/),h={command:s,response:o};n?(h.status=Number(n[1])||0,n[2]&&(h.code=n[2]),h.text=o.substr(n[0].length)):(h.text=o,h.status=0),i(null,h)}),setImmediate(()=>this._sendCommand(s)),o},resolve:n,reject:h});return void(c&&'function'==typeof c.catch&&c.then(n).catch(h))}switch(this._authMethod){case'XOAUTH2':return void this._handleXOauth2Token(!1,s);case'LOGIN':return this._responseActions.push(t=>{this._actionAUTH_LOGIN_USER(t,s)}),void this._sendCommand('AUTH LOGIN');case'PLAIN':return this._responseActions.push(t=>{this._actionAUTHComplete(t,s)}),void this._sendCommand('AUTH PLAIN '+Buffer.from('\0'+this._auth.credentials.user+'\0'+this._auth.credentials.pass,'utf-8').toString('base64'),'AUTH PLAIN '+Buffer.from('\0'+this._auth.credentials.user+"\0/* secret */",'utf-8').toString('base64'));case'CRAM-MD5':return this._responseActions.push(t=>{this._actionAUTH_CRAM_MD5(t,s)}),void this._sendCommand('AUTH CRAM-MD5')}return s(this._formatError('Unknown authentication method "'+this._authMethod+'"','EAUTH',!1,'API'))}send(t,s,i){if(!s)return i(this._formatError('Empty message','EMESSAGE',!1,'API'));const o=this._isDestroyedMessage('send message');if(o)return i(this._formatError(o,'ECONNECTION',!1,'API'));if(this._maxAllowedSize&&t.size>this._maxAllowedSize)return setImmediate(()=>{i(this._formatError('Message size larger than allowed '+this._maxAllowedSize,'EMESSAGE',!1,'MAIL FROM'))});let n=!1,h=function(){n||(n=!0,i(...arguments))};'function'==typeof s.on&&s.on('error',t=>h(this._formatError(t,'ESTREAM',!1,'API')));let c=Date.now();this._setEnvelope(t,(t,i)=>{if(t){let i=new u;return'function'==typeof s.pipe?s.pipe(i):(i.write(s),i.end()),h(t)}let o=Date.now(),n=this._createSendStream((t,s)=>t?h(t):(i.envelopeTime=o-c,i.messageTime=Date.now()-o,i.messageSize=n.outByteCount,i.response=s,h(null,i)));'function'==typeof s.pipe?s.pipe(n):(n.write(s),n.end())})}reset(t){this._sendCommand('RSET'),this._responseActions.push(s=>'2'!==s.charAt(0)?t(this._formatError('Could not reset session state. response='+s,'EPROTOCOL',s,'RSET')):(this._envelope=!1,t(null,!0)))}_onConnect(){clearTimeout(this._connectionTimeout),this.logger.info({tnx:'network',localAddress:this._socket.localAddress,localPort:this._socket.localPort,remoteAddress:this._socket.remoteAddress,remotePort:this._socket.remotePort},'%s established to %s:%s',this.secure?'Secure connection':'Connection',this._socket.remoteAddress,this._socket.remotePort),this._destroyed?this.close():(this.stage='connected',this._socket.removeListener('data',this._onSocketData),this._socket.removeListener('timeout',this._onSocketTimeout),this._socket.removeListener('close',this._onSocketClose),this._socket.removeListener('end',this._onSocketEnd),this._socket.on('data',this._onSocketData),this._socket.once('close',this._onSocketClose),this._socket.once('end',this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||p),this._socket.on('timeout',this._onSocketTimeout),this._greetingTimeout=setTimeout(()=>{this._socket&&!this._destroyed&&this._responseActions[0]===this._actionGreeting&&this._onError('Greeting never received','ETIMEDOUT',!1,'CONN')},this.options.greetingTimeout||3e4),this._responseActions.push(this._actionGreeting),this._socket.resume())}_onData(t){if(this._destroyed||!t||!t.length)return;let s,i=(t||'').toString('binary'),o=(this._remainder+i).split(/\r?\n/);this._remainder=o.pop();for(let t=0,i=o.length;t<i;t++)this._responseQueue.length&&(s=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(s.split('\n').pop()))?this._responseQueue[this._responseQueue.length-1]+='\n'+o[t]:this._responseQueue.push(o[t]);this._responseQueue.length&&(s=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(s.split('\n').pop()))||this._processResponse()}_onError(t,s,i,o){clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._destroyed||(t=this._formatError(t,s,i,o),this.logger.error(i,t.message),this.emit('error',t),this.close())}_formatError(t,s,i,o){let n;n=/Error\]$/i.test(Object.prototype.toString.call(t))?t:new Error(t),s&&'Error'!==s&&(n.code=s),i&&(n.response=i,n.message+=': '+i);let h='string'==typeof i&&Number((i.match(/^\d+/)||[])[0])||!1;return h&&(n.responseCode=h),o&&(n.command=o),n}_onClose(){let t=!1;return this._remainder&&this._remainder.trim()&&((this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:'server'},this._remainder.replace(/\r?\n$/,'')),this.lastServerResponse=t=this._remainder.trim()),this.logger.info({tnx:'network'},'Connection closed'),this.upgrading&&!this._destroyed?this._onError(new Error('Connection closed unexpectedly'),'ETLS',t,'CONN'):[this._actionGreeting,this.close].includes(this._responseActions[0])||this._destroyed?/^[45]\d{2}\b/.test(t)?this._onError(new Error('Connection closed unexpectedly'),'ECONNECTION',t,'CONN'):void this._destroy():this._onError(new Error('Connection closed unexpectedly'),'ECONNECTION',t,'CONN')}_onEnd(){this._socket&&!this._socket.destroyed&&this._socket.destroy()}_onTimeout(){return this._onError(new Error('Timeout'),'ETIMEDOUT',!1,'CONN')}_destroy(){this._destroyed||(this._destroyed=!0,this.emit('end'))}_upgradeConnection(t){this._socket.removeListener('data',this._onSocketData),this._socket.removeListener('timeout',this._onSocketTimeout);let s=this._socket,i={socket:this._socket,host:this.host};Object.keys(this.options.tls||{}).forEach(t=>{i[t]=this.options.tls[t]}),this.servername&&!i.servername&&(i.servername=this.servername),this.upgrading=!0;try{this._socket=o.connect(i,()=>(this.secure=!0,this.upgrading=!1,this._socket.on('data',this._onSocketData),s.removeListener('close',this._onSocketClose),s.removeListener('end',this._onSocketEnd),t(null,!0)))}catch(s){return t(s)}this._socket.on('error',this._onSocketError),this._socket.once('close',this._onSocketClose),this._socket.once('end',this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||p),this._socket.on('timeout',this._onSocketTimeout),s.resume()}_processResponse(){if(!this._responseQueue.length)return!1;let t=this.lastServerResponse=(this._responseQueue.shift()||'').toString();if(/^\d+-/.test(t.split('\n').pop()))return;(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:'server'},t.replace(/\r?\n$/,'')),t.trim()||setImmediate(()=>this._processResponse());let s=this._responseActions.shift();if('function'!=typeof s)return this._onError(new Error('Unexpected Response'),'EPROTOCOL',t,'CONN');s.call(this,t),setImmediate(()=>this._processResponse())}_sendCommand(t,s){if(!this._destroyed){if(this._socket.destroyed)return this.close();(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:'client'},(s||t||'').toString().replace(/\r?\n$/,'')),this._socket.write(Buffer.from(t+'\r\n','utf-8'))}}_setEnvelope(t,s){let i=[],o=!1;if(this._envelope=t||{},this._envelope.from=(this._envelope.from&&this._envelope.from.address||this._envelope.from||'').toString().trim(),this._envelope.to=[].concat(this._envelope.to||[]).map(t=>(t&&t.address||t||'').toString().trim()),!this._envelope.to.length)return s(this._formatError('No recipients defined','EENVELOPE',!1,'API'));if(this._envelope.from&&/[\r\n<>]/.test(this._envelope.from))return s(this._formatError('Invalid sender '+JSON.stringify(this._envelope.from),'EENVELOPE',!1,'API'));/[\x80-\uFFFF]/.test(this._envelope.from)&&(o=!0);for(let t=0,i=this._envelope.to.length;t<i;t++){if(!this._envelope.to[t]||/[\r\n<>]/.test(this._envelope.to[t]))return s(this._formatError('Invalid recipient '+JSON.stringify(this._envelope.to[t]),'EENVELOPE',!1,'API'));/[\x80-\uFFFF]/.test(this._envelope.to[t])&&(o=!0)}if(this._envelope.rcptQueue=JSON.parse(JSON.stringify(this._envelope.to||[])),this._envelope.rejected=[],this._envelope.rejectedErrors=[],this._envelope.accepted=[],this._envelope.dsn)try{this._envelope.dsn=this._setDsnEnvelope(this._envelope.dsn)}catch(t){return s(this._formatError('Invalid DSN '+t.message,'EENVELOPE',!1,'API'))}this._responseActions.push(t=>{this._actionMAIL(t,s)}),o&&this._supportedExtensions.includes('SMTPUTF8')&&(i.push('SMTPUTF8'),this._usingSmtpUtf8=!0),this._envelope.use8BitMime&&this._supportedExtensions.includes('8BITMIME')&&(i.push('BODY=8BITMIME'),this._using8BitMime=!0),this._envelope.size&&this._supportedExtensions.includes('SIZE')&&i.push('SIZE='+this._envelope.size),this._envelope.dsn&&this._supportedExtensions.includes('DSN')&&(this._envelope.dsn.ret&&i.push('RET='+_.encodeXText(this._envelope.dsn.ret)),this._envelope.dsn.envid&&i.push('ENVID='+_.encodeXText(this._envelope.dsn.envid))),this._sendCommand('MAIL FROM:<'+this._envelope.from+'>'+(i.length?' '+i.join(' '):''))}_setDsnEnvelope(t){let s=(t.ret||t.return||'').toString().toUpperCase()||null;if(s)switch(s){case'HDRS':case'HEADERS':s='HDRS';break;case'FULL':case'BODY':s='FULL'}if(s&&!['FULL','HDRS'].includes(s))throw new Error('ret: '+JSON.stringify(s));let i=(t.envid||t.id||'').toString()||null,o=t.notify||null;if(o){'string'==typeof o&&(o=o.split(',')),o=o.map(t=>t.trim().toUpperCase());let t=['NEVER','SUCCESS','FAILURE','DELAY'];if(o.filter(s=>!t.includes(s)).length||o.length>1&&o.includes('NEVER'))throw new Error('notify: '+JSON.stringify(o.join(',')));o=o.join(',')}let n=(t.recipient||t.orcpt||'').toString()||null;return n&&n.indexOf(';')<0&&(n='rfc822;'+n),{ret:s,envid:i,notify:o,orcpt:n}}_getDsnRcptToArgs(){let t=[];return this._envelope.dsn&&this._supportedExtensions.includes('DSN')&&(this._envelope.dsn.notify&&t.push('NOTIFY='+_.encodeXText(this._envelope.dsn.notify)),this._envelope.dsn.orcpt&&t.push('ORCPT='+_.encodeXText(this._envelope.dsn.orcpt))),t.length?' '+t.join(' '):''}_createSendStream(t){let s,i=new c;return this.options.lmtp?this._envelope.accepted.forEach((s,i)=>{let o=i===this._envelope.accepted.length-1;this._responseActions.push(i=>{this._actionLMTPStream(s,o,i,t)})}):this._responseActions.push(s=>{this._actionSMTPStream(s,t)}),i.pipe(this._socket,{end:!1}),this.options.debug&&(s=new u,s.on('readable',()=>{let t;for(;t=s.read();)this.logger.debug({tnx:'message'},t.toString('binary').replace(/\r?\n$/,''))}),i.pipe(s)),i.once('end',()=>{this.logger.info({tnx:'message',inByteCount:i.inByteCount,outByteCount:i.outByteCount},'<%s bytes encoded mime message (source size %s bytes)>',i.outByteCount,i.inByteCount)}),i}_actionGreeting(t){clearTimeout(this._greetingTimeout),'220'===t.substr(0,3)?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand('LHLO '+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand('EHLO '+this.name)):this._onError(new Error('Invalid greeting. response='+t),'EPROTOCOL',t,'CONN')}_actionLHLO(t){'2'===t.charAt(0)?this._actionEHLO(t):this._onError(new Error('Invalid LHLO. response='+t),'EPROTOCOL',t,'LHLO')}_actionEHLO(t){let s;if('421'!==t.substr(0,3)){if('2'!==t.charAt(0))return this.options.requireTLS?void this._onError(new Error('EHLO failed but HELO does not support required STARTTLS. response='+t),'ECONNECTION',t,'EHLO'):(this._responseActions.push(this._actionHELO),void this._sendCommand('HELO '+this.name));if(this._ehloLines=t.split(/\r?\n/).map(t=>t.replace(/^\d+[ -]/,'').trim()).filter(t=>t).slice(1),!this.secure&&!this.options.ignoreTLS&&(/[ -]STARTTLS\b/im.test(t)||this.options.requireTLS))return this._sendCommand('STARTTLS'),void this._responseActions.push(this._actionSTARTTLS);/[ -]SMTPUTF8\b/im.test(t)&&this._supportedExtensions.push('SMTPUTF8'),/[ -]DSN\b/im.test(t)&&this._supportedExtensions.push('DSN'),/[ -]8BITMIME\b/im.test(t)&&this._supportedExtensions.push('8BITMIME'),/[ -]PIPELINING\b/im.test(t)&&this._supportedExtensions.push('PIPELINING'),/[ -]AUTH\b/i.test(t)&&(this.allowsAuth=!0),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)PLAIN/i.test(t)&&this._supportedAuth.push('PLAIN'),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)LOGIN/i.test(t)&&this._supportedAuth.push('LOGIN'),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)CRAM-MD5/i.test(t)&&this._supportedAuth.push('CRAM-MD5'),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)XOAUTH2/i.test(t)&&this._supportedAuth.push('XOAUTH2'),(s=t.match(/[ -]SIZE(?:[ \t]+(\d+))?/im))&&(this._supportedExtensions.push('SIZE'),this._maxAllowedSize=Number(s[1])||0),this.emit('connect')}else this._onError(new Error('Server terminates connection. response='+t),'ECONNECTION',t,'EHLO')}_actionHELO(t){'2'===t.charAt(0)?(this.allowsAuth=!0,this.emit('connect')):this._onError(new Error('Invalid HELO. response='+t),'EPROTOCOL',t,'HELO')}_actionSTARTTLS(t){if('2'!==t.charAt(0))return this.options.opportunisticTLS?(this.logger.info({tnx:'smtp'},'Failed STARTTLS upgrade, continuing unencrypted'),this.emit('connect')):void this._onError(new Error('Error upgrading connection with STARTTLS'),'ETLS',t,'STARTTLS');this._upgradeConnection((t,s)=>{t?this._onError(new Error('Error initiating TLS - '+(t.message||t)),'ETLS',!1,'STARTTLS'):(this.logger.info({tnx:'smtp'},'Connection upgraded with STARTTLS'),s?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand('LHLO '+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand('EHLO '+this.name)):this.emit('connect'))})}_actionAUTH_LOGIN_USER(t,s){/^334[ -]/.test(t)?(this._responseActions.push(t=>{this._actionAUTH_LOGIN_PASS(t,s)}),this._sendCommand(Buffer.from(this._auth.credentials.user+'','utf-8').toString('base64'))):s(this._formatError('Invalid login sequence while waiting for "334 VXNlcm5hbWU6"','EAUTH',t,'AUTH LOGIN'))}_actionAUTH_CRAM_MD5(t,s){let i=t.match(/^334\s+(.+)$/),o='';if(!i)return s(this._formatError('Invalid login sequence while waiting for server challenge string','EAUTH',t,'AUTH CRAM-MD5'));o=i[1];let n=Buffer.from(o,'base64').toString('ascii'),c=h.createHmac('md5',this._auth.credentials.pass);c.update(n);let u=this._auth.credentials.user+' '+c.digest('hex');this._responseActions.push(t=>{this._actionAUTH_CRAM_MD5_PASS(t,s)}),this._sendCommand(Buffer.from(u).toString('base64'),Buffer.from(this._auth.credentials.user+' /* secret */').toString('base64'))}_actionAUTH_CRAM_MD5_PASS(t,s){if(!t.match(/^235\s+/))return s(this._formatError('Invalid login sequence while waiting for "235"','EAUTH',t,'AUTH CRAM-MD5'));this.logger.info({tnx:'smtp',username:this._auth.user,action:'authenticated',method:this._authMethod},'User %s authenticated',JSON.stringify(this._auth.user)),this.authenticated=!0,s(null,!0)}_actionAUTH_LOGIN_PASS(t,s){if(!/^334[ -]/.test(t))return s(this._formatError('Invalid login sequence while waiting for "334 UGFzc3dvcmQ6"','EAUTH',t,'AUTH LOGIN'));this._responseActions.push(t=>{this._actionAUTHComplete(t,s)}),this._sendCommand(Buffer.from((this._auth.credentials.pass||'').toString(),'utf-8').toString('base64'),Buffer.from('/* secret */','utf-8').toString('base64'))}_actionAUTHComplete(t,s,i){return i||'function'!=typeof s||(i=s,s=!1),'334'===t.substr(0,3)?(this._responseActions.push(t=>{s||'XOAUTH2'!==this._authMethod?this._actionAUTHComplete(t,!0,i):setImmediate(()=>this._handleXOauth2Token(!0,i))}),void this._sendCommand('')):'2'!==t.charAt(0)?(this.logger.info({tnx:'smtp',username:this._auth.user,action:'authfail',method:this._authMethod},'User %s failed to authenticate',JSON.stringify(this._auth.user)),i(this._formatError('Invalid login','EAUTH',t,'AUTH '+this._authMethod))):(this.logger.info({tnx:'smtp',username:this._auth.user,action:'authenticated',method:this._authMethod},'User %s authenticated',JSON.stringify(this._auth.user)),this.authenticated=!0,void i(null,!0))}_actionMAIL(t,s){let i,o;if(2!==Number(t.charAt(0)))return i=this._usingSmtpUtf8&&/^550 /.test(t)&&/[\x80-\uFFFF]/.test(this._envelope.from)?'Internationalized mailbox name not allowed':'Mail command failed',s(this._formatError(i,'EENVELOPE',t,'MAIL FROM'));if(!this._envelope.rcptQueue.length)return s(this._formatError("Can't send mail - no recipients defined",'EENVELOPE',!1,'API'));if(this._recipientQueue=[],this._supportedExtensions.includes('PIPELINING'))for(;this._envelope.rcptQueue.length;)o=this._envelope.rcptQueue.shift(),this._recipientQueue.push(o),this._responseActions.push(t=>{this._actionRCPT(t,s)}),this._sendCommand('RCPT TO:<'+o+'>'+this._getDsnRcptToArgs());else o=this._envelope.rcptQueue.shift(),this._recipientQueue.push(o),this._responseActions.push(t=>{this._actionRCPT(t,s)}),this._sendCommand('RCPT TO:<'+o+'>'+this._getDsnRcptToArgs())}_actionRCPT(t,s){let i,o,n=this._recipientQueue.shift();if(2!==Number(t.charAt(0))?(i=this._usingSmtpUtf8&&/^553 /.test(t)&&/[\x80-\uFFFF]/.test(n)?'Internationalized mailbox name not allowed':'Recipient command failed',this._envelope.rejected.push(n),o=this._formatError(i,'EENVELOPE',t,'RCPT TO'),o.recipient=n,this._envelope.rejectedErrors.push(o)):this._envelope.accepted.push(n),this._envelope.rcptQueue.length||this._recipientQueue.length)this._envelope.rcptQueue.length&&(n=this._envelope.rcptQueue.shift(),this._recipientQueue.push(n),this._responseActions.push(t=>{this._actionRCPT(t,s)}),this._sendCommand('RCPT TO:<'+n+'>'+this._getDsnRcptToArgs()));else{if(!(this._envelope.rejected.length<this._envelope.to.length))return o=this._formatError("Can't send mail - all recipients were rejected",'EENVELOPE',t,'RCPT TO'),o.rejected=this._envelope.rejected,o.rejectedErrors=this._envelope.rejectedErrors,s(o);this._responseActions.push(t=>{this._actionDATA(t,s)}),this._sendCommand('DATA')}}_actionDATA(t,s){if(!/^[23]/.test(t))return s(this._formatError('Data command failed','EENVELOPE',t,'DATA'));let i={accepted:this._envelope.accepted,rejected:this._envelope.rejected};this._ehloLines&&this._ehloLines.length&&(i.ehlo=this._ehloLines),this._envelope.rejectedErrors.length&&(i.rejectedErrors=this._envelope.rejectedErrors),s(null,i)}_actionSMTPStream(t,s){return 2!==Number(t.charAt(0))?s(this._formatError('Message failed','EMESSAGE',t,'DATA')):s(null,t)}_actionLMTPStream(t,s,i,o){let n;if(2!==Number(i.charAt(0))){n=this._formatError('Message failed for recipient '+t,'EMESSAGE',i,'DATA'),n.recipient=t,this._envelope.rejected.push(t),this._envelope.rejectedErrors.push(n);for(let s=0,i=this._envelope.accepted.length;s<i;s++)this._envelope.accepted[s]===t&&this._envelope.accepted.splice(s,1)}if(s)return o(null,i)}_handleXOauth2Token(t,s){this._auth.oauth2.getToken(t,(i,o)=>{if(i)return this.logger.info({tnx:'smtp',username:this._auth.user,action:'authfail',method:this._authMethod},'User %s failed to authenticate',JSON.stringify(this._auth.user)),s(this._formatError(i,'EAUTH',!1,'AUTH XOAUTH2'));this._responseActions.push(i=>{this._actionAUTHComplete(i,t,s)}),this._sendCommand('AUTH XOAUTH2 '+this._auth.oauth2.buildXOAuth2Token(o),'AUTH XOAUTH2 '+this._auth.oauth2.buildXOAuth2Token('/* secret */'))})}_isDestroyedMessage(t){if(this._destroyed)return'Cannot '+t+' - smtp connection is already destroyed.';if(this._socket){if(this._socket.destroyed)return'Cannot '+t+' - smtp connection socket is already destroyed.';if(!this._socket.writable)return'Cannot '+t+' - smtp connection socket is already half-closed.'}}_getHostname(){let t;try{t=n.hostname()||''}catch(s){t='localhost'}return(!t||t.indexOf('.')<0)&&(t='[127.0.0.1]'),t.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)&&(t='['+t+']'),t}}},7145,[7124,4897,4898,4899,4909,4791,7146,4793,7121]);
__d(function(g,r,_i,a,m,e,d){'use strict';const t=r(d[0]).Transform;m.exports=class extends t{constructor(t){super(t),this.options=t||{},this._curLine='',this.inByteCount=0,this.outByteCount=0,this.lastByte=!1}_transform(t,s,h){let n,u,i,o=[],f=0,l=0;if(!t||!t.length)return h();for('string'==typeof t&&(t=Buffer.from(t)),this.inByteCount+=t.length,n=0,u=t.length;n<u;n++)46===t[n]?(n&&10===t[n-1]||!n&&(!this.lastByte||10===this.lastByte))&&(i=t.slice(l,n+1),o.push(i),o.push(Buffer.from('.')),f+=i.length+1,l=n+1):10===t[n]&&(n&&13!==t[n-1]||!n&&13!==this.lastByte)&&(n>l?(i=t.slice(l,n),o.push(i),f+=i.length+2):f+=2,o.push(Buffer.from('\r\n')),l=n+1);f?(l<t.length&&(i=t.slice(l),o.push(i),f+=i.length),this.outByteCount+=f,this.push(Buffer.concat(o,f))):(this.outByteCount+=t.length,this.push(t)),this.lastByte=t[t.length-1],h()}_flush(t){let s;s=10===this.lastByte?Buffer.from('.\r\n'):13===this.lastByte?Buffer.from('\n.\r\n'):Buffer.from('\r\n.\r\n'),this.outByteCount+=s.length,this.push(s),t()}}},7146,[4793]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]).Stream,s=r(d[1]),o=r(d[2]),n=r(d[3]);m.exports=class extends t{constructor(t,s){if(super(),this.options=t||{},t&&t.serviceClient){if(!t.privateKey||!t.user)return void setImmediate(()=>this.emit('error',new Error('Options "privateKey" and "user" are required for service account!')));let s=Math.min(Math.max(Number(this.options.serviceRequestTimeout)||0,0),3600);this.options.serviceRequestTimeout=s||300}if(this.logger=n.getLogger({logger:s},{component:this.options.component||'OAuth2'}),this.provisionCallback='function'==typeof this.options.provisionCallback&&this.options.provisionCallback,this.options.accessUrl=this.options.accessUrl||'https://accounts.google.com/o/oauth2/token',this.options.customHeaders=this.options.customHeaders||{},this.options.customParams=this.options.customParams||{},this.accessToken=this.options.accessToken||!1,this.options.expires&&Number(this.options.expires))this.expires=this.options.expires;else{let t=Math.max(Number(this.options.timeout)||0,0);this.expires=t&&Date.now()+1e3*t||0}this.renewing=!1,this.renewalQueue=[]}getToken(t,s){if(!t&&this.accessToken&&(!this.expires||this.expires>Date.now()))return this.logger.debug({tnx:'OAUTH2',user:this.options.user,action:'reuse'},'Reusing existing access token for %s',this.options.user),s(null,this.accessToken);if(!this.provisionCallback&&!this.options.refreshToken&&!this.options.serviceClient)return this.accessToken?(this.logger.debug({tnx:'OAUTH2',user:this.options.user,action:'reuse'},'Reusing existing access token (no refresh capability) for %s',this.options.user),s(null,this.accessToken)):(this.logger.error({tnx:'OAUTH2',user:this.options.user,action:'renew'},'Cannot renew access token for %s: No refresh mechanism available',this.options.user),s(new Error("Can't create new access token for user")));if(this.renewing)return this.renewalQueue.push({renew:t,callback:s});this.renewing=!0;const o=(t,o)=>{this.renewalQueue.forEach(s=>s.callback(t,o)),this.renewalQueue=[],this.renewing=!1,t?this.logger.error({err:t,tnx:'OAUTH2',user:this.options.user,action:'renew'},'Failed generating new Access Token for %s',this.options.user):this.logger.info({tnx:'OAUTH2',user:this.options.user,action:'renew'},'Generated new Access Token for %s',this.options.user),s(t,o)};this.provisionCallback?this.provisionCallback(this.options.user,!!t,(t,s,n)=>{!t&&s&&(this.accessToken=s,this.expires=n||0),o(t,s)}):this.generateToken(o)}updateToken(t,s){this.accessToken=t,s=Math.max(Number(s)||0,0),this.expires=s&&Date.now()+1e3*s||0,this.emit('token',{user:this.options.user,accessToken:t||'',expires:this.expires})}generateToken(t){let s,o;if(this.options.serviceClient){let n,c=Math.floor(Date.now()/1e3),h={iss:this.options.serviceClient,scope:this.options.scope||'https://mail.google.com/',sub:this.options.user,aud:this.options.accessUrl,iat:c,exp:c+this.options.serviceRequestTimeout};try{n=this.jwtSignRS256(h)}catch(s){return t(new Error("Can't generate token. Check your auth options"))}s={grant_type:'urn:ietf:params:oauth:grant-type:jwt-bearer',assertion:n},o={grant_type:'urn:ietf:params:oauth:grant-type:jwt-bearer',assertion:h}}else{if(!this.options.refreshToken)return t(new Error("Can't create new access token for user"));s={client_id:this.options.clientId||'',client_secret:this.options.clientSecret||'',refresh_token:this.options.refreshToken,grant_type:'refresh_token'},o={client_id:this.options.clientId||'',client_secret:(this.options.clientSecret||'').substr(0,6)+'...',refresh_token:(this.options.refreshToken||'').substr(0,6)+'...',grant_type:'refresh_token'}}Object.keys(this.options.customParams).forEach(t=>{s[t]=this.options.customParams[t],o[t]=this.options.customParams[t]}),this.logger.debug({tnx:'OAUTH2',user:this.options.user,action:'generate'},'Requesting token using: %s',JSON.stringify(o)),this.postRequest(this.options.accessUrl,s,this.options,(s,o)=>{let n;if(s)return t(s);try{n=JSON.parse(o.toString())}catch(s){return t(s)}if(!n||'object'!=typeof n)return this.logger.debug({tnx:'OAUTH2',user:this.options.user,action:'post'},'Response: %s',(o||'').toString()),t(new Error('Invalid authentication response'));let c={};if(Object.keys(n).forEach(t=>{c[t]='access_token'!==t?n[t]:(n[t]||'').toString().substr(0,6)+'...'}),this.logger.debug({tnx:'OAUTH2',user:this.options.user,action:'post'},'Response: %s',JSON.stringify(c)),n.error){let s=n.error;return n.error_description&&(s+=': '+n.error_description),n.error_uri&&(s+=' ('+n.error_uri+')'),t(new Error(s))}return n.access_token?(this.updateToken(n.access_token,n.expires_in),t(null,this.accessToken)):t(new Error('No access token'))})}buildXOAuth2Token(t){let s=['user='+(this.options.user||''),'auth=Bearer '+(t||this.accessToken),'',''];return Buffer.from(s.join('\x01'),'utf-8').toString('base64')}postRequest(t,o,n,c){let h=!1,u=[],p=0,l=s(t,{method:'post',headers:n.customHeaders,body:o,allowErrorResponse:!0});l.on('readable',()=>{let t;for(;null!==(t=l.read());)u.push(t),p+=t.length}),l.once('error',t=>{if(!h)return h=!0,c(t)}),l.once('end',()=>{if(!h)return h=!0,c(null,Buffer.concat(u,p))})}toBase64URL(t){return'string'==typeof t&&(t=Buffer.from(t)),t.toString('base64').replace(/[=]+/g,'').replace(/\+/g,'-').replace(/\//g,'_')}jwtSignRS256(t){t=['{"alg":"RS256","typ":"JWT"}',JSON.stringify(t)].map(t=>this.toBase64URL(t)).join('.');let s=o.createSign('RSA-SHA256').update(t).sign(this.options.privateKey);return t+'.'+this.toBase64URL(s)}}},7147,[4793,7122,4791,7121]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]),c={};function n(t){return t.replace(/[^a-zA-Z0-9.-]/g,'').toLowerCase()}function o(t){let c=['domains','aliases'],n={};return Object.keys(t).forEach(o=>{c.indexOf(o)<0&&(n[o]=t[o])}),n}Object.keys(t).forEach(s=>{let f=t[s];c[n(s)]=o(f),[].concat(f.aliases||[]).forEach(t=>{c[n(t)]=o(f)}),[].concat(f.domains||[]).forEach(t=>{c[n(t)]=o(f)})}),m.exports=function(t){return t=n(t.split('@').pop()),c[t]||!1}},7148,[7149]);
__d(function(o,i,s,e,t,a,r){t.exports={"1und1":{description:"1&1 Mail (German hosting provider)",host:"smtp.1und1.de",port:465,secure:!0,authMethod:"LOGIN"},126:{description:"126 Mail (NetEase)",host:"smtp.126.com",port:465,secure:!0},163:{description:"163 Mail (NetEase)",host:"smtp.163.com",port:465,secure:!0},Aliyun:{description:"Alibaba Cloud Mail",domains:["aliyun.com"],host:"smtp.aliyun.com",port:465,secure:!0},AliyunQiye:{description:"Alibaba Cloud Enterprise Mail",host:"smtp.qiye.aliyun.com",port:465,secure:!0},AOL:{description:"AOL Mail",domains:["aol.com"],host:"smtp.aol.com",port:587},Aruba:{description:"Aruba PEC (Italian email provider)",domains:["aruba.it","pec.aruba.it"],aliases:["Aruba PEC"],host:"smtps.aruba.it",port:465,secure:!0,authMethod:"LOGIN"},Bluewin:{description:"Bluewin (Swiss email provider)",host:"smtpauths.bluewin.ch",domains:["bluewin.ch"],port:465},BOL:{description:"BOL Mail (Brazilian provider)",domains:["bol.com.br"],host:"smtp.bol.com.br",port:587,requireTLS:!0},DebugMail:{description:"DebugMail (email testing service)",host:"debugmail.io",port:25},Disroot:{description:"Disroot (privacy-focused provider)",domains:["disroot.org"],host:"disroot.org",port:587,secure:!1,authMethod:"LOGIN"},DynectEmail:{description:"Dyn Email Delivery",aliases:["Dynect"],host:"smtp.dynect.net",port:25},ElasticEmail:{description:"Elastic Email",aliases:["Elastic Email"],host:"smtp.elasticemail.com",port:465,secure:!0},Ethereal:{description:"Ethereal Email (email testing service)",aliases:["ethereal.email"],host:"smtp.ethereal.email",port:587},FastMail:{description:"FastMail",domains:["fastmail.fm"],host:"smtp.fastmail.com",port:465,secure:!0},"Feishu Mail":{description:"Feishu Mail (Lark)",aliases:["Feishu","FeishuMail"],domains:["www.feishu.cn"],host:"smtp.feishu.cn",port:465,secure:!0},"Forward Email":{description:"Forward Email (email forwarding service)",aliases:["FE","ForwardEmail"],domains:["forwardemail.net"],host:"smtp.forwardemail.net",port:465,secure:!0},GandiMail:{description:"Gandi Mail",aliases:["Gandi","Gandi Mail"],host:"mail.gandi.net",port:587},Gmail:{description:"Gmail",aliases:["Google Mail"],domains:["gmail.com","googlemail.com"],host:"smtp.gmail.com",port:465,secure:!0},GMX:{description:"GMX Mail",domains:["gmx.com","gmx.net","gmx.de"],host:"mail.gmx.com",port:587},Godaddy:{description:"GoDaddy Email (US)",host:"smtpout.secureserver.net",port:25},GodaddyAsia:{description:"GoDaddy Email (Asia)",host:"smtp.asia.secureserver.net",port:25},GodaddyEurope:{description:"GoDaddy Email (Europe)",host:"smtp.europe.secureserver.net",port:25},"hot.ee":{description:"Hot.ee (Estonian email provider)",host:"mail.hot.ee"},Hotmail:{description:"Outlook.com / Hotmail",aliases:["Outlook","Outlook.com","Hotmail.com"],domains:["hotmail.com","outlook.com"],host:"smtp-mail.outlook.com",port:587},iCloud:{description:"iCloud Mail",aliases:["Me","Mac"],domains:["me.com","mac.com"],host:"smtp.mail.me.com",port:587},Infomaniak:{description:"Infomaniak Mail (Swiss hosting provider)",host:"mail.infomaniak.com",domains:["ik.me","ikmail.com","etik.com"],port:587},KolabNow:{description:"KolabNow (secure email service)",domains:["kolabnow.com"],aliases:["Kolab"],host:"smtp.kolabnow.com",port:465,secure:!0,authMethod:"LOGIN"},Loopia:{description:"Loopia (Swedish hosting provider)",host:"mailcluster.loopia.se",port:465},Loops:{description:"Loops",host:"smtp.loops.so",port:587},"mail.ee":{description:"Mail.ee (Estonian email provider)",host:"smtp.mail.ee"},"Mail.ru":{description:"Mail.ru",host:"smtp.mail.ru",port:465,secure:!0},"Mailcatch.app":{description:"Mailcatch (email testing service)",host:"sandbox-smtp.mailcatch.app",port:2525},Maildev:{description:"MailDev (local email testing)",port:1025,ignoreTLS:!0},MailerSend:{description:"MailerSend",host:"smtp.mailersend.net",port:587},Mailgun:{description:"Mailgun",host:"smtp.mailgun.org",port:465,secure:!0},Mailjet:{description:"Mailjet",host:"in.mailjet.com",port:587},Mailosaur:{description:"Mailosaur (email testing service)",host:"mailosaur.io",port:25},Mailtrap:{description:"Mailtrap",host:"live.smtp.mailtrap.io",port:587},Mandrill:{description:"Mandrill (by Mailchimp)",host:"smtp.mandrillapp.com",port:587},Naver:{description:"Naver Mail (Korean email provider)",host:"smtp.naver.com",port:587},OhMySMTP:{description:"OhMySMTP (email delivery service)",host:"smtp.ohmysmtp.com",port:587,secure:!1},One:{description:"One.com Email",host:"send.one.com",port:465,secure:!0},OpenMailBox:{description:"OpenMailBox",aliases:["OMB","openmailbox.org"],host:"smtp.openmailbox.org",port:465,secure:!0},Outlook365:{description:"Microsoft 365 / Office 365",host:"smtp.office365.com",port:587,secure:!1},Postmark:{description:"Postmark",aliases:["PostmarkApp"],host:"smtp.postmarkapp.com",port:2525},Proton:{description:"Proton Mail",aliases:["ProtonMail","Proton.me","Protonmail.com","Protonmail.ch"],domains:["proton.me","protonmail.com","pm.me","protonmail.ch"],host:"smtp.protonmail.ch",port:587,requireTLS:!0},"qiye.aliyun":{description:"Alibaba Mail Enterprise Edition",host:"smtp.mxhichina.com",port:"465",secure:!0},QQ:{description:"QQ Mail",domains:["qq.com"],host:"smtp.qq.com",port:465,secure:!0},QQex:{description:"QQ Enterprise Mail",aliases:["QQ Enterprise"],domains:["exmail.qq.com"],host:"smtp.exmail.qq.com",port:465,secure:!0},Resend:{description:"Resend",host:"smtp.resend.com",port:465,secure:!0},Runbox:{description:"Runbox (Norwegian email provider)",domains:["runbox.com"],host:"smtp.runbox.com",port:465,secure:!0},SendCloud:{description:"SendCloud (Chinese email delivery)",host:"smtp.sendcloud.net",port:2525},SendGrid:{description:"SendGrid",host:"smtp.sendgrid.net",port:587},SendinBlue:{description:"Brevo (formerly Sendinblue)",aliases:["Brevo"],host:"smtp-relay.brevo.com",port:587},SendPulse:{description:"SendPulse",host:"smtp-pulse.com",port:465,secure:!0},SES:{description:"AWS SES US East (N. Virginia)",host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-1":{description:"AWS SES Asia Pacific (Tokyo)",host:"email-smtp.ap-northeast-1.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-2":{description:"AWS SES Asia Pacific (Seoul)",host:"email-smtp.ap-northeast-2.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-3":{description:"AWS SES Asia Pacific (Osaka)",host:"email-smtp.ap-northeast-3.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTH-1":{description:"AWS SES Asia Pacific (Mumbai)",host:"email-smtp.ap-south-1.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTHEAST-1":{description:"AWS SES Asia Pacific (Singapore)",host:"email-smtp.ap-southeast-1.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTHEAST-2":{description:"AWS SES Asia Pacific (Sydney)",host:"email-smtp.ap-southeast-2.amazonaws.com",port:465,secure:!0},"SES-CA-CENTRAL-1":{description:"AWS SES Canada (Central)",host:"email-smtp.ca-central-1.amazonaws.com",port:465,secure:!0},"SES-EU-CENTRAL-1":{description:"AWS SES Europe (Frankfurt)",host:"email-smtp.eu-central-1.amazonaws.com",port:465,secure:!0},"SES-EU-NORTH-1":{description:"AWS SES Europe (Stockholm)",host:"email-smtp.eu-north-1.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-1":{description:"AWS SES Europe (Ireland)",host:"email-smtp.eu-west-1.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-2":{description:"AWS SES Europe (London)",host:"email-smtp.eu-west-2.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-3":{description:"AWS SES Europe (Paris)",host:"email-smtp.eu-west-3.amazonaws.com",port:465,secure:!0},"SES-SA-EAST-1":{description:"AWS SES South America (S\xe3o Paulo)",host:"email-smtp.sa-east-1.amazonaws.com",port:465,secure:!0},"SES-US-EAST-1":{description:"AWS SES US East (N. Virginia)",host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-US-EAST-2":{description:"AWS SES US East (Ohio)",host:"email-smtp.us-east-2.amazonaws.com",port:465,secure:!0},"SES-US-GOV-EAST-1":{description:"AWS SES GovCloud (US-East)",host:"email-smtp.us-gov-east-1.amazonaws.com",port:465,secure:!0},"SES-US-GOV-WEST-1":{description:"AWS SES GovCloud (US-West)",host:"email-smtp.us-gov-west-1.amazonaws.com",port:465,secure:!0},"SES-US-WEST-1":{description:"AWS SES US West (N. California)",host:"email-smtp.us-west-1.amazonaws.com",port:465,secure:!0},"SES-US-WEST-2":{description:"AWS SES US West (Oregon)",host:"email-smtp.us-west-2.amazonaws.com",port:465,secure:!0},Seznam:{description:"Seznam Email (Czech email provider)",aliases:["Seznam Email"],domains:["seznam.cz","email.cz","post.cz","spoluzaci.cz"],host:"smtp.seznam.cz",port:465,secure:!0},SMTP2GO:{description:"SMTP2GO",host:"mail.smtp2go.com",port:2525},Sparkpost:{description:"SparkPost",aliases:["SparkPost","SparkPost Mail"],domains:["sparkpost.com"],host:"smtp.sparkpostmail.com",port:587,secure:!1},Tipimail:{description:"Tipimail (email delivery service)",host:"smtp.tipimail.com",port:587},Tutanota:{description:"Tutanota (Tuta Mail)",domains:["tutanota.com","tuta.com","tutanota.de","tuta.io"],host:"smtp.tutanota.com",port:465,secure:!0},Yahoo:{description:"Yahoo Mail",domains:["yahoo.com"],host:"smtp.mail.yahoo.com",port:465,secure:!0},Yandex:{description:"Yandex Mail",domains:["yandex.ru"],host:"smtp.yandex.ru",port:465,secure:!0},Zimbra:{description:"Zimbra Mail Server",aliases:["Zimbra Collaboration"],host:"smtp.zimbra.com",port:587,requireTLS:!0},Zoho:{description:"Zoho Mail",host:"smtp.zoho.com",port:465,secure:!0,authMethod:"LOGIN"}}},7149,[]);
__d(function(g,r,i,a,m,e,d){'use strict';const t=r(d[0]),o=r(d[1]),s=r(d[2]),n=r(d[3]),c=r(d[4]),h=r(d[5]);m.exports=class extends t{constructor(t){let c;super(),'string'==typeof(t=t||{})&&(t={url:t});let l=t.service;'function'==typeof t.getSocket&&(this.getSocket=t.getSocket),t.url&&(c=n.parseConnectionUrl(t.url),l=l||c.service),this.options=n.assign(!1,t,c,l&&s(l)),this.logger=n.getLogger(this.options,{component:this.options.component||'smtp-transport'});let u=new o(this.options);this.name='SMTP',this.version=h.version+'[client:'+u.version+']',this.options.auth&&(this.auth=this.getAuth({}))}getSocket(t,o){return setImmediate(()=>o(null,!1))}getAuth(t){if(!t)return this.auth;let o=!1,s={};if(this.options.auth&&'object'==typeof this.options.auth&&Object.keys(this.options.auth).forEach(t=>{o=!0,s[t]=this.options.auth[t]}),t&&'object'==typeof t&&Object.keys(t).forEach(n=>{o=!0,s[n]=t[n]}),!o)return!1;if('OAUTH2'===(s.type||'').toString().toUpperCase()){if(!s.service&&!s.user)return!1;let t=new c(s,this.logger);return t.provisionCallback=this.mailer&&this.mailer.get('oauth2_provision_cb')||t.provisionCallback,t.on('token',t=>this.mailer.emit('token',t)),t.on('error',t=>this.emit('error',t)),{type:'OAUTH2',user:s.user,oauth2:t,method:'XOAUTH2'}}return{type:(s.type||'').toString().toUpperCase()||'LOGIN',user:s.user,credentials:{user:s.user||'',pass:s.pass,options:s.options},method:(s.method||'').trim().toUpperCase()||this.options.authMethod||!1}}send(t,s){this.getSocket(this.options,(c,h)=>{if(c)return s(c);let l=!1,u=this.options;h&&h.connection&&(this.logger.info({tnx:'proxy',remoteAddress:h.connection.remoteAddress,remotePort:h.connection.remotePort,destHost:u.host||'',destPort:u.port||'',action:'connected'},'Using proxied socket from %s:%s to %s:%s',h.connection.remoteAddress,h.connection.remotePort,u.host||'',u.port||''),u=n.assign(!1,u),Object.keys(h).forEach(t=>{u[t]=h[t]}));let p=new o(u);p.once('error',t=>{if(!l)return l=!0,p.close(),s(t)}),p.once('end',()=>{if(l)return;let t=setTimeout(()=>{if(l)return;l=!0;let t=new Error('Unexpected socket close');p&&p._socket&&p._socket.upgrading&&(t.code='ETLS'),s(t)},1e3);try{t.unref()}catch(t){}});let f=()=>{let o=t.message.getEnvelope(),n=t.message.messageId(),c=[].concat(o.to||[]);c.length>3&&c.push('...and '+c.splice(2).length+' more'),t.data.dsn&&(o.dsn=t.data.dsn),this.logger.info({tnx:'send',messageId:n},'Sending message %s to <%s>',n,c.join(', ')),p.send(o,t.message.createReadStream(),(t,c)=>{if(l=!0,p.close(),t)return this.logger.error({err:t,tnx:'send'},'Send error for %s: %s',n,t.message),s(t);c.envelope={from:o.from,to:o.to},c.messageId=n;try{return s(null,c)}catch(t){this.logger.error({err:t,tnx:'callback'},'Callback error for %s: %s',n,t.message)}})};p.connect(()=>{if(l)return;let o=this.getAuth(t.data.auth);o&&(p.allowsAuth||u.forceAuth)?p.login(o,t=>{if(o&&o!==this.auth&&o.oauth2&&o.oauth2.removeAllListeners(),!l)return t?(l=!0,p.close(),s(t)):void f()}):f()})})}verify(t){let s;return t||(s=new Promise((o,s)=>{t=n.callbackPromise(o,s)})),this.getSocket(this.options,(s,c)=>{if(s)return t(s);let h=this.options;c&&c.connection&&(this.logger.info({tnx:'proxy',remoteAddress:c.connection.remoteAddress,remotePort:c.connection.remotePort,destHost:h.host||'',destPort:h.port||'',action:'connected'},'Using proxied socket from %s:%s to %s:%s',c.connection.remoteAddress,c.connection.remotePort,h.host||'',h.port||''),h=n.assign(!1,h),Object.keys(c).forEach(t=>{h[t]=c[t]}));let l=new o(h),u=!1;l.once('error',o=>{if(!u)return u=!0,l.close(),t(o)}),l.once('end',()=>{if(!u)return u=!0,t(new Error('Connection closed'))});let p=()=>{if(!u)return u=!0,l.quit(),t(null,!0)};l.connect(()=>{if(u)return;let o=this.getAuth({});if(o&&(l.allowsAuth||h.forceAuth))l.login(o,o=>{if(!u)return o?(u=!0,l.close(),t(o)):void p()});else{if(!o&&l.allowsAuth&&h.forceAuth){let o=new Error('Authentication info was not provided');return o.code='NoAuth',u=!0,l.close(),t(o)}p()}})}),s}close(){this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.emit('close')}}},7150,[4897,7145,7148,7121,7147,7124]);
__d(function(g,r,i,a,m,e,d){'use strict';const s=r(d[0]).spawn,n=r(d[1]),t=r(d[2]);m.exports=class{constructor(o){o=o||{},this._spawn=s,this.options=o||{},this.name='Sendmail',this.version=n.version,this.path='sendmail',this.args=!1,this.winbreak=!1,this.logger=t.getLogger(this.options,{component:this.options.component||'sendmail'}),o&&('string'==typeof o?this.path=o:'object'==typeof o&&(o.path&&(this.path=o.path),Array.isArray(o.args)&&(this.args=o.args),this.winbreak=['win','windows','dos','\r\n'].includes((o.newline||'').toString().toLowerCase())))}send(s,n){s.message.keepBcc=!0;let t,o,c,l=s.data.envelope||s.message.getEnvelope(),h=s.message.messageId();if([].concat(l.from||[]).concat(l.to||[]).some(s=>/^-/.test(s)))return n(new Error('Can not send mail. Invalid envelope addresses.'));t=this.args?['-i'].concat(this.args).concat(l.to):['-i'].concat(l.from?['-f',l.from]:[]).concat(l.to);let p=t=>{if(!c)return c=!0,'function'==typeof n?t?n(t):n(null,{envelope:s.data.envelope||s.message.getEnvelope(),messageId:h,response:'Messages queued for delivery'}):void 0};try{o=this._spawn(this.path,t)}catch(s){return this.logger.error({err:s,tnx:'spawn',messageId:h},'Error occurred while spawning sendmail. %s',s.message),p(s)}if(!o)return p(new Error('sendmail was not found'));{o.on('error',s=>{this.logger.error({err:s,tnx:'spawn',messageId:h},'Error occurred when sending message %s. %s',h,s.message),p(s)}),o.once('exit',s=>{if(!s)return p();let n;n=127===s?new Error('Sendmail command not found, process exited with code '+s):new Error('Sendmail exited with code '+s),this.logger.error({err:n,tnx:'stdin',messageId:h},'Error sending message %s to sendmail. %s',h,n.message),p(n)}),o.once('close',p),o.stdin.on('error',s=>{this.logger.error({err:s,tnx:'stdin',messageId:h},'Error occurred when piping message %s to sendmail. %s',h,s.message),p(s)});let n=[].concat(l.to||[]);n.length>3&&n.push('...and '+n.splice(2).length+' more'),this.logger.info({tnx:'send',messageId:h},'Sending message %s to <%s>',h,n.join(', '));let t=s.message.createReadStream();t.once('error',s=>{this.logger.error({err:s,tnx:'stdin',messageId:h},'Error occurred when generating message %s. %s',h,s.message),o.kill('SIGINT'),p(s)}),t.pipe(o.stdin)}}}},7151,[7152,7124,7121]);
__d(function(g,r,i,a,m,e,d){m.exports=$$require_external('node:child_process')},7152,[]);
__d(function(g,r,i,a,m,e,d){'use strict';const s=r(d[0]),n=r(d[1]);m.exports=class{constructor(t){t=t||{},this.options=t||{},this.name='StreamTransport',this.version=s.version,this.logger=n.getLogger(this.options,{component:this.options.component||'stream-transport'}),this.winbreak=['win','windows','dos','\r\n'].includes((t.newline||'').toString().toLowerCase())}send(s,n){s.message.keepBcc=!0;let t=s.data.envelope||s.message.getEnvelope(),o=s.message.messageId(),l=[].concat(t.to||[]);l.length>3&&l.push('...and '+l.splice(2).length+' more'),this.logger.info({tnx:'send',messageId:o},'Sending message %s to <%s> using %s line breaks',o,l.join(', '),this.winbreak?'<CR><LF>':'<LF>'),setImmediate(()=>{let t;try{t=s.message.createReadStream()}catch(s){return this.logger.error({err:s,tnx:'send',messageId:o},'Creating send stream failed for %s. %s',o,s.message),n(s)}if(!this.options.buffer)return t.once('error',s=>{this.logger.error({err:s,tnx:'send',messageId:o},'Failed creating message for %s. %s',o,s.message)}),n(null,{envelope:s.data.envelope||s.message.getEnvelope(),messageId:o,message:t});let l=[],c=0;t.on('readable',()=>{let s;for(;null!==(s=t.read());)l.push(s),c+=s.length}),t.once('error',s=>(this.logger.error({err:s,tnx:'send',messageId:o},'Failed creating message for %s. %s',o,s.message),n(s))),t.on('end',()=>n(null,{envelope:s.data.envelope||s.message.getEnvelope(),messageId:o,message:Buffer.concat(l,c)}))})}}},7153,[7124,7121]);
__d(function(g,r,i,a,m,e,d){'use strict';const s=r(d[0]),t=r(d[1]);m.exports=class{constructor(o){o=o||{},this.options=o||{},this.name='JSONTransport',this.version=s.version,this.logger=t.getLogger(this.options,{component:this.options.component||'json-transport'})}send(s,t){s.message.keepBcc=!0;let o=s.data.envelope||s.message.getEnvelope(),n=s.message.messageId(),l=[].concat(o.to||[]);l.length>3&&l.push('...and '+l.splice(2).length+' more'),this.logger.info({tnx:'send',messageId:n},'Composing JSON structure of %s to <%s>',n,l.join(', ')),setImmediate(()=>{s.normalize((s,l)=>s?(this.logger.error({err:s,tnx:'send',messageId:n},'Failed building JSON structure for %s. %s',n,s.message),t(s)):(delete l.envelope,delete l.normalizedHeaders,t(null,{envelope:o,messageId:n,message:this.options.skipEncoding?l:JSON.stringify(l)})))})}}},7154,[7124,7121]);
__d(function(g,r,i,a,m,e,d){'use strict';const s=r(d[0]),n=r(d[1]),t=r(d[2]),o=r(d[3]),l=r(d[4]);m.exports=class extends s{constructor(s){super(),s=s||{},this.options=s||{},this.ses=this.options.SES,this.name='SESTransport',this.version=n.version,this.logger=t.getLogger(this.options,{component:this.options.component||'ses-transport'})}getRegion(s){return this.ses.sesClient.config&&'function'==typeof this.ses.sesClient.config.region?this.ses.sesClient.config.region().then(n=>s(null,n)).catch(n=>s(n)):s(null,!1)}send(s,n){let t={ts:Date.now(),pending:!0},c=s.message._headers.find(s=>/^from$/i.test(s.key));if(c){let s=new l('text/plain');c=s._convertAddresses(s._parseAddresses(c.value))}let h=s.data.envelope||s.message.getEnvelope(),p=s.message.messageId(),u=[].concat(h.to||[]);u.length>3&&u.push('...and '+u.splice(2).length+' more'),this.logger.info({tnx:'send',messageId:p},'Sending message %s to <%s>',p,u.join(', '));let f=n=>{s.data._dkim||(s.data._dkim={}),s.data._dkim.skipFields&&'string'==typeof s.data._dkim.skipFields?s.data._dkim.skipFields+=':date:message-id':s.data._dkim.skipFields='date:message-id';let t=s.message.createReadStream(),l=t.pipe(new o),c=[],h=0;l.on('readable',()=>{let s;for(;null!==(s=l.read());)c.push(s),h+=s.length}),t.once('error',s=>l.emit('error',s)),l.once('error',s=>{n(s)}),l.once('end',()=>n(null,Buffer.concat(c,h)))};setImmediate(()=>f((o,l)=>{if(o)return this.logger.error({err:o,tnx:'send',messageId:p},'Failed creating message for %s. %s',p,o.message),t.pending=!1,n(o);let u={Content:{Raw:{Data:l}},FromEmailAddress:c||h.from,Destination:{ToAddresses:h.to}};Object.keys(s.data.ses||{}).forEach(n=>{u[n]=s.data.ses[n]}),this.getRegion((s,o)=>{!s&&o||(o='us-east-1');const c=new this.ses.SendEmailCommand(u);this.ses.sesClient.send(c).then(s=>{'us-east-1'===o&&(o='email'),t.pending=!0,n(null,{envelope:{from:h.from,to:h.to},messageId:'<'+s.MessageId+(/@/.test(s.MessageId)?'':'@'+o+'.amazonses.com')+'>',response:s.MessageId,raw:l})}).catch(s=>{this.logger.error({err:s,tnx:'send'},'Send error for %s: %s',p,s.message),t.pending=!1,n(s)})})}))}verify(s){let n;s||(n=new Promise((n,o)=>{s=t.callbackPromise(n,o)}));const o=n=>n&&!['InvalidParameterValue','MessageRejected'].includes(n.code||n.Code||n.name)?s(n):s(null,!0),l={Content:{Raw:{Data:Buffer.from('From: <invalid@invalid>\r\nTo: <invalid@invalid>\r\n Subject: Invalid\r\n\r\nInvalid')}},FromEmailAddress:'invalid@invalid',Destination:{ToAddresses:['invalid@invalid']}};return this.getRegion((s,n)=>{!s&&n||(n='us-east-1');const t=new this.ses.SendEmailCommand(l);this.ses.sesClient.send(t).then(s=>o(null)).catch(s=>o(s))}),n}}},7155,[4897,7124,7121,7135,7128]);
__d(function(g,r,i,a,m,e,d){var n=r(d[0]);Object.defineProperty(e,"__esModule",{value:!0}),e.POST=async function(n){try{const s=await n.json(),{email:c}=s;if(!c||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c))return new Response(JSON.stringify({error:'Valid email is required'}),{status:400,headers:{'Content-Type':'application/json'}});const l=Math.floor(1e5+9e5*Math.random()).toString();await o.supabaseServer.rpc('cleanup_expired_otp_codes');const p=c.trim().toLowerCase(),u=new Date;u.setHours(u.getHours()+1);const{error:h}=await o.supabaseServer.from('otp_codes').insert({email:p,code:l,token_hash:`delete_account_${Date.now()}`,expires_at:u.toISOString(),used:!1});if(h)return console.error('Error storing OTP code:',h),new Response(JSON.stringify({error:'Failed to store OTP code'}),{status:500,headers:{'Content-Type':'application/json'}});if(!process.env.NODEMAILER_FROM||!process.env.NODEMAILER_PASS)return new Response(JSON.stringify({error:'Email service not configured'}),{status:500,headers:{'Content-Type':'application/json'}});{const n=process.env.NODEMAILER_HOST||'smtp.sendgrid.net',o=n.includes('brevo.com')||n.includes('sendinblue.com'),s=t.default.createTransport({host:n,port:parseInt(process.env.NODEMAILER_PORT||'587'),secure:!1,auth:{user:process.env.NODEMAILER_USER||'apikey',pass:process.env.NODEMAILER_PASS},tls:{rejectUnauthorized:!0,servername:o?'smtp-relay.sendinblue.com':void 0,checkServerIdentity:o?()=>{}:void 0},requireTLS:!0}),p={from:`HashPass <${process.env.NODEMAILER_FROM}>`,to:c.trim(),subject:'Account Deletion Verification Code',html:`\n          <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">\n            <h2 style="color: #F44336;">Account Deletion Verification</h2>\n            <p>You have requested to delete your HashPass account. Please enter this verification code to confirm:</p>\n            <div style="background-color: #f3f4f6; border: 2px solid #F44336; border-radius: 8px; padding: 20px; text-align: center; margin: 20px 0;">\n              <h1 style="color: #F44336; font-size: 32px; letter-spacing: 8px; margin: 0;">${l}</h1>\n            </div>\n            <p style="color: #6b7280; font-size: 14px;"><strong>Warning:</strong> This action cannot be undone. All your data will be permanently deleted.</p>\n            <p style="color: #6b7280; font-size: 14px;">This code will expire in 1 hour.</p>\n            <p style="color: #6b7280; font-size: 14px;">If you didn't request this code, please ignore this email and secure your account.</p>\n            <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 20px 0;">\n            <p style="font-size: 12px; color: #6b7280;">\n              \xa9 ${(new Date).getFullYear()} HashPass. All rights reserved.\n            </p>\n          </div>\n        `,text:`Account Deletion Verification\n\nYou have requested to delete your HashPass account. Please enter this verification code to confirm: ${l}\n\nWarning: This action cannot be undone. All your data will be permanently deleted.\n\nThis code will expire in 1 hour.\n\nIf you didn't request this code, please ignore this email and secure your account.`};try{await s.sendMail(p),console.log('Account deletion OTP email sent successfully to:',c)}catch(n){return console.error('Error sending OTP email:',n),new Response(JSON.stringify({error:'Failed to send OTP email'}),{status:500,headers:{'Content-Type':'application/json'}})}}return new Response(JSON.stringify({success:!0,message:'OTP code sent to email'}),{status:200,headers:{'Content-Type':'application/json'}})}catch(n){return console.error('OTP generation error:',n),new Response(JSON.stringify({error:n.message||'Failed to send OTP'}),{status:500,headers:{'Content-Type':'application/json'}})}};var o=r(d[1]),t=n(r(d[2]))},7432,[29,7118,7119]);
module.exports = __r(7432);