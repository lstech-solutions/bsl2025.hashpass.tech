var __BUNDLE_START_TIME__=globalThis.nativePerformanceNow?nativePerformanceNow():Date.now(),__DEV__=false,process=globalThis.process||{},__METRO_GLOBAL_PREFIX__='';
!(function(e){"use strict";e.__r=i,e[`${__METRO_GLOBAL_PREFIX__}__d`]=function(e,n,o){if(t.has(n))return;const i={dependencyMap:o,factory:e,hasError:!1,importedAll:r,importedDefault:r,isInitialized:!1,publicModule:{exports:{}}};t.set(n,i)},e.__c=o,e.__registerSegment=function(e,r,n){p[e]=r,n&&n.forEach(r=>{t.has(r)||h.has(r)||h.set(r,e)})};var t=o();const r={},{hasOwnProperty:n}={};function o(){return t=new Map}function i(e,r){if(null===e)throw new Error("Cannot find module");const n=e,o=t.get(n);return o&&o.isInitialized?o.publicModule.exports:d(n,o)}function l(e){const n=e,o=t.get(n);if(o&&o.importedDefault!==r)return o.importedDefault;const l=i(n),u=l&&l.__esModule?l.default:l;return t.get(n).importedDefault=u}function u(e){const o=e,l=t.get(o);if(l&&l.importedAll!==r)return l.importedAll;const u=i(o);let c;if(u&&u.__esModule)c=u;else{if(c={},u)for(const e in u)n.call(u,e)&&(c[e]=u[e]);c.default=u}return t.get(o).importedAll=c}i.importDefault=l,i.importAll=u,i.context=function(){throw new Error("The experimental Metro feature `require.context` is not enabled in your project.")},i.resolveWeak=function(){throw new Error("require.resolveWeak cannot be called dynamically.")};let c=!1;function d(t,r){if(!c&&e.ErrorUtils){let n;c=!0;try{n=g(t,r)}catch(t){e.ErrorUtils.reportFatalError(t)}return c=!1,n}return g(t,r)}const a=16,s=65535;function f(e){return{segmentId:e>>>a,localId:e&s}}i.unpackModuleId=f,i.packModuleId=function(e){return(e.segmentId<<a)+e.localId};const p=[],h=new Map;function g(r,n){if(!n&&p.length>0){const e=h.get(r)??0,o=p[e];null!=o&&(o(r),n=t.get(r),h.delete(r))}const o=e.nativeRequire;if(!n&&o){const{segmentId:e,localId:i}=f(r);o(i,e),n=t.get(r)}if(!n)throw m(r);if(n.hasError)throw n.error;n.isInitialized=!0;const{factory:c,dependencyMap:d}=n;try{const t=n.publicModule;return t.id=r,c(e,i,l,u,t,t.exports,d),n.factory=void 0,n.dependencyMap=void 0,t.exports}catch(e){throw n.hasError=!0,n.error=e,n.isInitialized=!1,n.publicModule.exports=void 0,e}}function m(e){return Error('Requiring unknown module "'+e+'".')}})('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window?window:this);
!(function(e){e.$$require_external="undefined"!=typeof require?require:()=>null})('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window?window:this);
'undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window&&window;
!(function(r){let l=0,n=!0===r.RN$useAlwaysAvailableJSErrorHandling?r.RN$handleException:(r,l)=>{throw r};const t={setGlobalHandler(r){n=r},getGlobalHandler:()=>n,reportError(r){n&&n(r,!1)},reportFatalError(r){n&&n(r,!0)},applyWithGuard(r,n,e,a,o){try{return l++,r.apply(n,e)}catch(r){t.reportError(r)}finally{l--}return null},applyWithGuardIfNeeded:(r,l,n)=>t.inGuard()?r.apply(l,n):(t.applyWithGuard(r,l,n),null),inGuard:()=>!!l,guard(r,l,n){if('function'!=typeof r)return console.warn('A function must be passed to ErrorUtils.guard, got ',r),null;const e=l??r.name??'<generated guard>';return function(...l){return t.applyWithGuard(r,n??this,l,null,e)}}};r.ErrorUtils=t})('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof global?global:'undefined'!=typeof window?window:this);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.POST=async function(n){try{const s=await n.json(),{action:o,level:u,userId:c,details:l}=s;if(!o)return new Response(JSON.stringify({error:'Action is required'}),{status:400,headers:{'Content-Type':'application/json'}});const p=(0,t.getWazuhClient)(),f=n.headers.get('x-forwarded-for')||n.headers.get('x-real-ip')||void 0,h=n.headers.get('user-agent')||void 0;return await p.sendEvent({timestamp:(new Date).toISOString(),level:u||'info',location:'/api/wazuh/log',user:c,action:o,details:l||{},ip_address:f,user_agent:h}),new Response(JSON.stringify({success:!0}),{status:200,headers:{'Content-Type':'application/json'}})}catch(t){return console.error('[Wazuh] Log endpoint error:',t),new Response(JSON.stringify({error:'Failed to log event'}),{status:500,headers:{'Content-Type':'application/json'}})}};var t=r(d[0])},7164,[7165]);
__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.WazuhClient=void 0,e.getWazuhClient=function(){n||(n=new t);return n},e.logEventClient=async function(t){try{await fetch('/api/wazuh/log',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(t)})}catch(t){console.error('[Wazuh] Failed to log event:',t)}};class t{constructor(t){this.config={managerUrl:process.env.WAZUH_MANAGER_URL||'',apiKey:process.env.WAZUH_API_KEY||'',agentId:process.env.WAZUH_AGENT_ID||'hashpass-web',...t},this.enabled=!!this.config.managerUrl&&!!this.config.apiKey}async sendEvent(t){if(this.enabled)try{t.timestamp||(new Date).toISOString(),t.level,t.rule_id||this.getDefaultRuleId(t.level),t.action,t.location,t.user,t.action,t.details,t.ip_address,t.user_agent;const n=await fetch(`${this.config.managerUrl}/vulnerability`,{method:'POST',headers:{Authorization:`Bearer ${this.config.apiKey}`,'Content-Type':'application/json'},body:JSON.stringify({agent:{id:this.config.agentId,name:'hashpass-web'},vulnerability:{name:t.action,severity:this.mapLevelToSeverity(t.level),description:JSON.stringify(t.details),cve:t.rule_id?.toString()}})});n.ok||console.error('[Wazuh] Failed to send event:',await n.text())}catch(t){console.error('[Wazuh] Error sending event:',t)}else console.debug('[Wazuh] Client disabled, skipping event')}async logAuthEvent(t,n,s,o,l){const c=t.includes('failed')?'warning':'info';await this.sendEvent({timestamp:(new Date).toISOString(),level:c,location:'/auth',user:n,action:`auth_${t}`,details:{auth_action:t,...l},ip_address:s,user_agent:o})}async logApiAccess(t,n,s,o=200,l,c){const u=o>=500?'error':o>=400?'warning':'info';await this.sendEvent({timestamp:(new Date).toISOString(),level:u,location:t,user:s,action:`api_${n.toLowerCase()}`,details:{endpoint:t,method:n,status_code:o},ip_address:l,user_agent:c})}async logSecurityEvent(t,n,s,o,l){await this.sendEvent({timestamp:(new Date).toISOString(),level:n,location:o?.endpoint||'unknown',user:s,action:`security_${t}`,details:o||{},ip_address:l,rule_id:this.getSecurityRuleId(t)})}async logQRScan(t,n,s,o){const l='valid'===n?'info':'warning';await this.sendEvent({timestamp:(new Date).toISOString(),level:l,location:'/api/qr/scan',user:s,action:'qr_scan',details:{qr_code_id:t,scan_status:n},ip_address:o})}async logAdminAction(t,n,s,o){await this.sendEvent({timestamp:(new Date).toISOString(),level:'info',location:'/admin',user:n,action:`admin_${t}`,details:{target_id:s,...o}})}getDefaultRuleId(t){return{info:1e3,warning:2e3,error:3e3,critical:4e3}[t]||1e3}getSecurityRuleId(t){return{unauthorized_access:5503,brute_force:5504,sql_injection:5505,xss_attempt:5506,rate_limit_exceeded:5507,suspicious_activity:5508}[t]||5508}mapLevelToSeverity(t){return{info:'Low',warning:'Medium',error:'High',critical:'Critical'}[t]||'Low'}}e.WazuhClient=t;let n=null},7165,[]);
module.exports = __r(7164);