[build]
  command = "npm install --include=dev && npm run build:web"
  functions = "netlify/functions"
  publish = "dist/client"

# Catch-all redirect for SPA routing (static files are served automatically first)
# Only routes that don't match static files will hit this redirect
[[redirects]]
  from = "/*"
  to = "/.netlify/functions/server"
  status = 200

[functions]
  # Include everything to ensure dynamic routes can be used.
  included_files = ["dist/server/**/*"]

[[headers]]
  for = "/_expo/static/*"
  [headers.values]
    "Cache-Control" = "public, max-age=31536000, immutable"

[[headers]]
  for = "/static/*"
  [headers.values]
    "Cache-Control" = "public, max-age=31536000, immutable"

[[headers]]
  for = "/assets/*"
  [headers.values]
    "Cache-Control" = "public, max-age=31536000, immutable"
